<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_DksEa5Cip3vDF0xhh18uxi"><span id="%24con2tag_IuSnzHWRMZSIiYn4RkZf1f"></span></span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveTraversable #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- | Sslang's intermediate representation and its associated helpers.</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">IR.IR</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="IR.IR.html#Program"><span class="hs-identifier">Program</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#TypeDef"><span class="hs-identifier">TypeDef</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#TypeVariant"><span class="hs-identifier">TypeVariant</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#Binder"><span class="hs-identifier">Binder</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Literal"><span class="hs-identifier">Literal</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier">PrimOp</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Primitive"><span class="hs-identifier">Primitive</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier">Expr</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Alt"><span class="hs-identifier">Alt</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier">VarId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#TConId"><span class="hs-identifier">TConId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#DConId"><span class="hs-identifier">DConId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.Type.html#Type"><span class="hs-identifier">Type</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.Type.html#Annotation"><span class="hs-identifier">Annotation</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.Type.html#Annotations"><span class="hs-identifier">Annotations</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#variantFields"><span class="hs-identifier">variantFields</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#wellFormed"><span class="hs-identifier">wellFormed</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#foldLambda"><span class="hs-identifier">foldLambda</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#unfoldLambda"><span class="hs-identifier">unfoldLambda</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#extract"><span class="hs-identifier">extract</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#inject"><span class="hs-identifier">inject</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#foldApp"><span class="hs-identifier">foldApp</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#unfoldApp"><span class="hs-identifier">unfoldApp</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#isValue"><span class="hs-identifier">isValue</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#getAltDefault"><span class="hs-identifier">getAltDefault</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Common.Identifiers.html"><span class="hs-identifier">Common.Identifiers</span></a></span><span>             </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Common.Identifiers.html#Binder"><span class="hs-identifier">Binder</span></a></span><span>
</span><span id="line-36"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#CSym"><span class="hs-identifier">CSym</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#DConId"><span class="hs-identifier">DConId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#HasFreeVars"><span class="hs-identifier">HasFreeVars</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#TConId"><span class="hs-identifier">TConId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#TVarId"><span class="hs-identifier">TVarId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier">VarId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>                                                </span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Common.Pretty.html"><span class="hs-identifier">Common.Pretty</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">void</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Data</span></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Data</span></span><span>
</span><span id="line-46"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Typeable</span></span><span>
</span><span id="line-47"></span><span>                                                </span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>                     </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span>
</span><span id="line-50"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">maybeToList</span></span><span>
</span><span id="line-51"></span><span>                                                </span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span>                      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span>                       </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(\\)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="IR.Types.Type.html"><span class="hs-identifier">IR.Types.Type</span></a></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="IR.Types.Type.html#Annotation"><span class="hs-identifier">Annotation</span></a></span><span>
</span><span id="line-55"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.Type.html#Annotations"><span class="hs-identifier">Annotations</span></a></span><span>
</span><span id="line-56"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="IR.Types.Type.html#Arrow"><span class="hs-identifier">Arrow</span></a></span><span>
</span><span id="line-57"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.Type.html#Type"><span class="hs-identifier">Type</span></a></span><span>
</span><span id="line-58"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.Type.html#unfoldArrow"><span class="hs-identifier">unfoldArrow</span></a></span><span>
</span><span id="line-59"></span><span>                                                </span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">{- | Top-level compilation unit.

@t@ is the type system in use, e.g., &quot;IR.Types.Flat&quot;
-}</span><span>
</span><span id="line-65"></span><span class="hs-keyword">data</span><span> </span><span id="Program"><span class="annot"><a href="IR.IR.html#Program"><span class="hs-identifier hs-var">Program</span></a></span></span><span> </span><span id="local-6989586621679528686"><span class="annot"><a href="#local-6989586621679528686"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Program"><span class="annot"><a href="IR.IR.html#Program"><span class="hs-identifier hs-var">Program</span></a></span></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="programEntry"><span class="annot"><span class="annottext">Program t -&gt; VarId
</span><a href="IR.IR.html#programEntry"><span class="hs-identifier hs-var hs-var">programEntry</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="cDefs"><span class="annot"><span class="annottext">Program t -&gt; String
</span><a href="IR.IR.html#cDefs"><span class="hs-identifier hs-var hs-var">cDefs</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="externDecls"><span class="annot"><span class="annottext">Program t -&gt; [(VarId, Type)]
</span><a href="IR.IR.html#externDecls"><span class="hs-identifier hs-var hs-var">externDecls</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="programDefs"><span class="annot"><span class="annottext">Program t -&gt; [(VarId, Expr t)]
</span><a href="IR.IR.html#programDefs"><span class="hs-identifier hs-var hs-var">programDefs</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528686"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="typeDefs"><span class="annot"><span class="annottext">Program t -&gt; [(TConId, TypeDef)]
</span><a href="IR.IR.html#typeDefs"><span class="hs-identifier hs-var hs-var">typeDefs</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#TConId"><span class="hs-identifier hs-type">TConId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679528579"><span id="local-6989586621679528581"><span class="annot"><span class="annottext">Program t -&gt; Program t -&gt; Bool
(Program t -&gt; Program t -&gt; Bool)
-&gt; (Program t -&gt; Program t -&gt; Bool) -&gt; Eq (Program t)
forall t. Eq t =&gt; Program t -&gt; Program t -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Program t -&gt; Program t -&gt; Bool
$c/= :: forall t. Eq t =&gt; Program t -&gt; Program t -&gt; Bool
== :: Program t -&gt; Program t -&gt; Bool
$c== :: forall t. Eq t =&gt; Program t -&gt; Program t -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679528572"><span id="local-6989586621679528574"><span id="local-6989586621679528576"><span class="annot"><span class="annottext">Int -&gt; Program t -&gt; ShowS
[Program t] -&gt; ShowS
Program t -&gt; String
(Int -&gt; Program t -&gt; ShowS)
-&gt; (Program t -&gt; String)
-&gt; ([Program t] -&gt; ShowS)
-&gt; Show (Program t)
forall t. Show t =&gt; Int -&gt; Program t -&gt; ShowS
forall t. Show t =&gt; [Program t] -&gt; ShowS
forall t. Show t =&gt; Program t -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Program t] -&gt; ShowS
$cshowList :: forall t. Show t =&gt; [Program t] -&gt; ShowS
show :: Program t -&gt; String
$cshow :: forall t. Show t =&gt; Program t -&gt; String
showsPrec :: Int -&gt; Program t -&gt; ShowS
$cshowsPrec :: forall t. Show t =&gt; Int -&gt; Program t -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cProgram"><span id="%24tProgram"><span id="local-6989586621679528542"><span id="local-6989586621679528544"><span id="local-6989586621679528546"><span id="local-6989586621679528548"><span id="local-6989586621679528550"><span id="local-6989586621679528552"><span id="local-6989586621679528554"><span id="local-6989586621679528556"><span id="local-6989586621679528558"><span id="local-6989586621679528560"><span id="local-6989586621679528562"><span id="local-6989586621679528564"><span id="local-6989586621679528566"><span id="local-6989586621679528568"><span class="annot"><span class="annottext">Typeable (Program t)
DataType
Constr
Typeable (Program t)
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; Program t -&gt; c (Program t))
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Program t))
-&gt; (Program t -&gt; Constr)
-&gt; (Program t -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Program t)))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e))
    -&gt; Maybe (c (Program t)))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; Program t -&gt; Program t)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t))
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t))
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t))
-&gt; Data (Program t)
Program t -&gt; DataType
Program t -&gt; Constr
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Program t))
(forall b. Data b =&gt; b -&gt; b) -&gt; Program t -&gt; Program t
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Program t -&gt; c (Program t)
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Program t)
forall t. Data t =&gt; Typeable (Program t)
forall t. Data t =&gt; Program t -&gt; DataType
forall t. Data t =&gt; Program t -&gt; Constr
forall t.
Data t =&gt;
(forall b. Data b =&gt; b -&gt; b) -&gt; Program t -&gt; Program t
forall t u.
Data t =&gt;
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; u
forall t u.
Data t =&gt;
(forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; [u]
forall t r r'.
Data t =&gt;
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r
forall t r r'.
Data t =&gt;
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r
forall t (m :: * -&gt; *).
(Data t, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
forall t (c :: * -&gt; *).
Data t =&gt;
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Program t)
forall t (c :: * -&gt; *).
Data t =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Program t -&gt; c (Program t)
forall t (t :: * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Program t))
forall t (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (Program t))
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Program t)
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Program t -&gt; c (Program t)
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Program t))
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (Program t))
$cProgram :: Constr
$tProgram :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
$cgmapMo :: forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
$cgmapMp :: forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
$cgmapM :: forall t (m :: * -&gt; *).
(Data t, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; u
$cgmapQi :: forall t u.
Data t =&gt;
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; [u]
$cgmapQ :: forall t u.
Data t =&gt;
(forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r
$cgmapQr :: forall t r r'.
Data t =&gt;
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r
$cgmapQl :: forall t r r'.
Data t =&gt;
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Program t -&gt; Program t
$cgmapT :: forall t.
Data t =&gt;
(forall b. Data b =&gt; b -&gt; b) -&gt; Program t -&gt; Program t
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (Program t))
$cdataCast2 :: forall t (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (Program t))
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Program t))
$cdataCast1 :: forall t (t :: * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Program t))
dataTypeOf :: Program t -&gt; DataType
$cdataTypeOf :: forall t. Data t =&gt; Program t -&gt; DataType
toConstr :: Program t -&gt; Constr
$ctoConstr :: forall t. Data t =&gt; Program t -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Program t)
$cgunfold :: forall t (c :: * -&gt; *).
Data t =&gt;
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Program t)
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Program t -&gt; c (Program t)
$cgfoldl :: forall t (c :: * -&gt; *).
Data t =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Program t -&gt; c (Program t)
$cp1Data :: forall t. Data t =&gt; Typeable (Program t)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679528535"><span id="local-6989586621679528537"><span class="annot"><span class="annottext">a -&gt; Program b -&gt; Program a
(a -&gt; b) -&gt; Program a -&gt; Program b
(forall a b. (a -&gt; b) -&gt; Program a -&gt; Program b)
-&gt; (forall a b. a -&gt; Program b -&gt; Program a) -&gt; Functor Program
forall a b. a -&gt; Program b -&gt; Program a
forall a b. (a -&gt; b) -&gt; Program a -&gt; Program b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; Program b -&gt; Program a
$c&lt;$ :: forall a b. a -&gt; Program b -&gt; Program a
fmap :: (a -&gt; b) -&gt; Program a -&gt; Program b
$cfmap :: forall a b. (a -&gt; b) -&gt; Program a -&gt; Program b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">{- | The type definition associated with a type constructor.
A definition for `data MyList a = Cons a (MyList a) | Nil` looks like:
@
  TypeDef { targs = [a]
          , [ (&quot;Cons&quot;, VariantUnnamed [TVar a, TCon (&quot;MyList&quot; [TVar a])])
            , (&quot;Nil&quot;, VariantUnnamed [])
            ]
          }
@
(Data constructors for identifiers are omitted for brevity.)
Note that for a flat type system, where all type constructors are nullary, targs
will just be set to [].
-}</span><span>
</span><span id="line-88"></span><span class="hs-keyword">data</span><span> </span><span id="TypeDef"><span class="annot"><a href="IR.IR.html#TypeDef"><span class="hs-identifier hs-var">TypeDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TypeDef"><span class="annot"><a href="IR.IR.html#TypeDef"><span class="hs-identifier hs-var">TypeDef</span></a></span></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="variants"><span class="annot"><span class="annottext">TypeDef -&gt; [(DConId, TypeVariant)]
</span><a href="IR.IR.html#variants"><span class="hs-identifier hs-var hs-var">variants</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#DConId"><span class="hs-identifier hs-type">DConId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#TypeVariant"><span class="hs-identifier hs-type">TypeVariant</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="targs"><span class="annot"><span class="annottext">TypeDef -&gt; [TVarId]
</span><a href="IR.IR.html#targs"><span class="hs-identifier hs-var hs-var">targs</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.Identifiers.html#TVarId"><span class="hs-identifier hs-type">TVarId</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679528525"><span id="local-6989586621679528527"><span id="local-6989586621679528529"><span class="annot"><span class="annottext">Int -&gt; TypeDef -&gt; ShowS
[TypeDef] -&gt; ShowS
TypeDef -&gt; String
(Int -&gt; TypeDef -&gt; ShowS)
-&gt; (TypeDef -&gt; String) -&gt; ([TypeDef] -&gt; ShowS) -&gt; Show TypeDef
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TypeDef] -&gt; ShowS
$cshowList :: [TypeDef] -&gt; ShowS
show :: TypeDef -&gt; String
$cshow :: TypeDef -&gt; String
showsPrec :: Int -&gt; TypeDef -&gt; ShowS
$cshowsPrec :: Int -&gt; TypeDef -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679528521"><span id="local-6989586621679528523"><span class="annot"><span class="annottext">TypeDef -&gt; TypeDef -&gt; Bool
(TypeDef -&gt; TypeDef -&gt; Bool)
-&gt; (TypeDef -&gt; TypeDef -&gt; Bool) -&gt; Eq TypeDef
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TypeDef -&gt; TypeDef -&gt; Bool
$c/= :: TypeDef -&gt; TypeDef -&gt; Bool
== :: TypeDef -&gt; TypeDef -&gt; Bool
$c== :: TypeDef -&gt; TypeDef -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cTypeDef"><span id="%24tTypeDef"><span id="local-6989586621679528492"><span id="local-6989586621679528494"><span id="local-6989586621679528496"><span id="local-6989586621679528498"><span id="local-6989586621679528500"><span id="local-6989586621679528502"><span id="local-6989586621679528504"><span id="local-6989586621679528506"><span id="local-6989586621679528508"><span id="local-6989586621679528510"><span id="local-6989586621679528512"><span id="local-6989586621679528514"><span id="local-6989586621679528516"><span id="local-6989586621679528518"><span class="annot"><span class="annottext">Typeable TypeDef
DataType
Constr
Typeable TypeDef
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; TypeDef -&gt; c TypeDef)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c TypeDef)
-&gt; (TypeDef -&gt; Constr)
-&gt; (TypeDef -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c TypeDef))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c TypeDef))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; TypeDef -&gt; TypeDef)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeDef -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeDef -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; TypeDef -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeDef -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef -&gt; m TypeDef)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef -&gt; m TypeDef)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef -&gt; m TypeDef)
-&gt; Data TypeDef
TypeDef -&gt; DataType
TypeDef -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; TypeDef -&gt; TypeDef
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeDef -&gt; c TypeDef
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c TypeDef
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeDef -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; TypeDef -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeDef -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeDef -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef -&gt; m TypeDef
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef -&gt; m TypeDef
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c TypeDef
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeDef -&gt; c TypeDef
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c TypeDef)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c TypeDef)
$cTypeDef :: Constr
$tTypeDef :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef -&gt; m TypeDef
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef -&gt; m TypeDef
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef -&gt; m TypeDef
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef -&gt; m TypeDef
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef -&gt; m TypeDef
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef -&gt; m TypeDef
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeDef -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeDef -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; TypeDef -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; TypeDef -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeDef -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeDef -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeDef -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeDef -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; TypeDef -&gt; TypeDef
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; TypeDef -&gt; TypeDef
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c TypeDef)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c TypeDef)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c TypeDef)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c TypeDef)
dataTypeOf :: TypeDef -&gt; DataType
$cdataTypeOf :: TypeDef -&gt; DataType
toConstr :: TypeDef -&gt; Constr
$ctoConstr :: TypeDef -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c TypeDef
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c TypeDef
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeDef -&gt; c TypeDef
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeDef -&gt; c TypeDef
$cp1Data :: Typeable TypeDef
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">-- | Arguments to a data constructor, whose fields may or may not be named</span><span>
</span><span id="line-95"></span><span class="hs-keyword">data</span><span> </span><span id="TypeVariant"><span class="annot"><a href="IR.IR.html#TypeVariant"><span class="hs-identifier hs-var">TypeVariant</span></a></span></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="VariantNamed"><span class="annot"><a href="IR.IR.html#VariantNamed"><span class="hs-identifier hs-var">VariantNamed</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ A record with named fields</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="VariantUnnamed"><span class="annot"><a href="IR.IR.html#VariantUnnamed"><span class="hs-identifier hs-var">VariantUnnamed</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="IR.Types.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>        </span><span class="hs-comment">-- ^ An algebraic type with unnamed fields</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679528482"><span id="local-6989586621679528484"><span id="local-6989586621679528486"><span class="annot"><span class="annottext">Int -&gt; TypeVariant -&gt; ShowS
[TypeVariant] -&gt; ShowS
TypeVariant -&gt; String
(Int -&gt; TypeVariant -&gt; ShowS)
-&gt; (TypeVariant -&gt; String)
-&gt; ([TypeVariant] -&gt; ShowS)
-&gt; Show TypeVariant
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TypeVariant] -&gt; ShowS
$cshowList :: [TypeVariant] -&gt; ShowS
show :: TypeVariant -&gt; String
$cshow :: TypeVariant -&gt; String
showsPrec :: Int -&gt; TypeVariant -&gt; ShowS
$cshowsPrec :: Int -&gt; TypeVariant -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679528478"><span id="local-6989586621679528480"><span class="annot"><span class="annottext">TypeVariant -&gt; TypeVariant -&gt; Bool
(TypeVariant -&gt; TypeVariant -&gt; Bool)
-&gt; (TypeVariant -&gt; TypeVariant -&gt; Bool) -&gt; Eq TypeVariant
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TypeVariant -&gt; TypeVariant -&gt; Bool
$c/= :: TypeVariant -&gt; TypeVariant -&gt; Bool
== :: TypeVariant -&gt; TypeVariant -&gt; Bool
$c== :: TypeVariant -&gt; TypeVariant -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cVariantUnnamed"><span id="%24cVariantNamed"><span id="%24tTypeVariant"><span id="local-6989586621679528449"><span id="local-6989586621679528451"><span id="local-6989586621679528453"><span id="local-6989586621679528455"><span id="local-6989586621679528457"><span id="local-6989586621679528459"><span id="local-6989586621679528461"><span id="local-6989586621679528463"><span id="local-6989586621679528465"><span id="local-6989586621679528467"><span id="local-6989586621679528469"><span id="local-6989586621679528471"><span id="local-6989586621679528473"><span id="local-6989586621679528475"><span class="annot"><span class="annottext">Typeable TypeVariant
DataType
Constr
Typeable TypeVariant
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; TypeVariant -&gt; c TypeVariant)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c TypeVariant)
-&gt; (TypeVariant -&gt; Constr)
-&gt; (TypeVariant -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c TypeVariant))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e))
    -&gt; Maybe (c TypeVariant))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; TypeVariant -&gt; TypeVariant)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeVariant -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeVariant -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; TypeVariant -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeVariant -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeVariant -&gt; m TypeVariant)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeVariant -&gt; m TypeVariant)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeVariant -&gt; m TypeVariant)
-&gt; Data TypeVariant
TypeVariant -&gt; DataType
TypeVariant -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; TypeVariant -&gt; TypeVariant
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeVariant -&gt; c TypeVariant
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c TypeVariant
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeVariant -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; TypeVariant -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeVariant -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeVariant -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeVariant -&gt; m TypeVariant
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeVariant -&gt; m TypeVariant
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c TypeVariant
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeVariant -&gt; c TypeVariant
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c TypeVariant)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c TypeVariant)
$cVariantUnnamed :: Constr
$cVariantNamed :: Constr
$tTypeVariant :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeVariant -&gt; m TypeVariant
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeVariant -&gt; m TypeVariant
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeVariant -&gt; m TypeVariant
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeVariant -&gt; m TypeVariant
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeVariant -&gt; m TypeVariant
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeVariant -&gt; m TypeVariant
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeVariant -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeVariant -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; TypeVariant -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; TypeVariant -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeVariant -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeVariant -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeVariant -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeVariant -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; TypeVariant -&gt; TypeVariant
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; TypeVariant -&gt; TypeVariant
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c TypeVariant)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c TypeVariant)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c TypeVariant)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c TypeVariant)
dataTypeOf :: TypeVariant -&gt; DataType
$cdataTypeOf :: TypeVariant -&gt; DataType
toConstr :: TypeVariant -&gt; Constr
$ctoConstr :: TypeVariant -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c TypeVariant
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c TypeVariant
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeVariant -&gt; c TypeVariant
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeVariant -&gt; c TypeVariant
$cp1Data :: Typeable TypeVariant
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">{- | Literal values supported by the language.

Note that these don't carry any connotation of type: @1@ just means @1@,
-}</span><span>
</span><span id="line-105"></span><span class="hs-keyword">data</span><span> </span><span id="Literal"><span class="annot"><a href="IR.IR.html#Literal"><span class="hs-identifier hs-var">Literal</span></a></span></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="LitIntegral"><span class="annot"><a href="IR.IR.html#LitIntegral"><span class="hs-identifier hs-var">LitIntegral</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LitEvent"><span class="annot"><a href="IR.IR.html#LitEvent"><span class="hs-identifier hs-var">LitEvent</span></a></span></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679528440"><span id="local-6989586621679528442"><span class="annot"><span class="annottext">Literal -&gt; Literal -&gt; Bool
(Literal -&gt; Literal -&gt; Bool)
-&gt; (Literal -&gt; Literal -&gt; Bool) -&gt; Eq Literal
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Literal -&gt; Literal -&gt; Bool
$c/= :: Literal -&gt; Literal -&gt; Bool
== :: Literal -&gt; Literal -&gt; Bool
$c== :: Literal -&gt; Literal -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679528434"><span id="local-6989586621679528436"><span id="local-6989586621679528438"><span class="annot"><span class="annottext">Int -&gt; Literal -&gt; ShowS
[Literal] -&gt; ShowS
Literal -&gt; String
(Int -&gt; Literal -&gt; ShowS)
-&gt; (Literal -&gt; String) -&gt; ([Literal] -&gt; ShowS) -&gt; Show Literal
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Literal] -&gt; ShowS
$cshowList :: [Literal] -&gt; ShowS
show :: Literal -&gt; String
$cshow :: Literal -&gt; String
showsPrec :: Int -&gt; Literal -&gt; ShowS
$cshowsPrec :: Int -&gt; Literal -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cLitEvent"><span id="%24cLitIntegral"><span id="%24tLiteral"><span id="local-6989586621679528405"><span id="local-6989586621679528407"><span id="local-6989586621679528409"><span id="local-6989586621679528411"><span id="local-6989586621679528413"><span id="local-6989586621679528415"><span id="local-6989586621679528417"><span id="local-6989586621679528419"><span id="local-6989586621679528421"><span id="local-6989586621679528423"><span id="local-6989586621679528425"><span id="local-6989586621679528427"><span id="local-6989586621679528429"><span id="local-6989586621679528431"><span class="annot"><span class="annottext">Typeable Literal
DataType
Constr
Typeable Literal
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; Literal -&gt; c Literal)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Literal)
-&gt; (Literal -&gt; Constr)
-&gt; (Literal -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Literal))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Literal))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; Literal -&gt; Literal)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Literal -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Literal -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Literal -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Literal -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal)
-&gt; Data Literal
Literal -&gt; DataType
Literal -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; Literal -&gt; Literal
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Literal -&gt; c Literal
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Literal
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Literal -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Literal -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Literal -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Literal -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Literal
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Literal -&gt; c Literal
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Literal)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Literal)
$cLitEvent :: Constr
$cLitIntegral :: Constr
$tLiteral :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Literal -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Literal -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; Literal -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Literal -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Literal -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Literal -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Literal -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Literal -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Literal -&gt; Literal
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Literal -&gt; Literal
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Literal)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Literal)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Literal)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Literal)
dataTypeOf :: Literal -&gt; DataType
$cdataTypeOf :: Literal -&gt; DataType
toConstr :: Literal -&gt; Constr
$ctoConstr :: Literal -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Literal
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Literal
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Literal -&gt; c Literal
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Literal -&gt; c Literal
$cp1Data :: Typeable Literal
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">{- | Primitive operations.

These should be the kinds of functions one may expect to be available as
operators in C, or as instructions in an assembly language.

For simplicity and consistency, they should be:

- Pure (i.e., side-effectful iff operands are side-effectful, i.e., no @=@)
- Strict in all operands (i.e., no @&amp;&amp;@ or @||@)

We can instead implement short-circuit control flow using match statements.
-}</span><span>
</span><span id="line-122"></span><span class="hs-keyword">data</span><span> </span><span id="PrimOp"><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-var">PrimOp</span></a></span></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PrimNeg"><span class="annot"><a href="IR.IR.html#PrimNeg"><span class="hs-identifier hs-var">PrimNeg</span></a></span></span><span>     </span><span class="hs-comment">-- ^ negation, i.e., -x</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimNot"><span class="annot"><a href="IR.IR.html#PrimNot"><span class="hs-identifier hs-var">PrimNot</span></a></span></span><span>     </span><span class="hs-comment">-- ^ logical not, i.e., !x</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimBitNot"><span class="annot"><a href="IR.IR.html#PrimBitNot"><span class="hs-identifier hs-var">PrimBitNot</span></a></span></span><span>  </span><span class="hs-comment">-- ^ bitwise not, i.e., ~x</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimAdd"><span class="annot"><a href="IR.IR.html#PrimAdd"><span class="hs-identifier hs-var">PrimAdd</span></a></span></span><span>     </span><span class="hs-comment">-- ^ addition, i.e., x + y</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimSub"><span class="annot"><a href="IR.IR.html#PrimSub"><span class="hs-identifier hs-var">PrimSub</span></a></span></span><span>     </span><span class="hs-comment">-- ^ subtraction, i.e., x - y</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimMul"><span class="annot"><a href="IR.IR.html#PrimMul"><span class="hs-identifier hs-var">PrimMul</span></a></span></span><span>     </span><span class="hs-comment">-- ^ multiplication, i.e., x * y</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimDiv"><span class="annot"><a href="IR.IR.html#PrimDiv"><span class="hs-identifier hs-var">PrimDiv</span></a></span></span><span>     </span><span class="hs-comment">-- ^ division, i.e., x / y</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimMod"><span class="annot"><a href="IR.IR.html#PrimMod"><span class="hs-identifier hs-var">PrimMod</span></a></span></span><span>     </span><span class="hs-comment">-- ^ modulus, i.e., x % y</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimBitAnd"><span class="annot"><a href="IR.IR.html#PrimBitAnd"><span class="hs-identifier hs-var">PrimBitAnd</span></a></span></span><span>  </span><span class="hs-comment">-- ^ bitwise-and, i.e., x &amp; y</span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimBitOr"><span class="annot"><a href="IR.IR.html#PrimBitOr"><span class="hs-identifier hs-var">PrimBitOr</span></a></span></span><span>   </span><span class="hs-comment">-- ^ bitwise-or, i.e., x | y</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimEq"><span class="annot"><a href="IR.IR.html#PrimEq"><span class="hs-identifier hs-var">PrimEq</span></a></span></span><span>      </span><span class="hs-comment">-- ^ equality, i.e., x == y</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimNeq"><span class="annot"><a href="IR.IR.html#PrimNeq"><span class="hs-identifier hs-var">PrimNeq</span></a></span></span><span>     </span><span class="hs-comment">-- ^ equality, i.e., x != y</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimGt"><span class="annot"><a href="IR.IR.html#PrimGt"><span class="hs-identifier hs-var">PrimGt</span></a></span></span><span>      </span><span class="hs-comment">-- ^ greater than, i.e., x &gt; y</span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimGe"><span class="annot"><a href="IR.IR.html#PrimGe"><span class="hs-identifier hs-var">PrimGe</span></a></span></span><span>      </span><span class="hs-comment">-- ^ greater than or equal to, i.e., x &gt;= y</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimLt"><span class="annot"><a href="IR.IR.html#PrimLt"><span class="hs-identifier hs-var">PrimLt</span></a></span></span><span>      </span><span class="hs-comment">-- ^ less than, i.e., x &lt; y</span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimLe"><span class="annot"><a href="IR.IR.html#PrimLe"><span class="hs-identifier hs-var">PrimLe</span></a></span></span><span>      </span><span class="hs-comment">-- ^ less than or equal to, i.e., x &lt;= y</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679528382"><span id="local-6989586621679528384"><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; Bool
(PrimOp -&gt; PrimOp -&gt; Bool)
-&gt; (PrimOp -&gt; PrimOp -&gt; Bool) -&gt; Eq PrimOp
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PrimOp -&gt; PrimOp -&gt; Bool
$c/= :: PrimOp -&gt; PrimOp -&gt; Bool
== :: PrimOp -&gt; PrimOp -&gt; Bool
$c== :: PrimOp -&gt; PrimOp -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679528376"><span id="local-6989586621679528378"><span id="local-6989586621679528380"><span class="annot"><span class="annottext">Int -&gt; PrimOp -&gt; ShowS
[PrimOp] -&gt; ShowS
PrimOp -&gt; String
(Int -&gt; PrimOp -&gt; ShowS)
-&gt; (PrimOp -&gt; String) -&gt; ([PrimOp] -&gt; ShowS) -&gt; Show PrimOp
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PrimOp] -&gt; ShowS
$cshowList :: [PrimOp] -&gt; ShowS
show :: PrimOp -&gt; String
$cshow :: PrimOp -&gt; String
showsPrec :: Int -&gt; PrimOp -&gt; ShowS
$cshowsPrec :: Int -&gt; PrimOp -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cPrimLe"><span id="%24cPrimLt"><span id="%24cPrimGe"><span id="%24cPrimGt"><span id="%24cPrimNeq"><span id="%24cPrimEq"><span id="%24cPrimBitOr"><span id="%24cPrimBitAnd"><span id="%24cPrimMod"><span id="%24cPrimDiv"><span id="%24cPrimMul"><span id="%24cPrimSub"><span id="%24cPrimAdd"><span id="%24cPrimBitNot"><span id="%24cPrimNot"><span id="%24cPrimNeg"><span id="%24tPrimOp"><span id="local-6989586621679528347"><span id="local-6989586621679528349"><span id="local-6989586621679528351"><span id="local-6989586621679528353"><span id="local-6989586621679528355"><span id="local-6989586621679528357"><span id="local-6989586621679528359"><span id="local-6989586621679528361"><span id="local-6989586621679528363"><span id="local-6989586621679528365"><span id="local-6989586621679528367"><span id="local-6989586621679528369"><span id="local-6989586621679528371"><span id="local-6989586621679528373"><span class="annot"><span class="annottext">Typeable PrimOp
DataType
Constr
Typeable PrimOp
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; PrimOp -&gt; c PrimOp)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c PrimOp)
-&gt; (PrimOp -&gt; Constr)
-&gt; (PrimOp -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c PrimOp))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c PrimOp))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; PrimOp -&gt; PrimOp)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; PrimOp -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; PrimOp -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; PrimOp -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; PrimOp -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp)
-&gt; Data PrimOp
PrimOp -&gt; DataType
PrimOp -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; PrimOp -&gt; PrimOp
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; PrimOp -&gt; c PrimOp
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c PrimOp
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; PrimOp -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; PrimOp -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; PrimOp -&gt; r
forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; PrimOp -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c PrimOp
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; PrimOp -&gt; c PrimOp
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c PrimOp)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c PrimOp)
$cPrimLe :: Constr
$cPrimLt :: Constr
$cPrimGe :: Constr
$cPrimGt :: Constr
$cPrimNeq :: Constr
$cPrimEq :: Constr
$cPrimBitOr :: Constr
$cPrimBitAnd :: Constr
$cPrimMod :: Constr
$cPrimDiv :: Constr
$cPrimMul :: Constr
$cPrimSub :: Constr
$cPrimAdd :: Constr
$cPrimBitNot :: Constr
$cPrimNot :: Constr
$cPrimNeg :: Constr
$tPrimOp :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; PrimOp -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; PrimOp -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; PrimOp -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; PrimOp -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; PrimOp -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; PrimOp -&gt; r
gmapQl :: (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; PrimOp -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; PrimOp -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; PrimOp -&gt; PrimOp
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; PrimOp -&gt; PrimOp
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c PrimOp)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c PrimOp)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c PrimOp)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c PrimOp)
dataTypeOf :: PrimOp -&gt; DataType
$cdataTypeOf :: PrimOp -&gt; DataType
toConstr :: PrimOp -&gt; Constr
$ctoConstr :: PrimOp -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c PrimOp
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c PrimOp
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; PrimOp -&gt; c PrimOp
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; PrimOp -&gt; c PrimOp
$cp1Data :: Typeable PrimOp
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | Primitive functions for side-effects and imperative control flow.</span><span>
</span><span id="line-142"></span><span class="hs-keyword">data</span><span> </span><span id="Primitive"><span class="annot"><a href="IR.IR.html#Primitive"><span class="hs-identifier hs-var">Primitive</span></a></span></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="New"><span class="annot"><a href="IR.IR.html#New"><span class="hs-identifier hs-var">New</span></a></span></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-comment">{- ^ @New e@ allocates a schedule variable initialized to @e@, and
  returns a reference to it.
  -}</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Dup"><span class="annot"><a href="IR.IR.html#Dup"><span class="hs-identifier hs-var">Dup</span></a></span></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-comment">{- ^ @Dup r@ dups the reference @r@ and returns @r@. -}</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Drop"><span class="annot"><a href="IR.IR.html#Drop"><span class="hs-identifier hs-var">Drop</span></a></span></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-comment">{- ^ @Drop e r@ evaluates to @e@, but also drops @r@. -}</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Deref"><span class="annot"><a href="IR.IR.html#Deref"><span class="hs-identifier hs-var">Deref</span></a></span></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-comment">{- ^ @Deref r@ dereferences reference @r@ to obtain its value. -}</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Assign"><span class="annot"><a href="IR.IR.html#Assign"><span class="hs-identifier hs-var">Assign</span></a></span></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-comment">{- ^ @Assign r e@ instantly assigns value @e@ to reference @r@. -}</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="After"><span class="annot"><a href="IR.IR.html#After"><span class="hs-identifier hs-var">After</span></a></span></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-comment">{- ^ @After t r e@ assigns @e@ to reference @r@ after time @t@. -}</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Par"><span class="annot"><a href="IR.IR.html#Par"><span class="hs-identifier hs-var">Par</span></a></span></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-comment">{- ^ @Par  es+@ evaluates expressions @es@ concurrently. -}</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Wait"><span class="annot"><a href="IR.IR.html#Wait"><span class="hs-identifier hs-var">Wait</span></a></span></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-comment">{- ^ @Wait rs+@ waits for an assignment to any reference in @rs@. -}</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Loop"><span class="annot"><a href="IR.IR.html#Loop"><span class="hs-identifier hs-var">Loop</span></a></span></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-comment">{- ^ @Loop b@ loops body @b@ forever. -}</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Break"><span class="annot"><a href="IR.IR.html#Break"><span class="hs-identifier hs-var">Break</span></a></span></span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-comment">{- ^ @Break@ breaks out of the innermost loop. -}</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Now"><span class="annot"><a href="IR.IR.html#Now"><span class="hs-identifier hs-var">Now</span></a></span></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-comment">{- ^ @Now@ obtains the value of the current instant -}</span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimOp"><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-var">PrimOp</span></a></span></span><span> </span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-comment">{- ^ Inlined C expression code. -}</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CQuote"><span class="annot"><a href="IR.IR.html#CQuote"><span class="hs-identifier hs-var">CQuote</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-comment">{- ^ Primitive operator. -}</span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CCall"><span class="annot"><a href="IR.IR.html#CCall"><span class="hs-identifier hs-var">CCall</span></a></span></span><span> </span><span class="annot"><a href="Common.Identifiers.html#CSym"><span class="hs-identifier hs-type">CSym</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-comment">{- ^ Direct call to arbitrary C function (NOTE: HACKY). -}</span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FfiCall"><span class="annot"><a href="IR.IR.html#FfiCall"><span class="hs-identifier hs-var">FfiCall</span></a></span></span><span> </span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-comment">{- ^ Call to well-typed extern symbol. -}</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679528311"><span id="local-6989586621679528313"><span class="annot"><span class="annottext">Primitive -&gt; Primitive -&gt; Bool
(Primitive -&gt; Primitive -&gt; Bool)
-&gt; (Primitive -&gt; Primitive -&gt; Bool) -&gt; Eq Primitive
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Primitive -&gt; Primitive -&gt; Bool
$c/= :: Primitive -&gt; Primitive -&gt; Bool
== :: Primitive -&gt; Primitive -&gt; Bool
$c== :: Primitive -&gt; Primitive -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679528305"><span id="local-6989586621679528307"><span id="local-6989586621679528309"><span class="annot"><span class="annottext">Int -&gt; Primitive -&gt; ShowS
[Primitive] -&gt; ShowS
Primitive -&gt; String
(Int -&gt; Primitive -&gt; ShowS)
-&gt; (Primitive -&gt; String)
-&gt; ([Primitive] -&gt; ShowS)
-&gt; Show Primitive
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Primitive] -&gt; ShowS
$cshowList :: [Primitive] -&gt; ShowS
show :: Primitive -&gt; String
$cshow :: Primitive -&gt; String
showsPrec :: Int -&gt; Primitive -&gt; ShowS
$cshowsPrec :: Int -&gt; Primitive -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cFfiCall"><span id="%24cCCall"><span id="%24cCQuote"><span id="%24cPrimOp"><span id="%24cNow"><span id="%24cBreak"><span id="%24cLoop"><span id="%24cWait"><span id="%24cPar"><span id="%24cAfter"><span id="%24cAssign"><span id="%24cDeref"><span id="%24cDrop"><span id="%24cDup"><span id="%24cNew"><span id="%24tPrimitive"><span id="local-6989586621679528276"><span id="local-6989586621679528278"><span id="local-6989586621679528280"><span id="local-6989586621679528282"><span id="local-6989586621679528284"><span id="local-6989586621679528286"><span id="local-6989586621679528288"><span id="local-6989586621679528290"><span id="local-6989586621679528292"><span id="local-6989586621679528294"><span id="local-6989586621679528296"><span id="local-6989586621679528298"><span id="local-6989586621679528300"><span id="local-6989586621679528302"><span class="annot"><span class="annottext">Typeable Primitive
DataType
Constr
Typeable Primitive
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; Primitive -&gt; c Primitive)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Primitive)
-&gt; (Primitive -&gt; Constr)
-&gt; (Primitive -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Primitive))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Primitive))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; Primitive -&gt; Primitive)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Primitive -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Primitive -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Primitive -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Primitive -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive)
-&gt; Data Primitive
Primitive -&gt; DataType
Primitive -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; Primitive -&gt; Primitive
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Primitive -&gt; c Primitive
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Primitive
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Primitive -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Primitive -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Primitive -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Primitive -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Primitive
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Primitive -&gt; c Primitive
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Primitive)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Primitive)
$cFfiCall :: Constr
$cCCall :: Constr
$cCQuote :: Constr
$cPrimOp :: Constr
$cNow :: Constr
$cBreak :: Constr
$cLoop :: Constr
$cWait :: Constr
$cPar :: Constr
$cAfter :: Constr
$cAssign :: Constr
$cDeref :: Constr
$cDrop :: Constr
$cDup :: Constr
$cNew :: Constr
$tPrimitive :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Primitive -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Primitive -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; Primitive -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Primitive -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Primitive -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Primitive -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Primitive -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Primitive -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Primitive -&gt; Primitive
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Primitive -&gt; Primitive
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Primitive)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Primitive)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Primitive)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Primitive)
dataTypeOf :: Primitive -&gt; DataType
$cdataTypeOf :: Primitive -&gt; DataType
toConstr :: Primitive -&gt; Constr
$ctoConstr :: Primitive -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Primitive
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Primitive
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Primitive -&gt; c Primitive
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Primitive -&gt; c Primitive
$cp1Data :: Typeable Primitive
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">{- | Expressions, based on the let-polymorphic lambda calculus.

@t@ represents the type of this expression, e.g., 'IR.Types.Flat'. At
various stages, this may represent a richer or simpler type
system. The type is embedded in each data constructor so as to
type-annotate the entire expression tree.

Designed for side effects with call-by-value evaluation order. Basic
sequencing can be recovered through let-bindings:

&gt; let _ = stmt1 in
&gt; let _ = stmt2 in
&gt; ...

Effects of @stmt1@ take place before that of @stmt2@.
-}</span><span>
</span><span id="line-193"></span><span class="hs-keyword">data</span><span> </span><span id="Expr"><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span></span><span> </span><span id="local-6989586621679528739"><span class="annot"><a href="#local-6989586621679528739"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Var"><span class="annot"><a href="IR.IR.html#Var"><span class="hs-identifier hs-var">Var</span></a></span></span><span> </span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528739"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-comment">{- ^ @Var n t@ is a variable named @n@ of type @t@. -}</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Data"><span class="annot"><a href="IR.IR.html#Data"><span class="hs-identifier hs-var">Data</span></a></span></span><span> </span><span class="annot"><a href="Common.Identifiers.html#DConId"><span class="hs-identifier hs-type">DConId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528739"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-comment">{- ^ @Data d t@ is a data constructor named @d@ of type @t@. -}</span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Lit"><span class="annot"><a href="IR.IR.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span></span><span> </span><span class="annot"><a href="IR.IR.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528739"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-comment">{- ^ @Lit l t@ is a literal value @l@ of type @t@. -}</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="App"><span class="annot"><a href="IR.IR.html#App"><span class="hs-identifier hs-var">App</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528739"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528739"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679528739"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-comment">{- ^ @App f a t@ applies function @f@ to argument @a@, producing a value of
  type @t@.
  -}</span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Let"><span class="annot"><a href="IR.IR.html#Let"><span class="hs-identifier hs-var">Let</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528739"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528739"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679528739"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-comment">{- ^ @Let [(n, v)] b t@ binds value @v@ to variable @v@ in its body @b@.

  The bindings list may only be of length greater than 1 for a set of mutually
  co-recursive functions.
  -}</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Lambda"><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a></span></span><span> </span><span class="annot"><a href="Common.Identifiers.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528739"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679528739"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-comment">{- ^ @Lambda v b t@ constructs an anonymous function of type @t@ that binds
  a value to parameter @v@ in its body @b@.
  -}</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Match"><span class="annot"><a href="IR.IR.html#Match"><span class="hs-identifier hs-var">Match</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528739"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528739"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679528739"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-comment">{- ^ @Match s alts t@ pattern-matches on scrutinee @s@ against alternatives
  @alts@, each producing a value of type @t@.
  -}</span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Prim"><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-var">Prim</span></a></span></span><span> </span><span class="annot"><a href="IR.IR.html#Primitive"><span class="hs-identifier hs-type">Primitive</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528739"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679528739"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-comment">{- ^ @Prim p es t@ applies primitive @p@ arguments @es@, producing a value
  of type @t@.
  -}</span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679528248"><span id="local-6989586621679528250"><span class="annot"><span class="annottext">Expr t -&gt; Expr t -&gt; Bool
(Expr t -&gt; Expr t -&gt; Bool)
-&gt; (Expr t -&gt; Expr t -&gt; Bool) -&gt; Eq (Expr t)
forall t. Eq t =&gt; Expr t -&gt; Expr t -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Expr t -&gt; Expr t -&gt; Bool
$c/= :: forall t. Eq t =&gt; Expr t -&gt; Expr t -&gt; Bool
== :: Expr t -&gt; Expr t -&gt; Bool
$c== :: forall t. Eq t =&gt; Expr t -&gt; Expr t -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679528242"><span id="local-6989586621679528244"><span id="local-6989586621679528246"><span class="annot"><span class="annottext">Int -&gt; Expr t -&gt; ShowS
[Expr t] -&gt; ShowS
Expr t -&gt; String
(Int -&gt; Expr t -&gt; ShowS)
-&gt; (Expr t -&gt; String) -&gt; ([Expr t] -&gt; ShowS) -&gt; Show (Expr t)
forall t. Show t =&gt; Int -&gt; Expr t -&gt; ShowS
forall t. Show t =&gt; [Expr t] -&gt; ShowS
forall t. Show t =&gt; Expr t -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Expr t] -&gt; ShowS
$cshowList :: forall t. Show t =&gt; [Expr t] -&gt; ShowS
show :: Expr t -&gt; String
$cshow :: forall t. Show t =&gt; Expr t -&gt; String
showsPrec :: Int -&gt; Expr t -&gt; ShowS
$cshowsPrec :: forall t. Show t =&gt; Int -&gt; Expr t -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cPrim"><span id="%24cMatch"><span id="%24cLambda"><span id="%24cLet"><span id="%24cApp"><span id="%24cLit"><span id="%24cData"><span id="%24cVar"><span id="%24tExpr"><span id="local-6989586621679528213"><span id="local-6989586621679528215"><span id="local-6989586621679528217"><span id="local-6989586621679528219"><span id="local-6989586621679528221"><span id="local-6989586621679528223"><span id="local-6989586621679528225"><span id="local-6989586621679528227"><span id="local-6989586621679528229"><span id="local-6989586621679528231"><span id="local-6989586621679528233"><span id="local-6989586621679528235"><span id="local-6989586621679528237"><span id="local-6989586621679528239"><span class="annot"><span class="annottext">Typeable (Expr t)
DataType
Constr
Typeable (Expr t)
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; Expr t -&gt; c (Expr t))
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Expr t))
-&gt; (Expr t -&gt; Constr)
-&gt; (Expr t -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Expr t)))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c (Expr t)))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; Expr t -&gt; Expr t)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t))
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t))
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t))
-&gt; Data (Expr t)
Expr t -&gt; DataType
Expr t -&gt; Constr
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Expr t))
(forall b. Data b =&gt; b -&gt; b) -&gt; Expr t -&gt; Expr t
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Expr t -&gt; c (Expr t)
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Expr t)
forall t. Data t =&gt; Typeable (Expr t)
forall t. Data t =&gt; Expr t -&gt; DataType
forall t. Data t =&gt; Expr t -&gt; Constr
forall t.
Data t =&gt;
(forall b. Data b =&gt; b -&gt; b) -&gt; Expr t -&gt; Expr t
forall t u.
Data t =&gt;
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; u
forall t u. Data t =&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; [u]
forall t r r'.
Data t =&gt;
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r
forall t r r'.
Data t =&gt;
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r
forall t (m :: * -&gt; *).
(Data t, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
forall t (c :: * -&gt; *).
Data t =&gt;
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Expr t)
forall t (c :: * -&gt; *).
Data t =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Expr t -&gt; c (Expr t)
forall t (t :: * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Expr t))
forall t (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c (Expr t))
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r
forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Expr t)
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Expr t -&gt; c (Expr t)
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Expr t))
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c (Expr t))
$cPrim :: Constr
$cMatch :: Constr
$cLambda :: Constr
$cLet :: Constr
$cApp :: Constr
$cLit :: Constr
$cData :: Constr
$cVar :: Constr
$tExpr :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
$cgmapMo :: forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
$cgmapMp :: forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
$cgmapM :: forall t (m :: * -&gt; *).
(Data t, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; u
$cgmapQi :: forall t u.
Data t =&gt;
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; [u]
$cgmapQ :: forall t u. Data t =&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r
$cgmapQr :: forall t r r'.
Data t =&gt;
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r
gmapQl :: (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r
$cgmapQl :: forall t r r'.
Data t =&gt;
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Expr t -&gt; Expr t
$cgmapT :: forall t.
Data t =&gt;
(forall b. Data b =&gt; b -&gt; b) -&gt; Expr t -&gt; Expr t
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c (Expr t))
$cdataCast2 :: forall t (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c (Expr t))
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Expr t))
$cdataCast1 :: forall t (t :: * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Expr t))
dataTypeOf :: Expr t -&gt; DataType
$cdataTypeOf :: forall t. Data t =&gt; Expr t -&gt; DataType
toConstr :: Expr t -&gt; Constr
$ctoConstr :: forall t. Data t =&gt; Expr t -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Expr t)
$cgunfold :: forall t (c :: * -&gt; *).
Data t =&gt;
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Expr t)
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Expr t -&gt; c (Expr t)
$cgfoldl :: forall t (c :: * -&gt; *).
Data t =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Expr t -&gt; c (Expr t)
$cp1Data :: forall t. Data t =&gt; Typeable (Expr t)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679528200"><span id="local-6989586621679528202"><span class="annot"><span class="annottext">a -&gt; Expr b -&gt; Expr a
(a -&gt; b) -&gt; Expr a -&gt; Expr b
(forall a b. (a -&gt; b) -&gt; Expr a -&gt; Expr b)
-&gt; (forall a b. a -&gt; Expr b -&gt; Expr a) -&gt; Functor Expr
forall a b. a -&gt; Expr b -&gt; Expr a
forall a b. (a -&gt; b) -&gt; Expr a -&gt; Expr b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; Expr b -&gt; Expr a
$c&lt;$ :: forall a b. a -&gt; Expr b -&gt; Expr a
fmap :: (a -&gt; b) -&gt; Expr a -&gt; Expr b
$cfmap :: forall a b. (a -&gt; b) -&gt; Expr a -&gt; Expr b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679528166"><span id="local-6989586621679528168"><span id="local-6989586621679528170"><span id="local-6989586621679528172"><span id="local-6989586621679528174"><span id="local-6989586621679528176"><span id="local-6989586621679528178"><span id="local-6989586621679528180"><span id="local-6989586621679528182"><span id="local-6989586621679528184"><span id="local-6989586621679528186"><span id="local-6989586621679528188"><span id="local-6989586621679528190"><span id="local-6989586621679528192"><span id="local-6989586621679528194"><span id="local-6989586621679528196"><span id="local-6989586621679528198"><span class="annot"><span class="annottext">Expr a -&gt; Bool
(a -&gt; m) -&gt; Expr a -&gt; m
(a -&gt; b -&gt; b) -&gt; b -&gt; Expr a -&gt; b
(forall m. Monoid m =&gt; Expr m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Expr a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Expr a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Expr a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Expr a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Expr a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Expr a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; Expr a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; Expr a -&gt; a)
-&gt; (forall a. Expr a -&gt; [a])
-&gt; (forall a. Expr a -&gt; Bool)
-&gt; (forall a. Expr a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; Expr a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; Expr a -&gt; a)
-&gt; (forall a. Ord a =&gt; Expr a -&gt; a)
-&gt; (forall a. Num a =&gt; Expr a -&gt; a)
-&gt; (forall a. Num a =&gt; Expr a -&gt; a)
-&gt; Foldable Expr
forall a. Eq a =&gt; a -&gt; Expr a -&gt; Bool
forall a. Num a =&gt; Expr a -&gt; a
forall a. Ord a =&gt; Expr a -&gt; a
forall m. Monoid m =&gt; Expr m -&gt; m
forall a. Expr a -&gt; Bool
forall a. Expr a -&gt; Int
forall a. Expr a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; Expr a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Expr a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Expr a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Expr a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: Expr a -&gt; a
$cproduct :: forall a. Num a =&gt; Expr a -&gt; a
sum :: Expr a -&gt; a
$csum :: forall a. Num a =&gt; Expr a -&gt; a
minimum :: Expr a -&gt; a
$cminimum :: forall a. Ord a =&gt; Expr a -&gt; a
maximum :: Expr a -&gt; a
$cmaximum :: forall a. Ord a =&gt; Expr a -&gt; a
elem :: a -&gt; Expr a -&gt; Bool
$celem :: forall a. Eq a =&gt; a -&gt; Expr a -&gt; Bool
length :: Expr a -&gt; Int
$clength :: forall a. Expr a -&gt; Int
null :: Expr a -&gt; Bool
$cnull :: forall a. Expr a -&gt; Bool
toList :: Expr a -&gt; [a]
$ctoList :: forall a. Expr a -&gt; [a]
foldl1 :: (a -&gt; a -&gt; a) -&gt; Expr a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; Expr a -&gt; a
foldr1 :: (a -&gt; a -&gt; a) -&gt; Expr a -&gt; a
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; Expr a -&gt; a
foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; Expr a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Expr a -&gt; b
foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; Expr a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Expr a -&gt; b
foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; Expr a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Expr a -&gt; b
foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; Expr a -&gt; b
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Expr a -&gt; b
foldMap' :: (a -&gt; m) -&gt; Expr a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Expr a -&gt; m
foldMap :: (a -&gt; m) -&gt; Expr a -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Expr a -&gt; m
fold :: Expr m -&gt; m
$cfold :: forall m. Monoid m =&gt; Expr m -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679528155"><span id="local-6989586621679528157"><span id="local-6989586621679528159"><span id="local-6989586621679528161"><span class="annot"><span class="annottext">Functor Expr
Foldable Expr
Functor Expr
-&gt; Foldable Expr
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; Expr a -&gt; f (Expr b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    Expr (f a) -&gt; f (Expr a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; Expr a -&gt; m (Expr b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; Expr (m a) -&gt; m (Expr a))
-&gt; Traversable Expr
(a -&gt; f b) -&gt; Expr a -&gt; f (Expr b)
forall (t :: * -&gt; *).
Functor t
-&gt; Foldable t
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a. Monad m =&gt; Expr (m a) -&gt; m (Expr a)
forall (f :: * -&gt; *) a. Applicative f =&gt; Expr (f a) -&gt; f (Expr a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Expr a -&gt; m (Expr b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Expr a -&gt; f (Expr b)
sequence :: Expr (m a) -&gt; m (Expr a)
$csequence :: forall (m :: * -&gt; *) a. Monad m =&gt; Expr (m a) -&gt; m (Expr a)
mapM :: (a -&gt; m b) -&gt; Expr a -&gt; m (Expr b)
$cmapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Expr a -&gt; m (Expr b)
sequenceA :: Expr (f a) -&gt; f (Expr a)
$csequenceA :: forall (f :: * -&gt; *) a. Applicative f =&gt; Expr (f a) -&gt; f (Expr a)
traverse :: (a -&gt; f b) -&gt; Expr a -&gt; f (Expr b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Expr a -&gt; f (Expr b)
$cp2Traversable :: Foldable Expr
$cp1Traversable :: Functor Expr
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | An alternative in a pattern-match.</span><span>
</span><span id="line-225"></span><span class="hs-keyword">data</span><span> </span><span id="Alt"><span class="annot"><a href="IR.IR.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="AltData"><span class="annot"><a href="IR.IR.html#AltData"><span class="hs-identifier hs-var">AltData</span></a></span></span><span> </span><span class="annot"><a href="Common.Identifiers.html#DConId"><span class="hs-identifier hs-type">DConId</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="IR.IR.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-comment">-- ^ @AltData d vs@ matches data constructor @d@, and recursive patterns @alts@.</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AltLit"><span class="annot"><a href="IR.IR.html#AltLit"><span class="hs-identifier hs-var">AltLit</span></a></span></span><span> </span><span class="annot"><a href="IR.IR.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-comment">-- ^ @AltLit l@ matches against literal @l@, producing expression @e@.</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AltBinder"><span class="annot"><a href="IR.IR.html#AltBinder"><span class="hs-identifier hs-var">AltBinder</span></a></span></span><span> </span><span class="annot"><a href="Common.Identifiers.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-comment">-- ^ @AltBinder v@ matches anything, and bound to name @v@.</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679528147"><span id="local-6989586621679528149"><span class="annot"><span class="annottext">Alt -&gt; Alt -&gt; Bool
(Alt -&gt; Alt -&gt; Bool) -&gt; (Alt -&gt; Alt -&gt; Bool) -&gt; Eq Alt
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Alt -&gt; Alt -&gt; Bool
$c/= :: Alt -&gt; Alt -&gt; Bool
== :: Alt -&gt; Alt -&gt; Bool
$c== :: Alt -&gt; Alt -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679528141"><span id="local-6989586621679528143"><span id="local-6989586621679528145"><span class="annot"><span class="annottext">Int -&gt; Alt -&gt; ShowS
[Alt] -&gt; ShowS
Alt -&gt; String
(Int -&gt; Alt -&gt; ShowS)
-&gt; (Alt -&gt; String) -&gt; ([Alt] -&gt; ShowS) -&gt; Show Alt
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Alt] -&gt; ShowS
$cshowList :: [Alt] -&gt; ShowS
show :: Alt -&gt; String
$cshow :: Alt -&gt; String
showsPrec :: Int -&gt; Alt -&gt; ShowS
$cshowsPrec :: Int -&gt; Alt -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cAltBinder"><span id="%24cAltLit"><span id="%24cAltData"><span id="%24tAlt"><span id="local-6989586621679528112"><span id="local-6989586621679528114"><span id="local-6989586621679528116"><span id="local-6989586621679528118"><span id="local-6989586621679528120"><span id="local-6989586621679528122"><span id="local-6989586621679528124"><span id="local-6989586621679528126"><span id="local-6989586621679528128"><span id="local-6989586621679528130"><span id="local-6989586621679528132"><span id="local-6989586621679528134"><span id="local-6989586621679528136"><span id="local-6989586621679528138"><span class="annot"><span class="annottext">Typeable Alt
DataType
Constr
Typeable Alt
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; Alt -&gt; c Alt)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Alt)
-&gt; (Alt -&gt; Constr)
-&gt; (Alt -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Alt))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Alt))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; Alt -&gt; Alt)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Alt -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Alt -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Alt -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Alt -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt)
-&gt; Data Alt
Alt -&gt; DataType
Alt -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; Alt -&gt; Alt
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Alt -&gt; c Alt
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Alt
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Alt -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Alt -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Alt -&gt; r
forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Alt -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Alt
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Alt -&gt; c Alt
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Alt)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Alt)
$cAltBinder :: Constr
$cAltLit :: Constr
$cAltData :: Constr
$tAlt :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Alt -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Alt -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; Alt -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Alt -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Alt -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Alt -&gt; r
gmapQl :: (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Alt -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Alt -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Alt -&gt; Alt
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Alt -&gt; Alt
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Alt)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Alt)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Alt)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Alt)
dataTypeOf :: Alt -&gt; DataType
$cdataTypeOf :: Alt -&gt; DataType
toConstr :: Alt -&gt; Constr
$ctoConstr :: Alt -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Alt
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Alt
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Alt -&gt; c Alt
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Alt -&gt; c Alt
$cp1Data :: Typeable Alt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">-- | The number of fields in a 'TypeVariant'.</span><span>
</span><span id="line-235"></span><span class="annot"><a href="IR.IR.html#variantFields"><span class="hs-identifier hs-type">variantFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.IR.html#TypeVariant"><span class="hs-identifier hs-type">TypeVariant</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-236"></span><span id="variantFields"><span class="annot"><span class="annottext">variantFields :: TypeVariant -&gt; Int
</span><a href="IR.IR.html#variantFields"><span class="hs-identifier hs-var hs-var">variantFields</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#VariantNamed"><span class="hs-identifier hs-type">VariantNamed</span></a></span><span>   </span><span id="local-6989586621679528107"><span class="annot"><span class="annottext">[(VarId, Type)]
</span><a href="#local-6989586621679528107"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(VarId, Type)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(VarId, Type)]
</span><a href="#local-6989586621679528107"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-237"></span><span class="annot"><a href="IR.IR.html#variantFields"><span class="hs-identifier hs-var">variantFields</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#VariantUnnamed"><span class="hs-identifier hs-type">VariantUnnamed</span></a></span><span> </span><span id="local-6989586621679528105"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679528105"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679528105"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- | Extract the type carried by an 'Expr'.</span><span>
</span><span id="line-240"></span><span id="local-6989586621679528728"><span class="annot"><a href="IR.IR.html#extract"><span class="hs-identifier hs-type">extract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528728"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679528728"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-241"></span><span id="extract"><span class="annot"><span class="annottext">extract :: Expr t -&gt; t
</span><a href="IR.IR.html#extract"><span class="hs-identifier hs-var hs-var">extract</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>  </span><span class="annot"><span class="annottext">VarId
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679528104"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528104"><span class="hs-identifier hs-var">t</span></a></span></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528104"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-242"></span><span class="annot"><a href="IR.IR.html#extract"><span class="hs-identifier hs-var">extract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><span class="annottext">DConId
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679528103"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528103"><span class="hs-identifier hs-var">t</span></a></span></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528103"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-243"></span><span class="annot"><a href="IR.IR.html#extract"><span class="hs-identifier hs-var">extract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span>  </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679528102"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528102"><span class="hs-identifier hs-var">t</span></a></span></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528102"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-244"></span><span class="annot"><a href="IR.IR.html#extract"><span class="hs-identifier hs-var">extract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span>    </span><span class="annot"><span class="annottext">[(Binder, Expr t)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679528101"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528101"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528101"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-245"></span><span class="annot"><a href="IR.IR.html#extract"><span class="hs-identifier hs-var">extract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span class="annot"><span class="annottext">Binder
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679528100"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528100"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528100"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-246"></span><span class="annot"><a href="IR.IR.html#extract"><span class="hs-identifier hs-var">extract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#App"><span class="hs-identifier hs-type">App</span></a></span><span>    </span><span class="annot"><span class="annottext">Expr t
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679528099"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528099"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528099"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-247"></span><span class="annot"><a href="IR.IR.html#extract"><span class="hs-identifier hs-var">extract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span>  </span><span class="annot"><span class="annottext">Expr t
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(Alt, Expr t)]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679528098"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528098"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528098"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-248"></span><span class="annot"><a href="IR.IR.html#extract"><span class="hs-identifier hs-var">extract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>   </span><span class="annot"><span class="annottext">Primitive
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Expr t]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679528097"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528097"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528097"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">-- | Replace the top-level type carried by an 'Expr'.</span><span>
</span><span id="line-251"></span><span id="local-6989586621679528096"><span class="annot"><a href="IR.IR.html#inject"><span class="hs-identifier hs-type">inject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679528096"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528096"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528096"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-252"></span><span id="inject"><span class="annot"><span class="annottext">inject :: t -&gt; Expr t -&gt; Expr t
</span><a href="IR.IR.html#inject"><span class="hs-identifier hs-var hs-var">inject</span></a></span></span><span> </span><span id="local-6989586621679528095"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528095"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>  </span><span id="local-6989586621679528094"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679528094"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarId -&gt; t -&gt; Expr t
forall t. VarId -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679528094"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528095"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-253"></span><span class="annot"><a href="IR.IR.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span id="local-6989586621679528093"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528093"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span id="local-6989586621679528092"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679528092"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DConId -&gt; t -&gt; Expr t
forall t. DConId -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Data"><span class="hs-identifier hs-var">Data</span></a></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679528092"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528093"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-254"></span><span class="annot"><a href="IR.IR.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span id="local-6989586621679528091"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528091"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span>  </span><span id="local-6989586621679528090"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679528090"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; t -&gt; Expr t
forall t. Literal -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679528090"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528091"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-255"></span><span class="annot"><a href="IR.IR.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span id="local-6989586621679528089"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528089"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span>    </span><span id="local-6989586621679528088"><span class="annot"><span class="annottext">[(Binder, Expr t)]
</span><a href="#local-6989586621679528088"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span id="local-6989586621679528087"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528087"><span class="hs-identifier hs-var">b</span></a></span></span><span>  </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Binder, Expr t)] -&gt; Expr t -&gt; t -&gt; Expr t
forall t. [(Binder, Expr t)] -&gt; Expr t -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="annot"><span class="annottext">[(Binder, Expr t)]
</span><a href="#local-6989586621679528088"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528087"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528089"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-256"></span><span class="annot"><a href="IR.IR.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span id="local-6989586621679528086"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528086"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span id="local-6989586621679528085"><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679528085"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679528084"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528084"><span class="hs-identifier hs-var">b</span></a></span></span><span>  </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binder -&gt; Expr t -&gt; t -&gt; Expr t
forall t. Binder -&gt; Expr t -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a></span><span> </span><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679528085"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528084"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528086"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-257"></span><span class="annot"><a href="IR.IR.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span id="local-6989586621679528083"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528083"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#App"><span class="hs-identifier hs-type">App</span></a></span><span>    </span><span id="local-6989586621679528082"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528082"><span class="hs-identifier hs-var">h</span></a></span></span><span>  </span><span id="local-6989586621679528081"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528081"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Expr t -&gt; t -&gt; Expr t
forall t. Expr t -&gt; Expr t -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528082"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528081"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528083"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-258"></span><span class="annot"><a href="IR.IR.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span id="local-6989586621679528080"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528080"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span>  </span><span id="local-6989586621679528079"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528079"><span class="hs-identifier hs-var">s</span></a></span></span><span>  </span><span id="local-6989586621679528078"><span class="annot"><span class="annottext">[(Alt, Expr t)]
</span><a href="#local-6989586621679528078"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; [(Alt, Expr t)] -&gt; t -&gt; Expr t
forall t. Expr t -&gt; [(Alt, Expr t)] -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Match"><span class="hs-identifier hs-var">Match</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528079"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[(Alt, Expr t)]
</span><a href="#local-6989586621679528078"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528080"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-259"></span><span class="annot"><a href="IR.IR.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span id="local-6989586621679528077"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528077"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>   </span><span id="local-6989586621679528076"><span class="annot"><span class="annottext">Primitive
</span><a href="#local-6989586621679528076"><span class="hs-identifier hs-var">p</span></a></span></span><span>  </span><span id="local-6989586621679528075"><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679528075"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Primitive -&gt; [Expr t] -&gt; t -&gt; Expr t
forall t. Primitive -&gt; [Expr t] -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Prim"><span class="hs-identifier hs-var">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="#local-6989586621679528076"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679528075"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528077"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-comment">{- | Collect a curried application into the function and argument list.

The type accompanying each argument represents type produced by the
application, and is extracted from the 'App' node that this function unwraps.

For example, the term @f a b@ (where @a: A@ and @b: B@) would be represented by
the following AST:
@@
(App (App (Var f (A -&gt; B -&gt; C)) (Var a A) (B -&gt; C)) (Var b B) C)
@@

which, when unzipped, gives:

@@
(Var f (A -&gt; B -&gt; C)) [(Var a A, B -&gt; C), (Var b B, C)]
@@

'unfoldApp' is the inverse of 'foldApp'.
-}</span><span>
</span><span id="line-280"></span><span id="local-6989586621679528737"><span class="annot"><a href="IR.IR.html#unfoldApp"><span class="hs-identifier hs-type">unfoldApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528737"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528737"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528737"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679528737"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-281"></span><span id="unfoldApp"><span class="annot"><span class="annottext">unfoldApp :: Expr t -&gt; (Expr t, [(Expr t, t)])
</span><a href="IR.IR.html#unfoldApp"><span class="hs-identifier hs-var hs-var">unfoldApp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621679528074"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528074"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679528073"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528073"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621679528072"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528072"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679528071"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528071"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679528070"><span class="annot"><span class="annottext">[(Expr t, t)]
</span><a href="#local-6989586621679528070"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; (Expr t, [(Expr t, t)])
forall t. Expr t -&gt; (Expr t, [(Expr t, t)])
</span><a href="IR.IR.html#unfoldApp"><span class="hs-identifier hs-var">unfoldApp</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528074"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528071"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Expr t, t)]
</span><a href="#local-6989586621679528070"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[(Expr t, t)] -&gt; [(Expr t, t)] -&gt; [(Expr t, t)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528073"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528072"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span class="annot"><a href="IR.IR.html#unfoldApp"><span class="hs-identifier hs-var">unfoldApp</span></a></span><span> </span><span id="local-6989586621679528069"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528069"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528069"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">{- | Apply a function to zero or more arguments.

'foldApp' is the inverse of 'unfoldApp'.
-}</span><span>
</span><span id="line-289"></span><span id="local-6989586621679528068"><span class="annot"><a href="IR.IR.html#foldApp"><span class="hs-identifier hs-type">foldApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528068"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528068"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679528068"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528068"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-290"></span><span id="foldApp"><span class="annot"><span class="annottext">foldApp :: Expr t -&gt; [(Expr t, t)] -&gt; Expr t
</span><a href="IR.IR.html#foldApp"><span class="hs-identifier hs-var hs-var">foldApp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Expr t, t) -&gt; Expr t -&gt; Expr t)
-&gt; Expr t -&gt; [(Expr t, t)] -&gt; Expr t
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(((Expr t, t) -&gt; Expr t -&gt; Expr t)
 -&gt; Expr t -&gt; [(Expr t, t)] -&gt; Expr t)
-&gt; ((Expr t, t) -&gt; Expr t -&gt; Expr t)
-&gt; Expr t
-&gt; [(Expr t, t)]
-&gt; Expr t
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679528066"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528066"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679528065"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528065"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679528064"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528064"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Expr t -&gt; t -&gt; Expr t
forall t. Expr t -&gt; Expr t -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528064"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528066"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679528065"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-comment">-- | Collect a curried list of function arguments from a nesting of lambdas.</span><span>
</span><span id="line-293"></span><span id="local-6989586621679528729"><span class="annot"><a href="IR.IR.html#unfoldLambda"><span class="hs-identifier hs-type">unfoldLambda</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528729"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Common.Identifiers.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528729"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-294"></span><span id="unfoldLambda"><span class="annot"><span class="annottext">unfoldLambda :: Expr t -&gt; ([Binder], Expr t)
</span><a href="IR.IR.html#unfoldLambda"><span class="hs-identifier hs-var hs-var">unfoldLambda</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span id="local-6989586621679528063"><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679528063"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679528062"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528062"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679528061"><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621679528061"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679528060"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528060"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; ([Binder], Expr t)
forall t. Expr t -&gt; ([Binder], Expr t)
</span><a href="IR.IR.html#unfoldLambda"><span class="hs-identifier hs-var">unfoldLambda</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528062"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679528063"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Binder -&gt; [Binder] -&gt; [Binder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621679528061"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528060"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span class="annot"><a href="IR.IR.html#unfoldLambda"><span class="hs-identifier hs-var">unfoldLambda</span></a></span><span> </span><span id="local-6989586621679528059"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528059"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528059"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-comment">-- | Create a lambda chain given a list of argument-type pairs and a body.</span><span>
</span><span id="line-299"></span><span class="annot"><a href="IR.IR.html#foldLambda"><span class="hs-identifier hs-type">foldLambda</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="IR.Types.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="IR.Types.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-300"></span><span id="foldLambda"><span class="annot"><span class="annottext">foldLambda :: [(Binder, Type)] -&gt; Expr Type -&gt; Expr Type
</span><a href="IR.IR.html#foldLambda"><span class="hs-identifier hs-var hs-var">foldLambda</span></a></span></span><span> </span><span id="local-6989586621679528058"><span class="annot"><span class="annottext">[(Binder, Type)]
</span><a href="#local-6989586621679528058"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679528057"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679528057"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Binder, Type) -&gt; Expr Type -&gt; Expr Type)
-&gt; Expr Type -&gt; [(Binder, Type)] -&gt; Expr Type
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(Binder, Type) -&gt; Expr Type -&gt; Expr Type
</span><a href="#local-6989586621679528056"><span class="hs-identifier hs-var">chain</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679528057"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">[(Binder, Type)]
</span><a href="#local-6989586621679528058"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679528056"><span class="annot"><span class="annottext">chain :: (Binder, Type) -&gt; Expr Type -&gt; Expr Type
</span><a href="#local-6989586621679528056"><span class="hs-identifier hs-var hs-var">chain</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679528055"><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679528055"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679528054"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679528054"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679528053"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679528053"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binder -&gt; Expr Type -&gt; Type -&gt; Expr Type
forall t. Binder -&gt; Expr t -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a></span><span> </span><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679528055"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679528053"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Expr Type) -&gt; Type -&gt; Expr Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679528054"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="IR.Types.Type.html#Arrow"><span class="hs-operator hs-var">`Arrow`</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; Type
forall t. Expr t -&gt; t
</span><a href="IR.IR.html#extract"><span class="hs-identifier hs-var">extract</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679528053"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">-- | Whether an expression is a value.</span><span>
</span><span id="line-304"></span><span id="local-6989586621679528052"><span class="annot"><a href="IR.IR.html#isValue"><span class="hs-identifier hs-type">isValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528052"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-305"></span><span id="isValue"><span class="annot"><span class="annottext">isValue :: Expr t -&gt; Bool
</span><a href="IR.IR.html#isValue"><span class="hs-identifier hs-var hs-var">isValue</span></a></span></span><span> </span><span class="annot"><a href="IR.IR.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-306"></span><span class="annot"><a href="IR.IR.html#isValue"><span class="hs-identifier hs-var">isValue</span></a></span><span> </span><span class="annot"><a href="IR.IR.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-307"></span><span class="annot"><a href="IR.IR.html#isValue"><span class="hs-identifier hs-var">isValue</span></a></span><span> </span><span class="annot"><a href="IR.IR.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-308"></span><span class="annot"><a href="IR.IR.html#isValue"><span class="hs-identifier hs-var">isValue</span></a></span><span> </span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-309"></span><span class="annot"><a href="IR.IR.html#isValue"><span class="hs-identifier hs-var">isValue</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">-- | Retrieve binder from Alt, assuming it is AltBinder.</span><span>
</span><span id="line-312"></span><span class="annot"><a href="IR.IR.html#getAltDefault"><span class="hs-identifier hs-type">getAltDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.IR.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.Identifiers.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span>
</span><span id="line-313"></span><span id="getAltDefault"><span class="annot"><span class="annottext">getAltDefault :: Alt -&gt; Binder
</span><a href="IR.IR.html#getAltDefault"><span class="hs-identifier hs-var hs-var">getAltDefault</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltBinder"><span class="hs-identifier hs-type">AltBinder</span></a></span><span> </span><span id="local-6989586621679528051"><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679528051"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679528051"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-314"></span><span class="annot"><a href="IR.IR.html#getAltDefault"><span class="hs-identifier hs-var">getAltDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Alt
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Binder
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span>
</span><span id="line-315"></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Compiler Error: Should not have recursive patterns here&quot;</span></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span id="local-6989586621679528049"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Common.Identifiers.html#HasFreeVars"><span class="hs-identifier hs-type">HasFreeVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528049"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-318"></span><span>  </span><span id="local-6989586621679528045"><span class="annot"><span class="annottext">freeVars :: Expr t -&gt; Set VarId
</span><a href="Common.Identifiers.html#freeVars"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeVars</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621679528043"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679528043"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Set VarId
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">S.singleton</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679528043"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-319"></span><span>  </span><span class="annot"><a href="Common.Identifiers.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><a href="IR.IR.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set VarId
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span>
</span><span id="line-320"></span><span>  </span><span class="annot"><a href="Common.Identifiers.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><a href="IR.IR.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set VarId
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><a href="Common.Identifiers.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#App"><span class="hs-identifier hs-type">App</span></a></span><span>    </span><span id="local-6989586621679528040"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528040"><span class="hs-identifier hs-var">l</span></a></span></span><span>                  </span><span id="local-6989586621679528039"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528039"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Set VarId
forall t i. HasFreeVars t i =&gt; t -&gt; Set i
</span><a href="Common.Identifiers.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528040"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Set VarId -&gt; Set VarId -&gt; Set VarId
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`S.union`</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Set VarId
forall t i. HasFreeVars t i =&gt; t -&gt; Set i
</span><a href="Common.Identifiers.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528039"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><a href="Common.Identifiers.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Binder -&gt; [VarId]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679528037"><span class="annot"><span class="annottext">[VarId]
</span><a href="#local-6989586621679528037"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679528036"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528036"><span class="hs-identifier hs-var">b</span></a></span></span><span>  </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Set VarId
forall t i. HasFreeVars t i =&gt; t -&gt; Set i
</span><a href="Common.Identifiers.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528036"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Set VarId -&gt; Set VarId -&gt; Set VarId
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="annot"><span class="annottext">[VarId] -&gt; Set VarId
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">[VarId]
</span><a href="#local-6989586621679528037"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-323"></span><span>  </span><span class="annot"><a href="Common.Identifiers.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>   </span><span class="annot"><span class="annottext">Primitive
</span><span class="hs-identifier">_</span></span><span>                  </span><span id="local-6989586621679528034"><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679528034"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Set VarId] -&gt; Set VarId
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><span class="hs-identifier hs-var">S.unions</span></span><span> </span><span class="annot"><span class="annottext">([Set VarId] -&gt; Set VarId) -&gt; [Set VarId] -&gt; Set VarId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Expr t -&gt; Set VarId) -&gt; [Expr t] -&gt; [Set VarId]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Set VarId
forall t i. HasFreeVars t i =&gt; t -&gt; Set i
</span><a href="Common.Identifiers.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679528034"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><a href="Common.Identifiers.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Binder, Expr t)] -&gt; ([Binder], [Expr t])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span id="local-6989586621679528031"><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621679528031"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679528030"><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679528030"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679528029"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528029"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><span class="annottext">[Set VarId] -&gt; Set VarId
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><span class="hs-identifier hs-var">S.unions</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr t -&gt; Set VarId) -&gt; [Expr t] -&gt; [Set VarId]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Set VarId
forall t i. HasFreeVars t i =&gt; t -&gt; Set i
</span><a href="Common.Identifiers.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">([Expr t] -&gt; [Set VarId]) -&gt; [Expr t] -&gt; [Set VarId]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528029"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; [Expr t] -&gt; [Expr t]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679528030"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set VarId -&gt; Set VarId -&gt; Set VarId
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="annot"><span class="annottext">[VarId] -&gt; Set VarId
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Binder] -&gt; [VarId]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621679528031"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><a href="Common.Identifiers.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621679528028"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528028"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679528027"><span class="annot"><span class="annottext">[(Alt, Expr t)]
</span><a href="#local-6989586621679528027"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Set VarId] -&gt; Set VarId
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><span class="hs-identifier hs-var">S.unions</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t -&gt; Set VarId
forall t i. HasFreeVars t i =&gt; t -&gt; Set i
</span><a href="Common.Identifiers.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528028"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Set VarId -&gt; [Set VarId] -&gt; [Set VarId]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">((Alt, Expr t) -&gt; Set VarId) -&gt; [(Alt, Expr t)] -&gt; [Set VarId]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Alt, Expr t) -&gt; Set VarId
forall t. (Alt, Expr t) -&gt; Set VarId
</span><a href="#local-6989586621679528026"><span class="hs-identifier hs-var">freeAltVars</span></a></span><span> </span><span class="annot"><span class="annottext">[(Alt, Expr t)]
</span><a href="#local-6989586621679528027"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-328"></span><span>    </span><span id="local-6989586621679528705"><span class="annot"><a href="#local-6989586621679528026"><span class="hs-identifier hs-type">freeAltVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528705"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span></span><span>
</span><span id="line-329"></span><span>    </span><span id="local-6989586621679528026"><span class="annot"><span class="annottext">freeAltVars :: (Alt, Expr t) -&gt; Set VarId
</span><a href="#local-6989586621679528026"><span class="hs-identifier hs-var hs-var">freeAltVars</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679528025"><span class="annot"><span class="annottext">Alt
</span><a href="#local-6989586621679528025"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679528024"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528024"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Set VarId
forall t i. HasFreeVars t i =&gt; t -&gt; Set i
</span><a href="Common.Identifiers.html#freeVars"><span class="hs-identifier hs-var">freeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528024"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Set VarId -&gt; Set VarId -&gt; Set VarId
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="annot"><span class="annottext">Alt -&gt; Set VarId
</span><a href="#local-6989586621679528023"><span class="hs-identifier hs-var">altBinders</span></a></span><span> </span><span class="annot"><span class="annottext">Alt
</span><a href="#local-6989586621679528025"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-330"></span><span>    </span><span id="local-6989586621679528023"><span class="annot"><span class="annottext">altBinders :: Alt -&gt; Set VarId
</span><a href="#local-6989586621679528023"><span class="hs-identifier hs-var hs-var">altBinders</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltData"><span class="hs-identifier hs-type">AltData</span></a></span><span> </span><span class="annot"><span class="annottext">DConId
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679528022"><span class="annot"><span class="annottext">[Alt]
</span><a href="#local-6989586621679528022"><span class="hs-identifier hs-var">bs</span></a></span></span><span>                 </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Set VarId] -&gt; Set VarId
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><span class="hs-identifier hs-var">S.unions</span></span><span> </span><span class="annot"><span class="annottext">([Set VarId] -&gt; Set VarId) -&gt; [Set VarId] -&gt; Set VarId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Alt -&gt; Set VarId) -&gt; [Alt] -&gt; [Set VarId]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Alt -&gt; Set VarId
</span><a href="#local-6989586621679528023"><span class="hs-identifier hs-var">altBinders</span></a></span><span> </span><span class="annot"><span class="annottext">[Alt]
</span><a href="#local-6989586621679528022"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><a href="#local-6989586621679528023"><span class="hs-identifier hs-var">altBinders</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltLit"><span class="hs-identifier hs-type">AltLit</span></a></span><span>     </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set VarId
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><a href="#local-6989586621679528023"><span class="hs-identifier hs-var">altBinders</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltBinder"><span class="hs-identifier hs-type">AltBinder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Binder -&gt; [VarId]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679528021"><span class="annot"><span class="annottext">[VarId]
</span><a href="#local-6989586621679528021"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[VarId] -&gt; Set VarId
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">[VarId]
</span><a href="#local-6989586621679528021"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="hs-comment">{- | Predicate of whether an expression &quot;looks about right&quot;.

Description left deliberately vague so that we have the flexibility to
strengthen this predicate. For now, we just check that all primitives are
applied to the right number of arguments.

This predicate also provides a template to recursively traverse through all
sub-expressions of an expression.
-}</span><span>
</span><span id="line-343"></span><span id="local-6989586621679528020"><span class="annot"><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-type">wellFormed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528020"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-344"></span><span id="wellFormed"><span class="annot"><span class="annottext">wellFormed :: Expr t -&gt; Bool
</span><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var hs-var">wellFormed</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>  </span><span class="annot"><span class="annottext">VarId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-345"></span><span class="annot"><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><span class="annottext">DConId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-346"></span><span class="annot"><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span>  </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-347"></span><span class="annot"><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span>    </span><span id="local-6989586621679528019"><span class="annot"><span class="annottext">[(Binder, Expr t)]
</span><a href="#local-6989586621679528019"><span class="hs-identifier hs-var">defs</span></a></span></span><span> </span><span id="local-6989586621679528018"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528018"><span class="hs-identifier hs-var">b</span></a></span></span><span>    </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Binder, Expr t) -&gt; Bool) -&gt; [(Binder, Expr t)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t -&gt; Bool
forall a. Expr a -&gt; Bool
</span><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr t -&gt; Bool)
-&gt; ((Binder, Expr t) -&gt; Expr t) -&gt; (Binder, Expr t) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Binder, Expr t) -&gt; Expr t
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Binder, Expr t)]
</span><a href="#local-6989586621679528019"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Bool
forall a. Expr a -&gt; Bool
</span><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528018"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-348"></span><span class="annot"><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span class="annot"><span class="annottext">Binder
</span><span class="hs-identifier">_</span></span><span>    </span><span id="local-6989586621679528014"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528014"><span class="hs-identifier hs-var">b</span></a></span></span><span>    </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Bool
forall a. Expr a -&gt; Bool
</span><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528014"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-349"></span><span class="annot"><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#App"><span class="hs-identifier hs-type">App</span></a></span><span>    </span><span id="local-6989586621679528013"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528013"><span class="hs-identifier hs-var">f</span></a></span></span><span>    </span><span id="local-6989586621679528012"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528012"><span class="hs-identifier hs-var">a</span></a></span></span><span>    </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Bool
forall a. Expr a -&gt; Bool
</span><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528013"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Bool
forall a. Expr a -&gt; Bool
</span><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528012"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-350"></span><span class="annot"><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span>  </span><span id="local-6989586621679528011"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528011"><span class="hs-identifier hs-var">s</span></a></span></span><span>    </span><span id="local-6989586621679528010"><span class="annot"><span class="annottext">[(Alt, Expr t)]
</span><a href="#local-6989586621679528010"><span class="hs-identifier hs-var">alts</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Bool
forall a. Expr a -&gt; Bool
</span><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679528011"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">((Alt, Expr t) -&gt; Bool) -&gt; [(Alt, Expr t)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t -&gt; Bool
forall a. Expr a -&gt; Bool
</span><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr t -&gt; Bool)
-&gt; ((Alt, Expr t) -&gt; Expr t) -&gt; (Alt, Expr t) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Alt, Expr t) -&gt; Expr t
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Alt, Expr t)]
</span><a href="#local-6989586621679528010"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-351"></span><span class="annot"><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>   </span><span id="local-6989586621679528009"><span class="annot"><span class="annottext">Primitive
</span><a href="#local-6989586621679528009"><span class="hs-identifier hs-var">p</span></a></span></span><span>    </span><span id="local-6989586621679528008"><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679528008"><span class="hs-identifier hs-var">es</span></a></span></span><span>   </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Primitive -&gt; [Expr t] -&gt; Bool
forall a. Primitive -&gt; [a] -&gt; Bool
</span><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="#local-6989586621679528009"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679528008"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Expr t -&gt; Bool) -&gt; [Expr t] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Bool
forall a. Expr a -&gt; Bool
</span><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679528008"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-352"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-353"></span><span>  </span><span id="local-6989586621679528007"><span class="annot"><span class="annottext">wfPrim :: Primitive -&gt; [a] -&gt; Bool
</span><a href="#local-6989586621679528007"><span class="hs-identifier hs-var hs-var">wfPrim</span></a></span></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#New"><span class="hs-identifier hs-var">New</span></a></span><span>                  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-354"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Dup"><span class="hs-identifier hs-var">Dup</span></a></span><span>                  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-355"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Drop"><span class="hs-identifier hs-var">Drop</span></a></span><span>                 </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Deref"><span class="hs-identifier hs-var">Deref</span></a></span><span>                </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-357"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Assign"><span class="hs-identifier hs-var">Assign</span></a></span><span>               </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-358"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#After"><span class="hs-identifier hs-var">After</span></a></span><span>                </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-359"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Par"><span class="hs-identifier hs-var">Par</span></a></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-360"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Wait"><span class="hs-identifier hs-var">Wait</span></a></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-361"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Break"><span class="hs-identifier hs-var">Break</span></a></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-362"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Now"><span class="hs-identifier hs-var">Now</span></a></span><span>                  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-363"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#CCall"><span class="hs-identifier hs-type">CCall</span></a></span><span>   </span><span class="annot"><span class="annottext">CSym
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-364"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#FfiCall"><span class="hs-identifier hs-type">FfiCall</span></a></span><span> </span><span class="annot"><span class="annottext">VarId
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-365"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimNeg"><span class="hs-identifier hs-var">PrimNeg</span></a></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-366"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimNot"><span class="hs-identifier hs-var">PrimNot</span></a></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimBitNot"><span class="hs-identifier hs-var">PrimBitNot</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-368"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimAdd"><span class="hs-identifier hs-var">PrimAdd</span></a></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-369"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimSub"><span class="hs-identifier hs-var">PrimSub</span></a></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-370"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimMul"><span class="hs-identifier hs-var">PrimMul</span></a></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-371"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimDiv"><span class="hs-identifier hs-var">PrimDiv</span></a></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimMod"><span class="hs-identifier hs-var">PrimMod</span></a></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-373"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimBitAnd"><span class="hs-identifier hs-var">PrimBitAnd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-374"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimBitOr"><span class="hs-identifier hs-var">PrimBitOr</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-375"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimEq"><span class="hs-identifier hs-var">PrimEq</span></a></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-376"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimGt"><span class="hs-identifier hs-var">PrimGt</span></a></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-377"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimGe"><span class="hs-identifier hs-var">PrimGe</span></a></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-378"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimLt"><span class="hs-identifier hs-var">PrimLt</span></a></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-379"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimLe"><span class="hs-identifier hs-var">PrimLe</span></a></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-380"></span><span>  </span><span class="annot"><a href="#local-6989586621679528007"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-comment">{- | Pretty Typeclass: pretty print the IR

Adds 
* indentation and line breaks
* some parens (not minimal parens, but fewer than around every node)
Omits 
* let _ =
* type annotations
Reverts
* curried funcs of one arg back to multiple arg funcs
-}</span><span>
</span><span id="line-393"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679528004"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="annot"><a href="IR.Types.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-394"></span><span>  </span><span id="local-6989586621679528002"><span class="annot"><span class="annottext">pretty :: Program Type -&gt; Doc ann
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></span></span><span> </span><span class="annot"><a href="IR.IR.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">programDefs :: forall t. Program t -&gt; [(VarId, Expr t)]
</span><a href="IR.IR.html#programDefs"><span class="hs-identifier hs-var">programDefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679528000"><span class="annot"><span class="annottext">[(VarId, Expr Type)]
</span><a href="#local-6989586621679528000"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">typeDefs :: forall t. Program t -&gt; [(TConId, TypeDef)]
</span><a href="IR.IR.html#typeDefs"><span class="hs-identifier hs-var">typeDefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679527999"><span class="annot"><span class="annottext">[(TConId, TypeDef)]
</span><a href="#local-6989586621679527999"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">externDecls :: forall t. Program t -&gt; [(VarId, Type)]
</span><a href="IR.IR.html#externDecls"><span class="hs-identifier hs-var">externDecls</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679527998"><span class="annot"><span class="annottext">[(VarId, Type)]
</span><a href="#local-6989586621679527998"><span class="hs-identifier hs-var">xds</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-395"></span><span>    </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
forall ann. Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
</span><span class="hs-identifier hs-var">punctuate</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann]
forall ann. [Doc ann]
</span><a href="#local-6989586621679527994"><span class="hs-identifier hs-var">tops</span></a></span><span>
</span><span id="line-396"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-397"></span><span>    </span><span id="local-6989586621679527994"><span class="annot"><span class="annottext">tops :: [Doc ann]
</span><a href="#local-6989586621679527994"><span class="hs-identifier hs-var hs-var">tops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-398"></span><span>      </span><span class="annot"><span class="annottext">((TConId, TypeDef) -&gt; Doc ann) -&gt; [(TConId, TypeDef)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(TConId, TypeDef) -&gt; Doc ann
forall ann. (TConId, TypeDef) -&gt; Doc ann
</span><a href="#local-6989586621679527993"><span class="hs-identifier hs-var">prettyTypDef</span></a></span><span> </span><span class="annot"><span class="annottext">[(TConId, TypeDef)]
</span><a href="#local-6989586621679527999"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; [Doc ann] -&gt; [Doc ann]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">((VarId, Type) -&gt; Doc ann) -&gt; [(VarId, Type)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(VarId, Type) -&gt; Doc ann
forall t ann. Pretty t =&gt; (VarId, t) -&gt; Doc ann
</span><a href="#local-6989586621679527992"><span class="hs-identifier hs-var">prettyExternDecl</span></a></span><span> </span><span class="annot"><span class="annottext">[(VarId, Type)]
</span><a href="#local-6989586621679527998"><span class="hs-identifier hs-var">xds</span></a></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; [Doc ann] -&gt; [Doc ann]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">((VarId, Expr Type) -&gt; Doc ann)
-&gt; [(VarId, Expr Type)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(VarId, Expr Type) -&gt; Doc ann
forall ann. (VarId, Expr Type) -&gt; Doc ann
</span><a href="#local-6989586621679527991"><span class="hs-identifier hs-var">prettyFuncDef</span></a></span><span> </span><span class="annot"><span class="annottext">[(VarId, Expr Type)]
</span><a href="#local-6989586621679528000"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-comment">-- Generates readable Doc representation of an IR Top Level Function</span><span>
</span><span id="line-401"></span><span>    </span><span id="local-6989586621679528678"><span class="annot"><a href="#local-6989586621679527991"><span class="hs-identifier hs-type">prettyFuncDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="IR.Types.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679528678"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-402"></span><span>    </span><span id="local-6989586621679527991"><span class="annot"><span class="annottext">prettyFuncDef :: (VarId, Expr Type) -&gt; Doc ann
</span><a href="#local-6989586621679527991"><span class="hs-identifier hs-var hs-var">prettyFuncDef</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679527990"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527990"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527989"><span class="annot"><span class="annottext">l :: Expr Type
</span><a href="#local-6989586621679527989"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span class="annot"><span class="annottext">Binder
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679527988"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527988"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-403"></span><span>      </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527990"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="#local-6989586621679527986"><span class="hs-identifier hs-var">typSig</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">indent</span></span><span>
</span><span id="line-404"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-405"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr Type -&gt; Expr ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527984"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>     </span><span class="hs-keyword">where</span><span>
</span><span id="line-407"></span><span>      </span><span id="local-6989586621679527986"><span class="annot"><span class="annottext">typSig :: Doc ann
</span><a href="#local-6989586621679527986"><span class="hs-identifier hs-var hs-var">typSig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann]
forall ann. [Doc ann]
</span><a href="#local-6989586621679527982"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#rarrow"><span class="hs-identifier hs-var">rarrow</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527980"><span class="hs-identifier hs-var">retTy</span></a></span><span>
</span><span id="line-408"></span><span>      </span><span id="local-6989586621679527982"><span class="annot"><span class="annottext">args :: [Doc ann]
</span><a href="#local-6989586621679527982"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Binder -&gt; Type -&gt; Doc ann) -&gt; [Binder] -&gt; [Type] -&gt; [Doc ann]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span>
</span><span id="line-409"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679527978"><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679527978"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621679527977"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527977"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Binder -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679527978"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527977"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>        </span><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621679527975"><span class="hs-identifier hs-var">argIds</span></a></span><span>
</span><span id="line-411"></span><span>        </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679527974"><span class="hs-identifier hs-var">argTys</span></a></span><span>
</span><span id="line-412"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679527975"><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621679527975"><span class="hs-identifier hs-var">argIds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527984"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527984"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; ([Binder], Expr Type)
forall t. Expr t -&gt; ([Binder], Expr t)
</span><a href="IR.IR.html#unfoldLambda"><span class="hs-identifier hs-var">unfoldLambda</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527989"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-413"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679527974"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679527974"><span class="hs-identifier hs-var">argTys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527980"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527980"><span class="hs-identifier hs-var">retTy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([Type], Type)
</span><a href="IR.Types.Type.html#unfoldArrow"><span class="hs-identifier hs-var">unfoldArrow</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527988"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-comment">-- FIXME</span><span>
</span><span id="line-414"></span><span>    </span><span class="annot"><a href="#local-6989586621679527991"><span class="hs-identifier hs-var">prettyFuncDef</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679527973"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527973"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527972"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527972"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527973"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr Type -&gt; Expr ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527972"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span>    </span><span id="local-6989586621679528679"><span id="local-6989586621679528680"><span class="annot"><a href="#local-6989586621679527992"><span class="hs-identifier hs-type">prettyExternDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621679528680"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679528680"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679528679"><span class="hs-identifier hs-type">ann</span></a></span></span></span><span>
</span><span id="line-417"></span><span>    </span><span id="local-6989586621679527992"><span class="annot"><span class="annottext">prettyExternDecl :: (VarId, t) -&gt; Doc ann
</span><a href="#local-6989586621679527992"><span class="hs-identifier hs-var hs-var">prettyExternDecl</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679527971"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527971"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527970"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679527970"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-418"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;extern&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527971"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">colon</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679527970"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span>    </span><span class="hs-comment">-- Generates readable Doc representation of an IR Type Definition</span><span>
</span><span id="line-421"></span><span>    </span><span id="local-6989586621679528681"><span class="annot"><a href="#local-6989586621679527993"><span class="hs-identifier hs-type">prettyTypDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#TConId"><span class="hs-identifier hs-type">TConId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679528681"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-422"></span><span>    </span><span id="local-6989586621679527993"><span class="annot"><span class="annottext">prettyTypDef :: (TConId, TypeDef) -&gt; Doc ann
</span><a href="#local-6989586621679527993"><span class="hs-identifier hs-var hs-var">prettyTypDef</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679527968"><span class="annot"><span class="annottext">TConId
</span><a href="#local-6989586621679527968"><span class="hs-identifier hs-var">tcon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">variants :: TypeDef -&gt; [(DConId, TypeVariant)]
</span><a href="IR.IR.html#variants"><span class="hs-identifier hs-var">variants</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679527967"><span class="annot"><span class="annottext">[(DConId, TypeVariant)]
</span><a href="#local-6989586621679527967"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-423"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;type&quot;</span></span><span>
</span><span id="line-424"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">TConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">TConId
</span><a href="#local-6989586621679527968"><span class="hs-identifier hs-var">tcon</span></a></span><span>
</span><span id="line-425"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span>
</span><span id="line-426"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Common.Pretty.html#indentNo"><span class="hs-identifier hs-var">indentNo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((DConId, TypeVariant) -&gt; Doc ann)
-&gt; [(DConId, TypeVariant)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(DConId, TypeVariant) -&gt; Doc ann
forall ann. (DConId, TypeVariant) -&gt; Doc ann
</span><a href="#local-6989586621679527965"><span class="hs-identifier hs-var">prettyDCon</span></a></span><span> </span><span class="annot"><span class="annottext">[(DConId, TypeVariant)]
</span><a href="#local-6989586621679527967"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>  </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span>
</span><span id="line-428"></span><span>    </span><span id="local-6989586621679528662"><span class="annot"><a href="#local-6989586621679527965"><span class="hs-identifier hs-type">prettyDCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#DConId"><span class="hs-identifier hs-type">DConId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#TypeVariant"><span class="hs-identifier hs-type">TypeVariant</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679528662"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-429"></span><span>    </span><span id="local-6989586621679527965"><span class="annot"><span class="annottext">prettyDCon :: (DConId, TypeVariant) -&gt; Doc ann
</span><a href="#local-6989586621679527965"><span class="hs-identifier hs-var hs-var">prettyDCon</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679527964"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679527964"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#VariantNamed"><span class="hs-identifier hs-type">VariantNamed</span></a></span><span> </span><span id="local-6989586621679527963"><span class="annot"><span class="annottext">[(VarId, Type)]
</span><a href="#local-6989586621679527963"><span class="hs-identifier hs-var">argz</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-430"></span><span>      </span><span class="annot"><span class="annottext">DConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679527964"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Doc ann)
-&gt; ((VarId, Type) -&gt; Type) -&gt; (VarId, Type) -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VarId, Type) -&gt; Type
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((VarId, Type) -&gt; Doc ann) -&gt; [(VarId, Type)] -&gt; [Doc ann]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(VarId, Type)]
</span><a href="#local-6989586621679527963"><span class="hs-identifier hs-var">argz</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>    </span><span class="annot"><a href="#local-6989586621679527965"><span class="hs-identifier hs-var">prettyDCon</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679527961"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679527961"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#VariantUnnamed"><span class="hs-identifier hs-type">VariantUnnamed</span></a></span><span> </span><span id="local-6989586621679527960"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679527960"><span class="hs-identifier hs-var">argz</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-432"></span><span>      </span><span class="annot"><span class="annottext">DConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679527961"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Doc ann) -&gt; [Type] -&gt; [Doc ann]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679527960"><span class="hs-identifier hs-var">argz</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="hs-comment">-- | Pretty prints IR Expr nodes without type annotations</span><span>
</span><span id="line-436"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679527957"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-437"></span><span>  </span><span id="local-6989586621679527956"><span class="annot"><span class="annottext">pretty :: Expr () -&gt; Doc ann
</span><a href="#local-6989586621679527956"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span id="local-6989586621679527955"><span class="annot"><span class="annottext">a :: Expr ()
</span><a href="#local-6989586621679527955"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="IR.IR.html#App"><span class="hs-identifier hs-type">App</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527954"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall ann. Expr () -&gt; Doc ann
</span><a href="#local-6989586621679527953"><span class="hs-identifier hs-var">parenz</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr () -&gt; Doc ann)
-&gt; ((Expr (), ()) -&gt; Expr ()) -&gt; (Expr (), ()) -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Expr (), ()) -&gt; Expr ()
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Expr (), ()) -&gt; Doc ann) -&gt; [(Expr (), ())] -&gt; [Doc ann]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Expr (), ())]
</span><a href="#local-6989586621679527952"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-439"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679527954"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527954"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527952"><span class="annot"><span class="annottext">[(Expr (), ())]
</span><a href="#local-6989586621679527952"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; (Expr (), [(Expr (), ())])
forall t. Expr t -&gt; (Expr t, [(Expr t, t)])
</span><a href="IR.IR.html#unfoldApp"><span class="hs-identifier hs-var">unfoldApp</span></a></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527955"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-440"></span><span>    </span><span class="hs-comment">-- insert (usually) necessary parens</span><span>
</span><span id="line-441"></span><span>    </span><span id="local-6989586621679527951"><span class="annot"><a href="#local-6989586621679527953"><span class="hs-identifier hs-type">parenz</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679527951"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-442"></span><span>    </span><span id="local-6989586621679527953"><span class="annot"><span class="annottext">parenz :: Expr () -&gt; Doc ann
</span><a href="#local-6989586621679527953"><span class="hs-identifier hs-var hs-var">parenz</span></a></span></span><span> </span><span id="local-6989586621679527950"><span class="annot"><span class="annottext">v :: Expr ()
</span><a href="#local-6989586621679527950"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><span class="annottext">VarId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527950"><span class="hs-identifier hs-var">v</span></a></span><span>  </span><span class="hs-comment">-- variables</span><span>
</span><span id="line-443"></span><span>    </span><span class="annot"><a href="#local-6989586621679527953"><span class="hs-identifier hs-var">parenz</span></a></span><span> </span><span id="local-6989586621679527949"><span class="annot"><span class="annottext">l :: Expr ()
</span><a href="#local-6989586621679527949"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527949"><span class="hs-identifier hs-var">l</span></a></span><span>  </span><span class="hs-comment">-- literals</span><span>
</span><span id="line-444"></span><span>    </span><span class="annot"><a href="#local-6989586621679527953"><span class="hs-identifier hs-var">parenz</span></a></span><span> </span><span id="local-6989586621679527948"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527948"><span class="hs-identifier hs-var">e</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527948"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>    </span><span class="hs-comment">-- TODO: minimum parens algo</span><span>
</span><span id="line-446"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Wait"><span class="hs-identifier hs-var">Wait</span></a></span><span> </span><span id="local-6989586621679527947"><span class="annot"><span class="annottext">[Expr ()]
</span><a href="#local-6989586621679527947"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wait&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr () -&gt; Doc ann) -&gt; [Expr ()] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">[Expr ()]
</span><a href="#local-6989586621679527947"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621679527946"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527946"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527946"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-448"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span id="local-6989586621679527945"><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679527945"><span class="hs-identifier hs-var">a</span></a></span></span><span>              </span><span id="local-6989586621679527944"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527944"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fun&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Binder -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679527945"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527944"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-449"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Binder
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527943"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527943"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679527942"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527942"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527943"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527942"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-450"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span>    </span><span id="local-6989586621679527941"><span class="annot"><span class="annottext">[(Binder, Expr ())]
</span><a href="#local-6989586621679527941"><span class="hs-keyword hs-var">as</span></a></span></span><span>             </span><span id="local-6989586621679527940"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527940"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="#local-6989586621679527939"><span class="hs-identifier hs-var">letexpr</span></a></span><span>
</span><span id="line-451"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-452"></span><span>    </span><span id="local-6989586621679527939"><span class="annot"><span class="annottext">letexpr :: Doc ann
</span><a href="#local-6989586621679527939"><span class="hs-identifier hs-var hs-var">letexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;let&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Binder, Expr ()) -&gt; Doc ann) -&gt; [(Binder, Expr ())] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Binder, Expr ()) -&gt; Doc ann
forall a a ann. (Pretty a, Pretty a) =&gt; (Maybe a, a) -&gt; Doc ann
</span><a href="#local-6989586621679527938"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">[(Binder, Expr ())]
</span><a href="#local-6989586621679527941"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527940"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-453"></span><span>    </span><span id="local-6989586621679527938"><span class="annot"><span class="annottext">def :: (Maybe a, a) -&gt; Doc ann
</span><a href="#local-6989586621679527938"><span class="hs-identifier hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679527937"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679527937"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527936"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679527936"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679527937"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">equals</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">align</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679527936"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>    </span><span class="annot"><a href="#local-6989586621679527938"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527933"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679527933"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">equals</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">align</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679527933"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#After"><span class="hs-identifier hs-var">After</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679527932"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527932"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527931"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527931"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527930"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527930"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="#local-6989586621679527929"><span class="hs-identifier hs-var">ae</span></a></span><span>
</span><span id="line-456"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-457"></span><span>    </span><span id="local-6989586621679527929"><span class="annot"><span class="annottext">ae :: Doc ann
</span><a href="#local-6989586621679527929"><span class="hs-identifier hs-var hs-var">ae</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-458"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;after&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527932"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">comma</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527931"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#larrow"><span class="hs-identifier hs-var">larrow</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527930"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-459"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>  </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Assign"><span class="hs-identifier hs-var">Assign</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679527926"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527926"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527925"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527925"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527926"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#larrow"><span class="hs-identifier hs-var">larrow</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527925"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-460"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621679527924"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527924"><span class="hs-identifier hs-var">s</span></a></span></span><span>      </span><span id="local-6989586621679527923"><span class="annot"><span class="annottext">[(Alt, Expr ())]
</span><a href="#local-6989586621679527923"><span class="hs-keyword hs-var">as</span></a></span></span><span>     </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;match&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527924"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="#local-6989586621679527922"><span class="hs-identifier hs-var">arms</span></a></span><span>
</span><span id="line-461"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-462"></span><span>    </span><span id="local-6989586621679527922"><span class="annot"><span class="annottext">arms :: Doc ann
</span><a href="#local-6989586621679527922"><span class="hs-identifier hs-var hs-var">arms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Alt, Expr ()) -&gt; Doc ann) -&gt; [(Alt, Expr ())] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Common.Pretty.html#indentNo"><span class="hs-identifier hs-var">indentNo</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann)
-&gt; ((Alt, Expr ()) -&gt; Doc ann) -&gt; (Alt, Expr ()) -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Alt, Expr ()) -&gt; Doc ann
forall ann. (Alt, Expr ()) -&gt; Doc ann
</span><a href="#local-6989586621679527921"><span class="hs-identifier hs-var">arm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Alt, Expr ())]
</span><a href="#local-6989586621679527923"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>    </span><span id="local-6989586621679528646"><span class="annot"><a href="#local-6989586621679527921"><span class="hs-identifier hs-type">arm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679528646"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-464"></span><span>    </span><span id="local-6989586621679527921"><span class="annot"><span class="annottext">arm :: (Alt, Expr ()) -&gt; Doc ann
</span><a href="#local-6989586621679527921"><span class="hs-identifier hs-var hs-var">arm</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679527920"><span class="annot"><span class="annottext">Alt
</span><a href="#local-6989586621679527920"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527919"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527919"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Alt -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Alt
</span><a href="#local-6989586621679527920"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">equals</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">align</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527919"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Loop"><span class="hs-identifier hs-var">Loop</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679527918"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527918"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-466"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;loop&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Common.Pretty.html#indentNo"><span class="hs-identifier hs-var">indentNo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527918"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span id="local-6989586621679527917"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621679527917"><span class="hs-identifier hs-var">po</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679527916"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527916"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527915"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527915"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527916"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621679527917"><span class="hs-identifier hs-var">po</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527915"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-468"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span id="local-6989586621679527914"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679527914"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679527914"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-469"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span>  </span><span id="local-6989586621679527913"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679527913"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679527913"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-470"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#New"><span class="hs-identifier hs-var">New</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679527912"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527912"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;new&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527912"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-471"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Dup"><span class="hs-identifier hs-var">Dup</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679527911"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527911"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;__dup&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527911"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Drop"><span class="hs-identifier hs-var">Drop</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679527910"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527910"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527909"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527909"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-473"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;__drop&quot;</span></span><span>
</span><span id="line-474"></span><span>      </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527910"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>      </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527909"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-476"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Deref"><span class="hs-identifier hs-var">Deref</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679527908"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527908"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;deref&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679527908"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Par"><span class="hs-identifier hs-var">Par</span></a></span><span>   </span><span id="local-6989586621679527907"><span class="annot"><span class="annottext">[Expr ()]
</span><a href="#local-6989586621679527907"><span class="hs-identifier hs-var">es</span></a></span></span><span>  </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;par&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; Doc ann
forall ann. Doc ann -&gt; [Doc ann] -&gt; Doc ann
</span><a href="Common.Pretty.html#block"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#dbar"><span class="hs-identifier hs-var">dbar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr () -&gt; Doc ann) -&gt; [Expr ()] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">[Expr ()]
</span><a href="#local-6989586621679527907"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Break"><span class="hs-identifier hs-var">Break</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;break&quot;</span></span><span>
</span><span id="line-479"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#CCall"><span class="hs-identifier hs-type">CCall</span></a></span><span> </span><span id="local-6989586621679527904"><span class="annot"><span class="annottext">CSym
</span><a href="#local-6989586621679527904"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679527903"><span class="annot"><span class="annottext">[Expr ()]
</span><a href="#local-6989586621679527903"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-480"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">CSym -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">CSym
</span><a href="#local-6989586621679527904"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
forall ann. Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
</span><span class="hs-identifier hs-var">punctuate</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">comma</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; [Doc ann]) -&gt; [Doc ann] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Expr () -&gt; Doc ann) -&gt; [Expr ()] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">[Expr ()]
</span><a href="#local-6989586621679527903"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#FfiCall"><span class="hs-identifier hs-type">FfiCall</span></a></span><span> </span><span id="local-6989586621679527902"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527902"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679527901"><span class="annot"><span class="annottext">[Expr ()]
</span><a href="#local-6989586621679527901"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527902"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr () -&gt; Doc ann) -&gt; [Expr ()] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; (Expr () -&gt; Doc ann) -&gt; Expr () -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Expr ()]
</span><a href="#local-6989586621679527901"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#CQuote"><span class="hs-identifier hs-type">CQuote</span></a></span><span> </span><span id="local-6989586621679527900"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679527900"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$$&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679527900"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$$&quot;</span></span><span>
</span><span id="line-483"></span><span>
</span><span id="line-484"></span><span>  </span><span class="hs-comment">-- pretty (Prim Return [e] _        ) = pretty &quot;return&quot; &lt;+&gt; braces (pretty e)</span><span>
</span><span id="line-485"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span id="local-6989586621679527899"><span class="annot"><span class="annottext">Primitive
</span><a href="#local-6989586621679527899"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Expr ()]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Doc ann
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Primitive expression not well-formed: &quot;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc ann) -&gt; String -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Primitive -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="#local-6989586621679527899"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679527895"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="IR.IR.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-488"></span><span>  </span><span id="local-6989586621679527894"><span class="annot"><span class="annottext">pretty :: Alt -&gt; Doc ann
</span><a href="#local-6989586621679527894"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltData"><span class="hs-identifier hs-type">AltData</span></a></span><span> </span><span id="local-6989586621679527893"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679527893"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679527892"><span class="annot"><span class="annottext">[Alt]
</span><a href="#local-6989586621679527892"><span class="hs-identifier hs-var">b</span></a></span></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679527893"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Alt -&gt; Doc ann) -&gt; [Alt] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Alt -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">[Alt]
</span><a href="#local-6989586621679527892"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltLit"><span class="hs-identifier hs-type">AltLit</span></a></span><span>     </span><span id="local-6989586621679527891"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679527891"><span class="hs-identifier hs-var">a</span></a></span></span><span>       </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679527891"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-490"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltBinder"><span class="hs-identifier hs-type">AltBinder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679527890"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527890"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527890"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-491"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltBinder"><span class="hs-identifier hs-type">AltBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Binder
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679527887"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="IR.IR.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-494"></span><span>  </span><span id="local-6989586621679527886"><span class="annot"><span class="annottext">pretty :: Literal -&gt; Doc ann
</span><a href="#local-6989586621679527886"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#LitIntegral"><span class="hs-identifier hs-type">LitIntegral</span></a></span><span> </span><span id="local-6989586621679527885"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679527885"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc ann) -&gt; String -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679527885"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-495"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="IR.IR.html#LitEvent"><span class="hs-identifier hs-var">LitEvent</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;()&quot;</span></span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679527882"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-498"></span><span>  </span><span id="local-6989586621679527881"><span class="annot"><span class="annottext">pretty :: PrimOp -&gt; Doc ann
</span><a href="#local-6989586621679527881"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimNeg"><span class="hs-identifier hs-var">PrimNeg</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span>
</span><span id="line-499"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimNot"><span class="hs-identifier hs-var">PrimNot</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!&quot;</span></span><span>
</span><span id="line-500"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimBitNot"><span class="hs-identifier hs-var">PrimBitNot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;~&quot;</span></span><span>
</span><span id="line-501"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimAdd"><span class="hs-identifier hs-var">PrimAdd</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+&quot;</span></span><span>
</span><span id="line-502"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimSub"><span class="hs-identifier hs-var">PrimSub</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span>
</span><span id="line-503"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimMul"><span class="hs-identifier hs-var">PrimMul</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*&quot;</span></span><span>
</span><span id="line-504"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimDiv"><span class="hs-identifier hs-var">PrimDiv</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span>
</span><span id="line-505"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimMod"><span class="hs-identifier hs-var">PrimMod</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%&quot;</span></span><span>
</span><span id="line-506"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimBitAnd"><span class="hs-identifier hs-var">PrimBitAnd</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&amp;&quot;</span></span><span>
</span><span id="line-507"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimBitOr"><span class="hs-identifier hs-var">PrimBitOr</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;|&quot;</span></span><span>
</span><span id="line-508"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimEq"><span class="hs-identifier hs-var">PrimEq</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;==&quot;</span></span><span>
</span><span id="line-509"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimNeq"><span class="hs-identifier hs-var">PrimNeq</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!=&quot;</span></span><span>
</span><span id="line-510"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimGt"><span class="hs-identifier hs-var">PrimGt</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span>
</span><span id="line-511"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimGe"><span class="hs-identifier hs-var">PrimGe</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;=&quot;</span></span><span>
</span><span id="line-512"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimLt"><span class="hs-identifier hs-var">PrimLt</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;&quot;</span></span><span>
</span><span id="line-513"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimLe"><span class="hs-identifier hs-var">PrimLe</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;=&quot;</span></span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span class="hs-comment">-- | Dumpy Typeclass: generate comprehensive Doc representation of the IR</span><span>
</span><span id="line-516"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="annot"><a href="IR.Types.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-517"></span><span>  </span><span id="local-6989586621679527878"><span class="annot"><span class="annottext">dumpy :: Program Type -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var hs-var hs-var hs-var">dumpy</span></a></span></span><span> </span><span class="annot"><a href="IR.IR.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">programDefs :: forall t. Program t -&gt; [(VarId, Expr t)]
</span><a href="IR.IR.html#programDefs"><span class="hs-identifier hs-var">programDefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679527876"><span class="annot"><span class="annottext">[(VarId, Expr Type)]
</span><a href="#local-6989586621679527876"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">typeDefs :: forall t. Program t -&gt; [(TConId, TypeDef)]
</span><a href="IR.IR.html#typeDefs"><span class="hs-identifier hs-var">typeDefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679527875"><span class="annot"><span class="annottext">[(TConId, TypeDef)]
</span><a href="#local-6989586621679527875"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">externDecls :: forall t. Program t -&gt; [(VarId, Type)]
</span><a href="IR.IR.html#externDecls"><span class="hs-identifier hs-var">externDecls</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679527874"><span class="annot"><span class="annottext">[(VarId, Type)]
</span><a href="#local-6989586621679527874"><span class="hs-identifier hs-var">xds</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-518"></span><span>    </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
forall ann. Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
</span><span class="hs-identifier hs-var">punctuate</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann]
forall ann. [Doc ann]
</span><a href="#local-6989586621679527873"><span class="hs-identifier hs-var">tops</span></a></span><span>
</span><span id="line-519"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-520"></span><span>    </span><span id="local-6989586621679527873"><span class="annot"><span class="annottext">tops :: [Doc ann]
</span><a href="#local-6989586621679527873"><span class="hs-identifier hs-var hs-var">tops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-521"></span><span>      </span><span class="annot"><span class="annottext">((TConId, TypeDef) -&gt; Doc ann) -&gt; [(TConId, TypeDef)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(TConId, TypeDef) -&gt; Doc ann
forall ann. (TConId, TypeDef) -&gt; Doc ann
</span><a href="#local-6989586621679527872"><span class="hs-identifier hs-var">dumpyTypDef</span></a></span><span> </span><span class="annot"><span class="annottext">[(TConId, TypeDef)]
</span><a href="#local-6989586621679527875"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; [Doc ann] -&gt; [Doc ann]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">((VarId, Type) -&gt; Doc ann) -&gt; [(VarId, Type)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(VarId, Type) -&gt; Doc ann
forall t ann. Dumpy t =&gt; (VarId, t) -&gt; Doc ann
</span><a href="#local-6989586621679527871"><span class="hs-identifier hs-var">dumpyExternDecl</span></a></span><span> </span><span class="annot"><span class="annottext">[(VarId, Type)]
</span><a href="#local-6989586621679527874"><span class="hs-identifier hs-var">xds</span></a></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; [Doc ann] -&gt; [Doc ann]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">((VarId, Expr Type) -&gt; Doc ann)
-&gt; [(VarId, Expr Type)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(VarId, Expr Type) -&gt; Doc ann
forall ann. (VarId, Expr Type) -&gt; Doc ann
</span><a href="#local-6989586621679527870"><span class="hs-identifier hs-var">dumpyFuncDef</span></a></span><span> </span><span class="annot"><span class="annottext">[(VarId, Expr Type)]
</span><a href="#local-6989586621679527876"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span>    </span><span class="hs-comment">-- Generates readable Doc representation of an IR Top Level Function</span><span>
</span><span id="line-524"></span><span>    </span><span id="local-6989586621679527869"><span class="annot"><a href="#local-6989586621679527870"><span class="hs-identifier hs-type">dumpyFuncDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="IR.Types.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679527869"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-525"></span><span>    </span><span id="local-6989586621679527870"><span class="annot"><span class="annottext">dumpyFuncDef :: (VarId, Expr Type) -&gt; Doc ann
</span><a href="#local-6989586621679527870"><span class="hs-identifier hs-var hs-var">dumpyFuncDef</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679527868"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527868"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527867"><span class="annot"><span class="annottext">l :: Expr Type
</span><a href="#local-6989586621679527867"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span class="annot"><span class="annottext">Binder
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679527866"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527866"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-526"></span><span>      </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527868"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="#local-6989586621679527865"><span class="hs-identifier hs-var">typSig</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527864"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>     </span><span class="hs-keyword">where</span><span>
</span><span id="line-528"></span><span>      </span><span id="local-6989586621679527865"><span class="annot"><span class="annottext">typSig :: Doc ann
</span><a href="#local-6989586621679527865"><span class="hs-identifier hs-var hs-var">typSig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann]
forall ann. [Doc ann]
</span><a href="#local-6989586621679527863"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#rarrow"><span class="hs-identifier hs-var">rarrow</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527862"><span class="hs-identifier hs-var">retTy</span></a></span><span>
</span><span id="line-529"></span><span>      </span><span id="local-6989586621679527863"><span class="annot"><span class="annottext">args :: [Doc ann]
</span><a href="#local-6989586621679527863"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Binder -&gt; Type -&gt; Doc ann) -&gt; [Binder] -&gt; [Type] -&gt; [Doc ann]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span>
</span><span id="line-530"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679527861"><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679527861"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621679527860"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527860"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Binder -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679527861"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527860"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>        </span><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621679527859"><span class="hs-identifier hs-var">argIds</span></a></span><span>
</span><span id="line-532"></span><span>        </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679527858"><span class="hs-identifier hs-var">argTys</span></a></span><span>
</span><span id="line-533"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679527859"><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621679527859"><span class="hs-identifier hs-var">argIds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527864"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527864"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; ([Binder], Expr Type)
forall t. Expr t -&gt; ([Binder], Expr t)
</span><a href="IR.IR.html#unfoldLambda"><span class="hs-identifier hs-var">unfoldLambda</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527867"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-534"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679527858"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679527858"><span class="hs-identifier hs-var">argTys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527862"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527862"><span class="hs-identifier hs-var">retTy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; ([Type], Type)
</span><a href="IR.Types.Type.html#unfoldArrow"><span class="hs-identifier hs-var">unfoldArrow</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527866"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-535"></span><span>    </span><span class="annot"><a href="#local-6989586621679527870"><span class="hs-identifier hs-var">dumpyFuncDef</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679527857"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527857"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527856"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527856"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527857"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527856"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span>    </span><span class="hs-comment">-- Generates readable Doc representation of an IR Type Definition</span><span>
</span><span id="line-538"></span><span>    </span><span id="local-6989586621679528631"><span id="local-6989586621679528632"><span class="annot"><a href="#local-6989586621679527871"><span class="hs-identifier hs-type">dumpyExternDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679528632"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679528632"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679528631"><span class="hs-identifier hs-type">ann</span></a></span></span></span><span>
</span><span id="line-539"></span><span>    </span><span id="local-6989586621679527871"><span class="annot"><span class="annottext">dumpyExternDecl :: (VarId, t) -&gt; Doc ann
</span><a href="#local-6989586621679527871"><span class="hs-identifier hs-var hs-var">dumpyExternDecl</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679527855"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527855"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527854"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679527854"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;extern&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527855"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">colon</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679527854"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-comment">-- Generates readable Doc representation of an IR Type Definition</span><span>
</span><span id="line-542"></span><span>    </span><span id="local-6989586621679527853"><span class="annot"><a href="#local-6989586621679527872"><span class="hs-identifier hs-type">dumpyTypDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#TConId"><span class="hs-identifier hs-type">TConId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679527853"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-543"></span><span>    </span><span id="local-6989586621679527872"><span class="annot"><span class="annottext">dumpyTypDef :: (TConId, TypeDef) -&gt; Doc ann
</span><a href="#local-6989586621679527872"><span class="hs-identifier hs-var hs-var">dumpyTypDef</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679527852"><span class="annot"><span class="annottext">TConId
</span><a href="#local-6989586621679527852"><span class="hs-identifier hs-var">tcon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">variants :: TypeDef -&gt; [(DConId, TypeVariant)]
</span><a href="IR.IR.html#variants"><span class="hs-identifier hs-var">variants</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679527851"><span class="annot"><span class="annottext">[(DConId, TypeVariant)]
</span><a href="#local-6989586621679527851"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-544"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;type&quot;</span></span><span>
</span><span id="line-545"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">TConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">TConId
</span><a href="#local-6989586621679527852"><span class="hs-identifier hs-var">tcon</span></a></span><span>
</span><span id="line-546"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span>
</span><span id="line-547"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Common.Pretty.html#indentNo"><span class="hs-identifier hs-var">indentNo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((DConId, TypeVariant) -&gt; Doc ann)
-&gt; [(DConId, TypeVariant)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(DConId, TypeVariant) -&gt; Doc ann
forall ann. (DConId, TypeVariant) -&gt; Doc ann
</span><a href="#local-6989586621679527850"><span class="hs-identifier hs-var">dumpyDCon</span></a></span><span> </span><span class="annot"><span class="annottext">[(DConId, TypeVariant)]
</span><a href="#local-6989586621679527851"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>  </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span>
</span><span id="line-549"></span><span>    </span><span id="local-6989586621679527849"><span class="annot"><a href="#local-6989586621679527850"><span class="hs-identifier hs-type">dumpyDCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#DConId"><span class="hs-identifier hs-type">DConId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#TypeVariant"><span class="hs-identifier hs-type">TypeVariant</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679527849"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-550"></span><span>    </span><span id="local-6989586621679527850"><span class="annot"><span class="annottext">dumpyDCon :: (DConId, TypeVariant) -&gt; Doc ann
</span><a href="#local-6989586621679527850"><span class="hs-identifier hs-var hs-var">dumpyDCon</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679527848"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679527848"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#VariantNamed"><span class="hs-identifier hs-type">VariantNamed</span></a></span><span> </span><span id="local-6989586621679527847"><span class="annot"><span class="annottext">[(VarId, Type)]
</span><a href="#local-6989586621679527847"><span class="hs-identifier hs-var">argz</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-551"></span><span>      </span><span class="annot"><span class="annottext">DConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679527848"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Doc ann)
-&gt; ((VarId, Type) -&gt; Type) -&gt; (VarId, Type) -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VarId, Type) -&gt; Type
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((VarId, Type) -&gt; Doc ann) -&gt; [(VarId, Type)] -&gt; [Doc ann]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(VarId, Type)]
</span><a href="#local-6989586621679527847"><span class="hs-identifier hs-var">argz</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span>    </span><span class="annot"><a href="#local-6989586621679527850"><span class="hs-identifier hs-var">dumpyDCon</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679527846"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679527846"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#VariantUnnamed"><span class="hs-identifier hs-type">VariantUnnamed</span></a></span><span> </span><span id="local-6989586621679527845"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679527845"><span class="hs-identifier hs-var">argz</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-553"></span><span>      </span><span class="annot"><span class="annottext">DConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679527846"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Doc ann) -&gt; [Type] -&gt; [Doc ann]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679527845"><span class="hs-identifier hs-var">argz</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>  </span><span class="hs-comment">-- TODO: how to represent entry point?</span><span>
</span><span id="line-555"></span><span>
</span><span id="line-556"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="IR.Types.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-557"></span><span>  </span><span id="local-6989586621679527843"><span class="annot"><span class="annottext">dumpy :: Expr Type -&gt; Doc ann
</span><a href="#local-6989586621679527843"><span class="hs-identifier hs-var hs-var hs-var hs-var">dumpy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>  </span><span id="local-6989586621679527842"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527842"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679527841"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527841"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527841"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527842"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-558"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span id="local-6989586621679527839"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679527839"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679527838"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527838"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527838"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679527839"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-559"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span>  </span><span id="local-6989586621679527837"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679527837"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679527836"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527836"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527836"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679527837"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-560"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621679527835"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527835"><span class="hs-identifier hs-var">l</span></a></span></span><span>  </span><span id="local-6989586621679527834"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527834"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679527833"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527833"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527833"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527835"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527834"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-561"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679527832"><span class="annot"><span class="annottext">[(Binder, Expr Type)]
</span><a href="#local-6989586621679527832"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679527831"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527831"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679527830"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527830"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527830"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="#local-6989586621679527829"><span class="hs-identifier hs-var">letexpr</span></a></span><span>
</span><span id="line-562"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-563"></span><span>    </span><span id="local-6989586621679527829"><span class="annot"><span class="annottext">letexpr :: Doc ann
</span><a href="#local-6989586621679527829"><span class="hs-identifier hs-var hs-var">letexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;let&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; Doc ann
forall ann. Doc ann -&gt; [Doc ann] -&gt; Doc ann
</span><a href="Common.Pretty.html#block"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#dbar"><span class="hs-identifier hs-var">dbar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Binder, Expr Type) -&gt; Doc ann)
-&gt; [(Binder, Expr Type)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Binder, Expr Type) -&gt; Doc ann
forall a a ann. (Pretty a, Dumpy a) =&gt; (Maybe a, a) -&gt; Doc ann
</span><a href="#local-6989586621679527828"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">[(Binder, Expr Type)]
</span><a href="#local-6989586621679527832"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">semi</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527831"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-564"></span><span>    </span><span id="local-6989586621679527828"><span class="annot"><span class="annottext">def :: (Maybe a, a) -&gt; Doc ann
</span><a href="#local-6989586621679527828"><span class="hs-identifier hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679527826"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679527826"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527825"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679527825"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679527826"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">equals</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">braces</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679527825"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-565"></span><span>    </span><span class="annot"><a href="#local-6989586621679527828"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527823"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679527823"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">equals</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">braces</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679527823"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span id="local-6989586621679527822"><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679527822"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679527821"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527821"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679527820"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527820"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-567"></span><span>    </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527820"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fun&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Binder -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679527822"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">braces</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527821"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-568"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621679527819"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527819"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679527818"><span class="annot"><span class="annottext">[(Alt, Expr Type)]
</span><a href="#local-6989586621679527818"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679527817"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527817"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527817"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;match&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527819"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="#local-6989586621679527816"><span class="hs-identifier hs-var">arms</span></a></span><span>
</span><span id="line-569"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-570"></span><span>    </span><span class="hs-comment">-- Where to add binder?</span><span>
</span><span id="line-571"></span><span>    </span><span id="local-6989586621679527816"><span class="annot"><span class="annottext">arms :: Doc ann
</span><a href="#local-6989586621679527816"><span class="hs-identifier hs-var hs-var">arms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; Doc ann
forall ann. Doc ann -&gt; [Doc ann] -&gt; Doc ann
</span><a href="Common.Pretty.html#block"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#bar"><span class="hs-identifier hs-var">bar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Alt, Expr Type) -&gt; Doc ann) -&gt; [(Alt, Expr Type)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Alt, Expr Type) -&gt; Doc ann
forall a a ann. (Dumpy a, Dumpy a) =&gt; (a, a) -&gt; Doc ann
</span><a href="#local-6989586621679527814"><span class="hs-identifier hs-var">arm</span></a></span><span> </span><span class="annot"><span class="annottext">[(Alt, Expr Type)]
</span><a href="#local-6989586621679527818"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>    </span><span id="local-6989586621679527814"><span class="annot"><span class="annottext">arm :: (a, a) -&gt; Doc ann
</span><a href="#local-6989586621679527814"><span class="hs-identifier hs-var hs-var">arm</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679527813"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679527813"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527812"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679527812"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679527813"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">braces</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679527812"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#New"><span class="hs-identifier hs-var">New</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679527811"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527811"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679527810"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527810"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527810"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;new&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527811"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-574"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Dup"><span class="hs-identifier hs-var">Dup</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679527809"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527809"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679527808"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527808"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527808"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;__dup&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527809"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-575"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Drop"><span class="hs-identifier hs-var">Drop</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679527807"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527807"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527806"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527806"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679527805"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527805"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-576"></span><span>    </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527805"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;__drop&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527807"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527806"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Deref"><span class="hs-identifier hs-var">Deref</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679527804"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527804"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679527803"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527803"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527803"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;deref&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527804"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-578"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Assign"><span class="hs-identifier hs-var">Assign</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679527802"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527802"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527801"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527801"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679527800"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527800"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-579"></span><span>    </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527800"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527802"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#larrow"><span class="hs-identifier hs-var">larrow</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">braces</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527801"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-580"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#After"><span class="hs-identifier hs-var">After</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679527799"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527799"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527798"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527798"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527797"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527797"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679527796"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527796"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527796"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="#local-6989586621679527795"><span class="hs-identifier hs-var">ae</span></a></span><span>
</span><span id="line-581"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-582"></span><span>    </span><span id="local-6989586621679527795"><span class="annot"><span class="annottext">ae :: Doc ann
</span><a href="#local-6989586621679527795"><span class="hs-identifier hs-var hs-var">ae</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;after&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527799"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">comma</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527798"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#larrow"><span class="hs-identifier hs-var">larrow</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">braces</span></span><span>
</span><span id="line-583"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527797"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-584"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Par"><span class="hs-identifier hs-var">Par</span></a></span><span> </span><span id="local-6989586621679527794"><span class="annot"><span class="annottext">[Expr Type]
</span><a href="#local-6989586621679527794"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679527793"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527793"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-585"></span><span>    </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527793"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;par&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; Doc ann
forall ann. Doc ann -&gt; [Doc ann] -&gt; Doc ann
</span><a href="Common.Pretty.html#block"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#dbar"><span class="hs-identifier hs-var">dbar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr Type -&gt; Doc ann) -&gt; [Expr Type] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr Type]
</span><a href="#local-6989586621679527794"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Wait"><span class="hs-identifier hs-var">Wait</span></a></span><span> </span><span id="local-6989586621679527792"><span class="annot"><span class="annottext">[Expr Type]
</span><a href="#local-6989586621679527792"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679527791"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527791"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-587"></span><span>    </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527791"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wait&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; Doc ann
forall ann. Doc ann -&gt; [Doc ann] -&gt; Doc ann
</span><a href="Common.Pretty.html#block"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#dbar"><span class="hs-identifier hs-var">dbar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr Type -&gt; Doc ann) -&gt; [Expr Type] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr Type]
</span><a href="#local-6989586621679527792"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Loop"><span class="hs-identifier hs-var">Loop</span></a></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621679527790"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527790"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679527789"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527789"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527789"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;loop&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">braces</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527790"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Break"><span class="hs-identifier hs-var">Break</span></a></span><span>     </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span id="local-6989586621679527788"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527788"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527788"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;break&quot;</span></span><span>
</span><span id="line-590"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#CCall"><span class="hs-identifier hs-type">CCall</span></a></span><span> </span><span id="local-6989586621679527787"><span class="annot"><span class="annottext">CSym
</span><a href="#local-6989586621679527787"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679527786"><span class="annot"><span class="annottext">[Expr Type]
</span><a href="#local-6989586621679527786"><span class="hs-identifier hs-var">es</span></a></span></span><span>  </span><span id="local-6989586621679527785"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527785"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527785"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">CSym -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">CSym
</span><a href="#local-6989586621679527787"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span>
</span><span id="line-591"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
forall ann. Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
</span><span class="hs-identifier hs-var">punctuate</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">comma</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; [Doc ann]) -&gt; [Doc ann] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Expr Type -&gt; Doc ann) -&gt; [Expr Type] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr Type]
</span><a href="#local-6989586621679527786"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#CQuote"><span class="hs-identifier hs-type">CQuote</span></a></span><span> </span><span id="local-6989586621679527784"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679527784"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679527783"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527783"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-593"></span><span>    </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527783"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$$&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679527784"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$$&quot;</span></span><span>
</span><span id="line-594"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#FfiCall"><span class="hs-identifier hs-type">FfiCall</span></a></span><span> </span><span id="local-6989586621679527782"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527782"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679527781"><span class="annot"><span class="annottext">[Expr Type]
</span><a href="#local-6989586621679527781"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527782"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr Type -&gt; Doc ann) -&gt; [Expr Type] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann)
-&gt; (Expr Type -&gt; Doc ann) -&gt; Expr Type -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Expr Type]
</span><a href="#local-6989586621679527781"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span id="local-6989586621679527780"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621679527780"><span class="hs-identifier hs-var">po</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679527779"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527779"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679527778"><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527778"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679527777"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527777"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-596"></span><span>    </span><span class="annot"><span class="annottext">Type -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679527777"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527779"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621679527780"><span class="hs-identifier hs-var">po</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr Type -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Type
</span><a href="#local-6989586621679527778"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-597"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span id="local-6989586621679527776"><span class="annot"><span class="annottext">Primitive
</span><a href="#local-6989586621679527776"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Expr Type]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Doc ann
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Primitive expression not well-formed: &quot;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc ann) -&gt; String -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Primitive -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="#local-6989586621679527776"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="annot"><a href="IR.IR.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-600"></span><span>  </span><span id="local-6989586621679527774"><span class="annot"><span class="annottext">dumpy :: Alt -&gt; Doc ann
</span><a href="#local-6989586621679527774"><span class="hs-identifier hs-var hs-var hs-var hs-var">dumpy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltData"><span class="hs-identifier hs-type">AltData</span></a></span><span> </span><span id="local-6989586621679527773"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679527773"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679527772"><span class="annot"><span class="annottext">[Alt]
</span><a href="#local-6989586621679527772"><span class="hs-identifier hs-var">b</span></a></span></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679527773"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Alt -&gt; Doc ann) -&gt; [Alt] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Alt -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">[Alt]
</span><a href="#local-6989586621679527772"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-601"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltLit"><span class="hs-identifier hs-type">AltLit</span></a></span><span>     </span><span id="local-6989586621679527771"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679527771"><span class="hs-identifier hs-var">a</span></a></span></span><span>       </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679527771"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-602"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltBinder"><span class="hs-identifier hs-type">AltBinder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679527770"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527770"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679527770"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-603"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltBinder"><span class="hs-identifier hs-type">AltBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Binder
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span>
</span><span id="line-604"></span><span>
</span><span id="line-605"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="annot"><a href="IR.IR.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-606"></span><span>  </span><span id="local-6989586621679527768"><span class="annot"><span class="annottext">dumpy :: Literal -&gt; Doc ann
</span><a href="#local-6989586621679527768"><span class="hs-identifier hs-var hs-var hs-var hs-var">dumpy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#LitIntegral"><span class="hs-identifier hs-type">LitIntegral</span></a></span><span> </span><span id="local-6989586621679527767"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679527767"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc ann) -&gt; String -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679527767"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-607"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="IR.IR.html#LitEvent"><span class="hs-identifier hs-var">LitEvent</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;()&quot;</span></span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-610"></span><span>  </span><span id="local-6989586621679527765"><span class="annot"><span class="annottext">dumpy :: PrimOp -&gt; Doc ann
</span><a href="#local-6989586621679527765"><span class="hs-identifier hs-var hs-var hs-var hs-var">dumpy</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimNeg"><span class="hs-identifier hs-var">PrimNeg</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span>
</span><span id="line-611"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimNot"><span class="hs-identifier hs-var">PrimNot</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!&quot;</span></span><span>
</span><span id="line-612"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimBitNot"><span class="hs-identifier hs-var">PrimBitNot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;~&quot;</span></span><span>
</span><span id="line-613"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimAdd"><span class="hs-identifier hs-var">PrimAdd</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+&quot;</span></span><span>
</span><span id="line-614"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimSub"><span class="hs-identifier hs-var">PrimSub</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span>
</span><span id="line-615"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimMul"><span class="hs-identifier hs-var">PrimMul</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*&quot;</span></span><span>
</span><span id="line-616"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimDiv"><span class="hs-identifier hs-var">PrimDiv</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span>
</span><span id="line-617"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimMod"><span class="hs-identifier hs-var">PrimMod</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%&quot;</span></span><span>
</span><span id="line-618"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimBitAnd"><span class="hs-identifier hs-var">PrimBitAnd</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&amp;&quot;</span></span><span>
</span><span id="line-619"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimBitOr"><span class="hs-identifier hs-var">PrimBitOr</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;|&quot;</span></span><span>
</span><span id="line-620"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimEq"><span class="hs-identifier hs-var">PrimEq</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;==&quot;</span></span><span>
</span><span id="line-621"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimNeq"><span class="hs-identifier hs-var">PrimNeq</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!=&quot;</span></span><span>
</span><span id="line-622"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimGt"><span class="hs-identifier hs-var">PrimGt</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span>
</span><span id="line-623"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimGe"><span class="hs-identifier hs-var">PrimGe</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;=&quot;</span></span><span>
</span><span id="line-624"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimLt"><span class="hs-identifier hs-var">PrimLt</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;&quot;</span></span><span>
</span><span id="line-625"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimLe"><span class="hs-identifier hs-var">PrimLe</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;=&quot;</span></span><span>
</span><span id="line-626"></span></pre></body></html>