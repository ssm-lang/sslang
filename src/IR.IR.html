<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_ClXaWH3Eojp3wmFGAWzPkk"><span id="%24con2tag_4EuCtwubcWvB3OzS8S7IEE"></span></span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | Sslang's intermediate representation and its associated helpers.</span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">IR.IR</span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="IR.IR.html#Program"><span class="hs-identifier">Program</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#Binder"><span class="hs-identifier">Binder</span></a></span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Literal"><span class="hs-identifier">Literal</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier">PrimOp</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Primitive"><span class="hs-identifier">Primitive</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier">Expr</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Alt"><span class="hs-identifier">Alt</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier">VarId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#TConId"><span class="hs-identifier">TConId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#DConId"><span class="hs-identifier">DConId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#wellFormed"><span class="hs-identifier">wellFormed</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#collectLambda"><span class="hs-identifier">collectLambda</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#makeLambdaChain"><span class="hs-identifier">makeLambdaChain</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">extract</span></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#zipApp"><span class="hs-identifier">zipApp</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#unzipApp"><span class="hs-identifier">unzipApp</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Common.Identifiers.html"><span class="hs-identifier">Common.Identifiers</span></a></span><span>             </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Common.Identifiers.html#Binder"><span class="hs-identifier">Binder</span></a></span><span>
</span><span id="line-23"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#CSym"><span class="hs-identifier">CSym</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#DConId"><span class="hs-identifier">DConId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#TConId"><span class="hs-identifier">TConId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier">VarId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>                                                </span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Common.Pretty.html"><span class="hs-identifier">Common.Pretty</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Comonad</span></span><span>                </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Comonad</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">void</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span>                 </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Bifunctor</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Data</span></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Data</span></span><span>
</span><span id="line-33"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Typeable</span></span><span>
</span><span id="line-34"></span><span>                                                </span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="IR.Types.TypeSystem.html"><span class="hs-identifier">IR.Types.TypeSystem</span></a></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeDef"><span class="hs-identifier">TypeDef</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeSystem"><span class="hs-identifier">TypeSystem</span></a></span><span>
</span><span id="line-37"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeVariant"><span class="hs-identifier">TypeVariant</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#arrow"><span class="hs-identifier">arrow</span></a></span><span>
</span><span id="line-39"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#collectArrow"><span class="hs-identifier">collectArrow</span></a></span><span>
</span><span id="line-40"></span><span>                                                </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">{- | Top-level compilation unit.

@t@ is the type system in use, e.g., &quot;IR.Types.Flat&quot;
-}</span><span>
</span><span id="line-46"></span><span class="hs-keyword">data</span><span> </span><span id="Program"><span class="annot"><a href="IR.IR.html#Program"><span class="hs-identifier hs-var">Program</span></a></span></span><span> </span><span id="local-6989586621679471693"><span class="annot"><a href="#local-6989586621679471693"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Program"><span class="annot"><a href="IR.IR.html#Program"><span class="hs-identifier hs-var">Program</span></a></span></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="programEntry"><span class="annot"><span class="annottext">Program t -&gt; VarId
</span><a href="IR.IR.html#programEntry"><span class="hs-identifier hs-var hs-var">programEntry</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="cDefs"><span class="annot"><span class="annottext">Program t -&gt; String
</span><a href="IR.IR.html#cDefs"><span class="hs-identifier hs-var hs-var">cDefs</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="externDecls"><span class="annot"><span class="annottext">Program t -&gt; [(VarId, t)]
</span><a href="IR.IR.html#externDecls"><span class="hs-identifier hs-var hs-var">externDecls</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679471693"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="programDefs"><span class="annot"><span class="annottext">Program t -&gt; [(VarId, Expr t)]
</span><a href="IR.IR.html#programDefs"><span class="hs-identifier hs-var hs-var">programDefs</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471693"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="typeDefs"><span class="annot"><span class="annottext">Program t -&gt; [(TConId, TypeDef t)]
</span><a href="IR.IR.html#typeDefs"><span class="hs-identifier hs-var hs-var">typeDefs</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#TConId"><span class="hs-identifier hs-type">TConId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471693"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679471507"><span id="local-6989586621679471509"><span class="annot"><span class="annottext">Program t -&gt; Program t -&gt; Bool
(Program t -&gt; Program t -&gt; Bool)
-&gt; (Program t -&gt; Program t -&gt; Bool) -&gt; Eq (Program t)
forall t. Eq t =&gt; Program t -&gt; Program t -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Program t -&gt; Program t -&gt; Bool
$c/= :: forall t. Eq t =&gt; Program t -&gt; Program t -&gt; Bool
== :: Program t -&gt; Program t -&gt; Bool
$c== :: forall t. Eq t =&gt; Program t -&gt; Program t -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679471500"><span id="local-6989586621679471502"><span id="local-6989586621679471504"><span class="annot"><span class="annottext">Int -&gt; Program t -&gt; ShowS
[Program t] -&gt; ShowS
Program t -&gt; String
(Int -&gt; Program t -&gt; ShowS)
-&gt; (Program t -&gt; String)
-&gt; ([Program t] -&gt; ShowS)
-&gt; Show (Program t)
forall t. Show t =&gt; Int -&gt; Program t -&gt; ShowS
forall t. Show t =&gt; [Program t] -&gt; ShowS
forall t. Show t =&gt; Program t -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Program t] -&gt; ShowS
$cshowList :: forall t. Show t =&gt; [Program t] -&gt; ShowS
show :: Program t -&gt; String
$cshow :: forall t. Show t =&gt; Program t -&gt; String
showsPrec :: Int -&gt; Program t -&gt; ShowS
$cshowsPrec :: forall t. Show t =&gt; Int -&gt; Program t -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cProgram"><span id="%24tProgram"><span id="local-6989586621679471470"><span id="local-6989586621679471472"><span id="local-6989586621679471474"><span id="local-6989586621679471476"><span id="local-6989586621679471478"><span id="local-6989586621679471480"><span id="local-6989586621679471482"><span id="local-6989586621679471484"><span id="local-6989586621679471486"><span id="local-6989586621679471488"><span id="local-6989586621679471490"><span id="local-6989586621679471492"><span id="local-6989586621679471494"><span id="local-6989586621679471496"><span class="annot"><span class="annottext">Typeable (Program t)
DataType
Constr
Typeable (Program t)
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; Program t -&gt; c (Program t))
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Program t))
-&gt; (Program t -&gt; Constr)
-&gt; (Program t -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Program t)))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e))
    -&gt; Maybe (c (Program t)))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; Program t -&gt; Program t)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t))
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t))
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t))
-&gt; Data (Program t)
Program t -&gt; DataType
Program t -&gt; Constr
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Program t))
(forall b. Data b =&gt; b -&gt; b) -&gt; Program t -&gt; Program t
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Program t -&gt; c (Program t)
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Program t)
forall t. Data t =&gt; Typeable (Program t)
forall t. Data t =&gt; Program t -&gt; DataType
forall t. Data t =&gt; Program t -&gt; Constr
forall t.
Data t =&gt;
(forall b. Data b =&gt; b -&gt; b) -&gt; Program t -&gt; Program t
forall t u.
Data t =&gt;
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; u
forall t u.
Data t =&gt;
(forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; [u]
forall t r r'.
Data t =&gt;
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r
forall t r r'.
Data t =&gt;
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r
forall t (m :: * -&gt; *).
(Data t, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
forall t (c :: * -&gt; *).
Data t =&gt;
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Program t)
forall t (c :: * -&gt; *).
Data t =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Program t -&gt; c (Program t)
forall t (t :: * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Program t))
forall t (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (Program t))
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Program t)
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Program t -&gt; c (Program t)
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Program t))
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (Program t))
$cProgram :: Constr
$tProgram :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
$cgmapMo :: forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
$cgmapMp :: forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
$cgmapM :: forall t (m :: * -&gt; *).
(Data t, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Program t -&gt; m (Program t)
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; u
$cgmapQi :: forall t u.
Data t =&gt;
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; [u]
$cgmapQ :: forall t u.
Data t =&gt;
(forall d. Data d =&gt; d -&gt; u) -&gt; Program t -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r
$cgmapQr :: forall t r r'.
Data t =&gt;
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r
$cgmapQl :: forall t r r'.
Data t =&gt;
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Program t -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Program t -&gt; Program t
$cgmapT :: forall t.
Data t =&gt;
(forall b. Data b =&gt; b -&gt; b) -&gt; Program t -&gt; Program t
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (Program t))
$cdataCast2 :: forall t (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (Program t))
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Program t))
$cdataCast1 :: forall t (t :: * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Program t))
dataTypeOf :: Program t -&gt; DataType
$cdataTypeOf :: forall t. Data t =&gt; Program t -&gt; DataType
toConstr :: Program t -&gt; Constr
$ctoConstr :: forall t. Data t =&gt; Program t -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Program t)
$cgunfold :: forall t (c :: * -&gt; *).
Data t =&gt;
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Program t)
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Program t -&gt; c (Program t)
$cgfoldl :: forall t (c :: * -&gt; *).
Data t =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Program t -&gt; c (Program t)
$cp1Data :: forall t. Data t =&gt; Typeable (Program t)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">{- | Literal values supported by the language.

Note that these don't carry any connotation of type: @1@ just means @1@,
-}</span><span>
</span><span id="line-59"></span><span class="hs-keyword">data</span><span> </span><span id="Literal"><span class="annot"><a href="IR.IR.html#Literal"><span class="hs-identifier hs-var">Literal</span></a></span></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="LitIntegral"><span class="annot"><a href="IR.IR.html#LitIntegral"><span class="hs-identifier hs-var">LitIntegral</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LitBool"><span class="annot"><a href="IR.IR.html#LitBool"><span class="hs-identifier hs-var">LitBool</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LitEvent"><span class="annot"><a href="IR.IR.html#LitEvent"><span class="hs-identifier hs-var">LitEvent</span></a></span></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679471460"><span id="local-6989586621679471462"><span class="annot"><span class="annottext">Literal -&gt; Literal -&gt; Bool
(Literal -&gt; Literal -&gt; Bool)
-&gt; (Literal -&gt; Literal -&gt; Bool) -&gt; Eq Literal
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Literal -&gt; Literal -&gt; Bool
$c/= :: Literal -&gt; Literal -&gt; Bool
== :: Literal -&gt; Literal -&gt; Bool
$c== :: Literal -&gt; Literal -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679471454"><span id="local-6989586621679471456"><span id="local-6989586621679471458"><span class="annot"><span class="annottext">Int -&gt; Literal -&gt; ShowS
[Literal] -&gt; ShowS
Literal -&gt; String
(Int -&gt; Literal -&gt; ShowS)
-&gt; (Literal -&gt; String) -&gt; ([Literal] -&gt; ShowS) -&gt; Show Literal
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Literal] -&gt; ShowS
$cshowList :: [Literal] -&gt; ShowS
show :: Literal -&gt; String
$cshow :: Literal -&gt; String
showsPrec :: Int -&gt; Literal -&gt; ShowS
$cshowsPrec :: Int -&gt; Literal -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cLitEvent"><span id="%24cLitBool"><span id="%24cLitIntegral"><span id="%24tLiteral"><span id="local-6989586621679471425"><span id="local-6989586621679471427"><span id="local-6989586621679471429"><span id="local-6989586621679471431"><span id="local-6989586621679471433"><span id="local-6989586621679471435"><span id="local-6989586621679471437"><span id="local-6989586621679471439"><span id="local-6989586621679471441"><span id="local-6989586621679471443"><span id="local-6989586621679471445"><span id="local-6989586621679471447"><span id="local-6989586621679471449"><span id="local-6989586621679471451"><span class="annot"><span class="annottext">Typeable Literal
DataType
Constr
Typeable Literal
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; Literal -&gt; c Literal)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Literal)
-&gt; (Literal -&gt; Constr)
-&gt; (Literal -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Literal))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Literal))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; Literal -&gt; Literal)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Literal -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Literal -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Literal -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Literal -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal)
-&gt; Data Literal
Literal -&gt; DataType
Literal -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; Literal -&gt; Literal
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Literal -&gt; c Literal
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Literal
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Literal -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Literal -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Literal -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Literal -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Literal
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Literal -&gt; c Literal
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Literal)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Literal)
$cLitEvent :: Constr
$cLitBool :: Constr
$cLitIntegral :: Constr
$tLiteral :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Literal -&gt; m Literal
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Literal -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Literal -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; Literal -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Literal -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Literal -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Literal -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Literal -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Literal -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Literal -&gt; Literal
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Literal -&gt; Literal
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Literal)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Literal)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Literal)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Literal)
dataTypeOf :: Literal -&gt; DataType
$cdataTypeOf :: Literal -&gt; DataType
toConstr :: Literal -&gt; Constr
$ctoConstr :: Literal -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Literal
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Literal
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Literal -&gt; c Literal
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Literal -&gt; c Literal
$cp1Data :: Typeable Literal
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-comment">{- | Primitive operations.

These should be the kinds of functions one may expect to be available as
operators in C, or as instructions in an assembly language.

For simplicity and consistency, they should be:

- Pure (i.e., side-effectful iff operands are side-effectful, i.e., no @=@)
- Strict in all operands (i.e., no @&amp;&amp;@ or @||@)

We can instead implement short-circuit control flow using match statements.
-}</span><span>
</span><span id="line-77"></span><span class="hs-keyword">data</span><span> </span><span id="PrimOp"><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-var">PrimOp</span></a></span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PrimNeg"><span class="annot"><a href="IR.IR.html#PrimNeg"><span class="hs-identifier hs-var">PrimNeg</span></a></span></span><span>     </span><span class="hs-comment">-- ^ negation, i.e., -x</span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimNot"><span class="annot"><a href="IR.IR.html#PrimNot"><span class="hs-identifier hs-var">PrimNot</span></a></span></span><span>     </span><span class="hs-comment">-- ^ logical not, i.e., !x</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimBitNot"><span class="annot"><a href="IR.IR.html#PrimBitNot"><span class="hs-identifier hs-var">PrimBitNot</span></a></span></span><span>  </span><span class="hs-comment">-- ^ bitwise not, i.e., ~x</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimAdd"><span class="annot"><a href="IR.IR.html#PrimAdd"><span class="hs-identifier hs-var">PrimAdd</span></a></span></span><span>     </span><span class="hs-comment">-- ^ addition, i.e., x + y</span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimSub"><span class="annot"><a href="IR.IR.html#PrimSub"><span class="hs-identifier hs-var">PrimSub</span></a></span></span><span>     </span><span class="hs-comment">-- ^ subtraction, i.e., x - y</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimMul"><span class="annot"><a href="IR.IR.html#PrimMul"><span class="hs-identifier hs-var">PrimMul</span></a></span></span><span>     </span><span class="hs-comment">-- ^ multiplication, i.e., x * y</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimDiv"><span class="annot"><a href="IR.IR.html#PrimDiv"><span class="hs-identifier hs-var">PrimDiv</span></a></span></span><span>     </span><span class="hs-comment">-- ^ division, i.e., x / y</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimMod"><span class="annot"><a href="IR.IR.html#PrimMod"><span class="hs-identifier hs-var">PrimMod</span></a></span></span><span>     </span><span class="hs-comment">-- ^ modulus, i.e., x % y</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimBitAnd"><span class="annot"><a href="IR.IR.html#PrimBitAnd"><span class="hs-identifier hs-var">PrimBitAnd</span></a></span></span><span>  </span><span class="hs-comment">-- ^ bitwise-and, i.e., x &amp; y</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimBitOr"><span class="annot"><a href="IR.IR.html#PrimBitOr"><span class="hs-identifier hs-var">PrimBitOr</span></a></span></span><span>   </span><span class="hs-comment">-- ^ bitwise-or, i.e., x | y</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimEq"><span class="annot"><a href="IR.IR.html#PrimEq"><span class="hs-identifier hs-var">PrimEq</span></a></span></span><span>      </span><span class="hs-comment">-- ^ equality, i.e., x == y</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimNeq"><span class="annot"><a href="IR.IR.html#PrimNeq"><span class="hs-identifier hs-var">PrimNeq</span></a></span></span><span>     </span><span class="hs-comment">-- ^ equality, i.e., x != y</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimGt"><span class="annot"><a href="IR.IR.html#PrimGt"><span class="hs-identifier hs-var">PrimGt</span></a></span></span><span>      </span><span class="hs-comment">-- ^ greater than, i.e., x &gt; y</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimGe"><span class="annot"><a href="IR.IR.html#PrimGe"><span class="hs-identifier hs-var">PrimGe</span></a></span></span><span>      </span><span class="hs-comment">-- ^ greater than or equal to, i.e., x &gt;= y</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimLt"><span class="annot"><a href="IR.IR.html#PrimLt"><span class="hs-identifier hs-var">PrimLt</span></a></span></span><span>      </span><span class="hs-comment">-- ^ less than, i.e., x &lt; y</span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimLe"><span class="annot"><a href="IR.IR.html#PrimLe"><span class="hs-identifier hs-var">PrimLe</span></a></span></span><span>      </span><span class="hs-comment">-- ^ less than or equal to, i.e., x &lt;= y</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679471401"><span id="local-6989586621679471403"><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; Bool
(PrimOp -&gt; PrimOp -&gt; Bool)
-&gt; (PrimOp -&gt; PrimOp -&gt; Bool) -&gt; Eq PrimOp
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PrimOp -&gt; PrimOp -&gt; Bool
$c/= :: PrimOp -&gt; PrimOp -&gt; Bool
== :: PrimOp -&gt; PrimOp -&gt; Bool
$c== :: PrimOp -&gt; PrimOp -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679471395"><span id="local-6989586621679471397"><span id="local-6989586621679471399"><span class="annot"><span class="annottext">Int -&gt; PrimOp -&gt; ShowS
[PrimOp] -&gt; ShowS
PrimOp -&gt; String
(Int -&gt; PrimOp -&gt; ShowS)
-&gt; (PrimOp -&gt; String) -&gt; ([PrimOp] -&gt; ShowS) -&gt; Show PrimOp
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PrimOp] -&gt; ShowS
$cshowList :: [PrimOp] -&gt; ShowS
show :: PrimOp -&gt; String
$cshow :: PrimOp -&gt; String
showsPrec :: Int -&gt; PrimOp -&gt; ShowS
$cshowsPrec :: Int -&gt; PrimOp -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cPrimLe"><span id="%24cPrimLt"><span id="%24cPrimGe"><span id="%24cPrimGt"><span id="%24cPrimNeq"><span id="%24cPrimEq"><span id="%24cPrimBitOr"><span id="%24cPrimBitAnd"><span id="%24cPrimMod"><span id="%24cPrimDiv"><span id="%24cPrimMul"><span id="%24cPrimSub"><span id="%24cPrimAdd"><span id="%24cPrimBitNot"><span id="%24cPrimNot"><span id="%24cPrimNeg"><span id="%24tPrimOp"><span id="local-6989586621679471366"><span id="local-6989586621679471368"><span id="local-6989586621679471370"><span id="local-6989586621679471372"><span id="local-6989586621679471374"><span id="local-6989586621679471376"><span id="local-6989586621679471378"><span id="local-6989586621679471380"><span id="local-6989586621679471382"><span id="local-6989586621679471384"><span id="local-6989586621679471386"><span id="local-6989586621679471388"><span id="local-6989586621679471390"><span id="local-6989586621679471392"><span class="annot"><span class="annottext">Typeable PrimOp
DataType
Constr
Typeable PrimOp
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; PrimOp -&gt; c PrimOp)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c PrimOp)
-&gt; (PrimOp -&gt; Constr)
-&gt; (PrimOp -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c PrimOp))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c PrimOp))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; PrimOp -&gt; PrimOp)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; PrimOp -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; PrimOp -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; PrimOp -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; PrimOp -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp)
-&gt; Data PrimOp
PrimOp -&gt; DataType
PrimOp -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; PrimOp -&gt; PrimOp
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; PrimOp -&gt; c PrimOp
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c PrimOp
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; PrimOp -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; PrimOp -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; PrimOp -&gt; r
forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; PrimOp -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c PrimOp
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; PrimOp -&gt; c PrimOp
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c PrimOp)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c PrimOp)
$cPrimLe :: Constr
$cPrimLt :: Constr
$cPrimGe :: Constr
$cPrimGt :: Constr
$cPrimNeq :: Constr
$cPrimEq :: Constr
$cPrimBitOr :: Constr
$cPrimBitAnd :: Constr
$cPrimMod :: Constr
$cPrimDiv :: Constr
$cPrimMul :: Constr
$cPrimSub :: Constr
$cPrimAdd :: Constr
$cPrimBitNot :: Constr
$cPrimNot :: Constr
$cPrimNeg :: Constr
$tPrimOp :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; PrimOp -&gt; m PrimOp
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; PrimOp -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; PrimOp -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; PrimOp -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; PrimOp -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; PrimOp -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; PrimOp -&gt; r
gmapQl :: (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; PrimOp -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; PrimOp -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; PrimOp -&gt; PrimOp
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; PrimOp -&gt; PrimOp
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c PrimOp)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c PrimOp)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c PrimOp)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c PrimOp)
dataTypeOf :: PrimOp -&gt; DataType
$cdataTypeOf :: PrimOp -&gt; DataType
toConstr :: PrimOp -&gt; Constr
$ctoConstr :: PrimOp -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c PrimOp
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c PrimOp
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; PrimOp -&gt; c PrimOp
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; PrimOp -&gt; c PrimOp
$cp1Data :: Typeable PrimOp
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | Primitive functions for side-effects and imperative control flow.</span><span>
</span><span id="line-97"></span><span class="hs-keyword">data</span><span> </span><span id="Primitive"><span class="annot"><a href="IR.IR.html#Primitive"><span class="hs-identifier hs-var">Primitive</span></a></span></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="New"><span class="annot"><a href="IR.IR.html#New"><span class="hs-identifier hs-var">New</span></a></span></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-comment">{- ^ @New e@ allocates a schedule variable initialized to @e@, and
  returns a reference to it.
  -}</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Dup"><span class="annot"><a href="IR.IR.html#Dup"><span class="hs-identifier hs-var">Dup</span></a></span></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-comment">{- ^ @Dup r@ dups the reference @r@ and returns @r@. -}</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Drop"><span class="annot"><a href="IR.IR.html#Drop"><span class="hs-identifier hs-var">Drop</span></a></span></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-comment">{- ^ @Drop e r@ evaluates to @e@, but also drops @r@. -}</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Deref"><span class="annot"><a href="IR.IR.html#Deref"><span class="hs-identifier hs-var">Deref</span></a></span></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-comment">{- ^ @Deref r@ dereferences reference @r@ to obtain its value. -}</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Assign"><span class="annot"><a href="IR.IR.html#Assign"><span class="hs-identifier hs-var">Assign</span></a></span></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-comment">{- ^ @Assign r e@ instantly assigns value @e@ to reference @r@. -}</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="After"><span class="annot"><a href="IR.IR.html#After"><span class="hs-identifier hs-var">After</span></a></span></span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-comment">{- ^ @After t r e@ assigns @e@ to reference @r@ after time @t@. -}</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Par"><span class="annot"><a href="IR.IR.html#Par"><span class="hs-identifier hs-var">Par</span></a></span></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-comment">{- ^ @Par  es+@ evaluates expressions @es@ concurrently. -}</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Wait"><span class="annot"><a href="IR.IR.html#Wait"><span class="hs-identifier hs-var">Wait</span></a></span></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-comment">{- ^ @Wait rs+@ waits for an assignment to any reference in @rs@. -}</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Loop"><span class="annot"><a href="IR.IR.html#Loop"><span class="hs-identifier hs-var">Loop</span></a></span></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-comment">{- ^ @Loop b@ loops body @b@ forever. -}</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Break"><span class="annot"><a href="IR.IR.html#Break"><span class="hs-identifier hs-var">Break</span></a></span></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-comment">{- ^ @Break@ breaks out of the innermost loop. -}</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Now"><span class="annot"><a href="IR.IR.html#Now"><span class="hs-identifier hs-var">Now</span></a></span></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-comment">{- ^ @Now@ obtains the value of the current instant -}</span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrimOp"><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-var">PrimOp</span></a></span></span><span> </span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-comment">{- ^ Inlined C expression code. -}</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CQuote"><span class="annot"><a href="IR.IR.html#CQuote"><span class="hs-identifier hs-var">CQuote</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-comment">{- ^ Primitive operator. -}</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CCall"><span class="annot"><a href="IR.IR.html#CCall"><span class="hs-identifier hs-var">CCall</span></a></span></span><span> </span><span class="annot"><a href="Common.Identifiers.html#CSym"><span class="hs-identifier hs-type">CSym</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-comment">{- ^ Direct call to arbitrary C function (NOTE: HACKY). -}</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FfiCall"><span class="annot"><a href="IR.IR.html#FfiCall"><span class="hs-identifier hs-var">FfiCall</span></a></span></span><span> </span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-comment">{- ^ Call to well-typed extern symbol. -}</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679471330"><span id="local-6989586621679471332"><span class="annot"><span class="annottext">Primitive -&gt; Primitive -&gt; Bool
(Primitive -&gt; Primitive -&gt; Bool)
-&gt; (Primitive -&gt; Primitive -&gt; Bool) -&gt; Eq Primitive
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Primitive -&gt; Primitive -&gt; Bool
$c/= :: Primitive -&gt; Primitive -&gt; Bool
== :: Primitive -&gt; Primitive -&gt; Bool
$c== :: Primitive -&gt; Primitive -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679471324"><span id="local-6989586621679471326"><span id="local-6989586621679471328"><span class="annot"><span class="annottext">Int -&gt; Primitive -&gt; ShowS
[Primitive] -&gt; ShowS
Primitive -&gt; String
(Int -&gt; Primitive -&gt; ShowS)
-&gt; (Primitive -&gt; String)
-&gt; ([Primitive] -&gt; ShowS)
-&gt; Show Primitive
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Primitive] -&gt; ShowS
$cshowList :: [Primitive] -&gt; ShowS
show :: Primitive -&gt; String
$cshow :: Primitive -&gt; String
showsPrec :: Int -&gt; Primitive -&gt; ShowS
$cshowsPrec :: Int -&gt; Primitive -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cFfiCall"><span id="%24cCCall"><span id="%24cCQuote"><span id="%24cPrimOp"><span id="%24cNow"><span id="%24cBreak"><span id="%24cLoop"><span id="%24cWait"><span id="%24cPar"><span id="%24cAfter"><span id="%24cAssign"><span id="%24cDeref"><span id="%24cDrop"><span id="%24cDup"><span id="%24cNew"><span id="%24tPrimitive"><span id="local-6989586621679471295"><span id="local-6989586621679471297"><span id="local-6989586621679471299"><span id="local-6989586621679471301"><span id="local-6989586621679471303"><span id="local-6989586621679471305"><span id="local-6989586621679471307"><span id="local-6989586621679471309"><span id="local-6989586621679471311"><span id="local-6989586621679471313"><span id="local-6989586621679471315"><span id="local-6989586621679471317"><span id="local-6989586621679471319"><span id="local-6989586621679471321"><span class="annot"><span class="annottext">Typeable Primitive
DataType
Constr
Typeable Primitive
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; Primitive -&gt; c Primitive)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Primitive)
-&gt; (Primitive -&gt; Constr)
-&gt; (Primitive -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Primitive))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Primitive))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; Primitive -&gt; Primitive)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Primitive -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Primitive -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Primitive -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Primitive -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive)
-&gt; Data Primitive
Primitive -&gt; DataType
Primitive -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; Primitive -&gt; Primitive
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Primitive -&gt; c Primitive
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Primitive
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Primitive -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Primitive -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Primitive -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Primitive -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Primitive
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Primitive -&gt; c Primitive
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Primitive)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Primitive)
$cFfiCall :: Constr
$cCCall :: Constr
$cCQuote :: Constr
$cPrimOp :: Constr
$cNow :: Constr
$cBreak :: Constr
$cLoop :: Constr
$cWait :: Constr
$cPar :: Constr
$cAfter :: Constr
$cAssign :: Constr
$cDeref :: Constr
$cDrop :: Constr
$cDup :: Constr
$cNew :: Constr
$tPrimitive :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Primitive -&gt; m Primitive
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Primitive -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Primitive -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; Primitive -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Primitive -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Primitive -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Primitive -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Primitive -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Primitive -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Primitive -&gt; Primitive
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Primitive -&gt; Primitive
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Primitive)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Primitive)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Primitive)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Primitive)
dataTypeOf :: Primitive -&gt; DataType
$cdataTypeOf :: Primitive -&gt; DataType
toConstr :: Primitive -&gt; Constr
$ctoConstr :: Primitive -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Primitive
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Primitive
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Primitive -&gt; c Primitive
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Primitive -&gt; c Primitive
$cp1Data :: Typeable Primitive
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-comment">{- | Expressions, based on the let-polymorphic lambda calculus.

@t@ represents the type of this expression, e.g., 'IR.Types.Flat'. At
various stages, this may represent a richer or simpler type
system. The type is embedded in each data constructor so as to
type-annotate the entire expression tree.

Designed for side effects with call-by-value evaluation order. Basic
sequencing can be recovered through let-bindings:

&gt; let _ = stmt1 in
&gt; let _ = stmt2 in
&gt; ...

Effects of @stmt1@ take place before that of @stmt2@.
-}</span><span>
</span><span id="line-148"></span><span class="hs-keyword">data</span><span> </span><span id="Expr"><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span></span><span> </span><span id="local-6989586621679471721"><span class="annot"><a href="#local-6989586621679471721"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Var"><span class="annot"><a href="IR.IR.html#Var"><span class="hs-identifier hs-var">Var</span></a></span></span><span> </span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471721"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-comment">{- ^ @Var n t@ is a variable named @n@ of type @t@. -}</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Data"><span class="annot"><a href="IR.IR.html#Data"><span class="hs-identifier hs-var">Data</span></a></span></span><span> </span><span class="annot"><a href="Common.Identifiers.html#DConId"><span class="hs-identifier hs-type">DConId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471721"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-comment">{- ^ @Data d t@ is a data constructor named @d@ of type @t@. -}</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Lit"><span class="annot"><a href="IR.IR.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span></span><span> </span><span class="annot"><a href="IR.IR.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471721"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-comment">{- ^ @Lit l t@ is a literal value @l@ of type @t@. -}</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="App"><span class="annot"><a href="IR.IR.html#App"><span class="hs-identifier hs-var">App</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471721"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471721"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679471721"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-comment">{- ^ @App f a t@ applies function @f@ to argument @a@, producing a value of
  type @t@.
  -}</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Let"><span class="annot"><a href="IR.IR.html#Let"><span class="hs-identifier hs-var">Let</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471721"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471721"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679471721"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-comment">{- ^ @Let [(n, v)] b t@ binds value @v@ to variable @v@ in its body @b@.

  The bindings list may only be of length greater than 1 for a set of mutually
  co-recursive functions.
  -}</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Lambda"><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a></span></span><span> </span><span class="annot"><a href="Common.Identifiers.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471721"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679471721"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-comment">{- ^ @Lambda v b t@ constructs an anonymous function of type @t@ that binds
  a value to parameter @v@ in its body @b@.
  -}</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Match"><span class="annot"><a href="IR.IR.html#Match"><span class="hs-identifier hs-var">Match</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471721"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471721"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679471721"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-comment">{- ^ @Match s alts t@ pattern-matches on scrutinee @s@ against alternatives
  @alts@, each producing a value of type @t@.
  -}</span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Prim"><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-var">Prim</span></a></span></span><span> </span><span class="annot"><a href="IR.IR.html#Primitive"><span class="hs-identifier hs-type">Primitive</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471721"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679471721"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-comment">{- ^ @Prim p es t@ applies primitive @p@ arguments @es@, producing a value
  of type @t@.
  -}</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679471267"><span id="local-6989586621679471269"><span class="annot"><span class="annottext">Expr t -&gt; Expr t -&gt; Bool
(Expr t -&gt; Expr t -&gt; Bool)
-&gt; (Expr t -&gt; Expr t -&gt; Bool) -&gt; Eq (Expr t)
forall t. Eq t =&gt; Expr t -&gt; Expr t -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Expr t -&gt; Expr t -&gt; Bool
$c/= :: forall t. Eq t =&gt; Expr t -&gt; Expr t -&gt; Bool
== :: Expr t -&gt; Expr t -&gt; Bool
$c== :: forall t. Eq t =&gt; Expr t -&gt; Expr t -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679471261"><span id="local-6989586621679471263"><span id="local-6989586621679471265"><span class="annot"><span class="annottext">Int -&gt; Expr t -&gt; ShowS
[Expr t] -&gt; ShowS
Expr t -&gt; String
(Int -&gt; Expr t -&gt; ShowS)
-&gt; (Expr t -&gt; String) -&gt; ([Expr t] -&gt; ShowS) -&gt; Show (Expr t)
forall t. Show t =&gt; Int -&gt; Expr t -&gt; ShowS
forall t. Show t =&gt; [Expr t] -&gt; ShowS
forall t. Show t =&gt; Expr t -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Expr t] -&gt; ShowS
$cshowList :: forall t. Show t =&gt; [Expr t] -&gt; ShowS
show :: Expr t -&gt; String
$cshow :: forall t. Show t =&gt; Expr t -&gt; String
showsPrec :: Int -&gt; Expr t -&gt; ShowS
$cshowsPrec :: forall t. Show t =&gt; Int -&gt; Expr t -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cPrim"><span id="%24cMatch"><span id="%24cLambda"><span id="%24cLet"><span id="%24cApp"><span id="%24cLit"><span id="%24cData"><span id="%24cVar"><span id="%24tExpr"><span id="local-6989586621679471232"><span id="local-6989586621679471234"><span id="local-6989586621679471236"><span id="local-6989586621679471238"><span id="local-6989586621679471240"><span id="local-6989586621679471242"><span id="local-6989586621679471244"><span id="local-6989586621679471246"><span id="local-6989586621679471248"><span id="local-6989586621679471250"><span id="local-6989586621679471252"><span id="local-6989586621679471254"><span id="local-6989586621679471256"><span id="local-6989586621679471258"><span class="annot"><span class="annottext">Typeable (Expr t)
DataType
Constr
Typeable (Expr t)
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; Expr t -&gt; c (Expr t))
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Expr t))
-&gt; (Expr t -&gt; Constr)
-&gt; (Expr t -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Expr t)))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c (Expr t)))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; Expr t -&gt; Expr t)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t))
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t))
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t))
-&gt; Data (Expr t)
Expr t -&gt; DataType
Expr t -&gt; Constr
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Expr t))
(forall b. Data b =&gt; b -&gt; b) -&gt; Expr t -&gt; Expr t
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Expr t -&gt; c (Expr t)
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Expr t)
forall t. Data t =&gt; Typeable (Expr t)
forall t. Data t =&gt; Expr t -&gt; DataType
forall t. Data t =&gt; Expr t -&gt; Constr
forall t.
Data t =&gt;
(forall b. Data b =&gt; b -&gt; b) -&gt; Expr t -&gt; Expr t
forall t u.
Data t =&gt;
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; u
forall t u. Data t =&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; [u]
forall t r r'.
Data t =&gt;
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r
forall t r r'.
Data t =&gt;
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r
forall t (m :: * -&gt; *).
(Data t, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
forall t (c :: * -&gt; *).
Data t =&gt;
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Expr t)
forall t (c :: * -&gt; *).
Data t =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Expr t -&gt; c (Expr t)
forall t (t :: * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Expr t))
forall t (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c (Expr t))
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r
forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Expr t)
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Expr t -&gt; c (Expr t)
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Expr t))
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c (Expr t))
$cPrim :: Constr
$cMatch :: Constr
$cLambda :: Constr
$cLet :: Constr
$cApp :: Constr
$cLit :: Constr
$cData :: Constr
$cVar :: Constr
$tExpr :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
$cgmapMo :: forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
$cgmapMp :: forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
$cgmapM :: forall t (m :: * -&gt; *).
(Data t, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Expr t -&gt; m (Expr t)
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; u
$cgmapQi :: forall t u.
Data t =&gt;
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; [u]
$cgmapQ :: forall t u. Data t =&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Expr t -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r
$cgmapQr :: forall t r r'.
Data t =&gt;
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r
gmapQl :: (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r
$cgmapQl :: forall t r r'.
Data t =&gt;
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Expr t -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Expr t -&gt; Expr t
$cgmapT :: forall t.
Data t =&gt;
(forall b. Data b =&gt; b -&gt; b) -&gt; Expr t -&gt; Expr t
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c (Expr t))
$cdataCast2 :: forall t (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c (Expr t))
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Expr t))
$cdataCast1 :: forall t (t :: * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Expr t))
dataTypeOf :: Expr t -&gt; DataType
$cdataTypeOf :: forall t. Data t =&gt; Expr t -&gt; DataType
toConstr :: Expr t -&gt; Constr
$ctoConstr :: forall t. Data t =&gt; Expr t -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Expr t)
$cgunfold :: forall t (c :: * -&gt; *).
Data t =&gt;
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Expr t)
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Expr t -&gt; c (Expr t)
$cgfoldl :: forall t (c :: * -&gt; *).
Data t =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Expr t -&gt; c (Expr t)
$cp1Data :: forall t. Data t =&gt; Typeable (Expr t)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- | An alternative in a pattern-match.</span><span>
</span><span id="line-180"></span><span class="hs-keyword">data</span><span> </span><span id="Alt"><span class="annot"><a href="IR.IR.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="AltData"><span class="annot"><a href="IR.IR.html#AltData"><span class="hs-identifier hs-var">AltData</span></a></span></span><span> </span><span class="annot"><a href="Common.Identifiers.html#DConId"><span class="hs-identifier hs-type">DConId</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.Identifiers.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-comment">-- ^ @AltData d vs@ matches data constructor @d@, and names dcon members @vs@.</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AltLit"><span class="annot"><a href="IR.IR.html#AltLit"><span class="hs-identifier hs-var">AltLit</span></a></span></span><span> </span><span class="annot"><a href="IR.IR.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-comment">-- ^ @AltLit l@ matches against literal @l@, producing expression @e@.</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AltDefault"><span class="annot"><a href="IR.IR.html#AltDefault"><span class="hs-identifier hs-var">AltDefault</span></a></span></span><span> </span><span class="annot"><a href="Common.Identifiers.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-comment">-- ^ @AltDefault v@ matches anything, and bound to name @v@.</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679471216"><span id="local-6989586621679471218"><span class="annot"><span class="annottext">Alt -&gt; Alt -&gt; Bool
(Alt -&gt; Alt -&gt; Bool) -&gt; (Alt -&gt; Alt -&gt; Bool) -&gt; Eq Alt
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Alt -&gt; Alt -&gt; Bool
$c/= :: Alt -&gt; Alt -&gt; Bool
== :: Alt -&gt; Alt -&gt; Bool
$c== :: Alt -&gt; Alt -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679471210"><span id="local-6989586621679471212"><span id="local-6989586621679471214"><span class="annot"><span class="annottext">Int -&gt; Alt -&gt; ShowS
[Alt] -&gt; ShowS
Alt -&gt; String
(Int -&gt; Alt -&gt; ShowS)
-&gt; (Alt -&gt; String) -&gt; ([Alt] -&gt; ShowS) -&gt; Show Alt
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Alt] -&gt; ShowS
$cshowList :: [Alt] -&gt; ShowS
show :: Alt -&gt; String
$cshow :: Alt -&gt; String
showsPrec :: Int -&gt; Alt -&gt; ShowS
$cshowsPrec :: Int -&gt; Alt -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cAltDefault"><span id="%24cAltLit"><span id="%24cAltData"><span id="%24tAlt"><span id="local-6989586621679471181"><span id="local-6989586621679471183"><span id="local-6989586621679471185"><span id="local-6989586621679471187"><span id="local-6989586621679471189"><span id="local-6989586621679471191"><span id="local-6989586621679471193"><span id="local-6989586621679471195"><span id="local-6989586621679471197"><span id="local-6989586621679471199"><span id="local-6989586621679471201"><span id="local-6989586621679471203"><span id="local-6989586621679471205"><span id="local-6989586621679471207"><span class="annot"><span class="annottext">Typeable Alt
DataType
Constr
Typeable Alt
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; Alt -&gt; c Alt)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Alt)
-&gt; (Alt -&gt; Constr)
-&gt; (Alt -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Alt))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Alt))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; Alt -&gt; Alt)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Alt -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Alt -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Alt -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Alt -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt)
-&gt; Data Alt
Alt -&gt; DataType
Alt -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; Alt -&gt; Alt
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Alt -&gt; c Alt
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Alt
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Alt -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Alt -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Alt -&gt; r
forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Alt -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Alt
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Alt -&gt; c Alt
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Alt)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Alt)
$cAltDefault :: Constr
$cAltLit :: Constr
$cAltData :: Constr
$tAlt :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Alt -&gt; m Alt
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Alt -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Alt -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; Alt -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Alt -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Alt -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Alt -&gt; r
gmapQl :: (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Alt -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Alt -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Alt -&gt; Alt
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Alt -&gt; Alt
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Alt)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Alt)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Alt)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Alt)
dataTypeOf :: Alt -&gt; DataType
$cdataTypeOf :: Alt -&gt; DataType
toConstr :: Alt -&gt; Constr
$ctoConstr :: Alt -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Alt
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Alt
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Alt -&gt; c Alt
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Alt -&gt; c Alt
$cp1Data :: Typeable Alt
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">{- | Collect a curried application into the function and argument list.

The type accompanying each argument represents type produced by the
application, and is extracted from the 'App' node that this function unwraps.

For example, the term @f a b@ (where @a: A@ and @b: B@) would be represented by
the following AST:
@@
(App (App (Var f (A -&gt; B -&gt; C)) (Var a A) (B -&gt; C)) (Var b B) C)
@@

which, when unzipped, gives:

@@
(Var f (A -&gt; B -&gt; C)) [(Var a A, B -&gt; C), (Var b B, C)]
@@

'unzipApp' is the inverse of 'zipApp'.
-}</span><span>
</span><span id="line-208"></span><span id="local-6989586621679471731"><span class="annot"><a href="IR.IR.html#unzipApp"><span class="hs-identifier hs-type">unzipApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471731"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471731"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471731"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679471731"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-209"></span><span id="unzipApp"><span class="annot"><span class="annottext">unzipApp :: Expr t -&gt; (Expr t, [(Expr t, t)])
</span><a href="IR.IR.html#unzipApp"><span class="hs-identifier hs-var hs-var">unzipApp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621679471176"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471176"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679471175"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471175"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621679471174"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679471174"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679471173"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471173"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679471172"><span class="annot"><span class="annottext">[(Expr t, t)]
</span><a href="#local-6989586621679471172"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; (Expr t, [(Expr t, t)])
forall t. Expr t -&gt; (Expr t, [(Expr t, t)])
</span><a href="IR.IR.html#unzipApp"><span class="hs-identifier hs-var">unzipApp</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471176"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471173"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Expr t, t)]
</span><a href="#local-6989586621679471172"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[(Expr t, t)] -&gt; [(Expr t, t)] -&gt; [(Expr t, t)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471175"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679471174"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span class="annot"><a href="IR.IR.html#unzipApp"><span class="hs-identifier hs-var">unzipApp</span></a></span><span> </span><span id="local-6989586621679471171"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471171"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471171"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">{- | Apply a function to zero or more arguments.

'zipApp' is the inverse of 'unzipApp'.
-}</span><span>
</span><span id="line-217"></span><span id="local-6989586621679471170"><span class="annot"><a href="IR.IR.html#zipApp"><span class="hs-identifier hs-type">zipApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471170"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471170"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679471170"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471170"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-218"></span><span id="zipApp"><span class="annot"><span class="annottext">zipApp :: Expr t -&gt; [(Expr t, t)] -&gt; Expr t
</span><a href="IR.IR.html#zipApp"><span class="hs-identifier hs-var hs-var">zipApp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Expr t, t) -&gt; Expr t -&gt; Expr t)
-&gt; Expr t -&gt; [(Expr t, t)] -&gt; Expr t
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(((Expr t, t) -&gt; Expr t -&gt; Expr t)
 -&gt; Expr t -&gt; [(Expr t, t)] -&gt; Expr t)
-&gt; ((Expr t, t) -&gt; Expr t -&gt; Expr t)
-&gt; Expr t
-&gt; [(Expr t, t)]
-&gt; Expr t
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679471168"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471168"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679471167"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679471167"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679471166"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471166"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Expr t -&gt; t -&gt; Expr t
forall t. Expr t -&gt; Expr t -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471166"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471168"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679471167"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">-- | Collect a curried list of function arguments from a nesting of lambdas.</span><span>
</span><span id="line-221"></span><span id="local-6989586621679471718"><span class="annot"><a href="IR.IR.html#collectLambda"><span class="hs-identifier hs-type">collectLambda</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471718"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Common.Identifiers.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471718"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-222"></span><span id="collectLambda"><span class="annot"><span class="annottext">collectLambda :: Expr t -&gt; ([Binder], Expr t)
</span><a href="IR.IR.html#collectLambda"><span class="hs-identifier hs-var hs-var">collectLambda</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span id="local-6989586621679471165"><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679471165"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679471164"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471164"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679471163"><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621679471163"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679471162"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471162"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; ([Binder], Expr t)
forall t. Expr t -&gt; ([Binder], Expr t)
</span><a href="IR.IR.html#collectLambda"><span class="hs-identifier hs-var">collectLambda</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471164"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679471165"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Binder -&gt; [Binder] -&gt; [Binder]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621679471163"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471162"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span class="annot"><a href="IR.IR.html#collectLambda"><span class="hs-identifier hs-var">collectLambda</span></a></span><span> </span><span id="local-6989586621679471161"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471161"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471161"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-comment">-- | Create a lambda chain given a list of argument-type pairs and a body.</span><span>
</span><span id="line-227"></span><span id="local-6989586621679471160"><span class="annot"><a href="IR.IR.html#makeLambdaChain"><span class="hs-identifier hs-type">makeLambdaChain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeSystem"><span class="hs-identifier hs-type">TypeSystem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471160"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#Binder"><span class="hs-identifier hs-type">Binder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679471160"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471160"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471160"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-228"></span><span id="makeLambdaChain"><span class="annot"><span class="annottext">makeLambdaChain :: [(Binder, t)] -&gt; Expr t -&gt; Expr t
</span><a href="IR.IR.html#makeLambdaChain"><span class="hs-identifier hs-var hs-var">makeLambdaChain</span></a></span></span><span> </span><span id="local-6989586621679471159"><span class="annot"><span class="annottext">[(Binder, t)]
</span><a href="#local-6989586621679471159"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679471158"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471158"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Binder, t) -&gt; Expr t -&gt; Expr t)
-&gt; Expr t -&gt; [(Binder, t)] -&gt; Expr t
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(Binder, t) -&gt; Expr t -&gt; Expr t
forall t. TypeSystem t =&gt; (Binder, t) -&gt; Expr t -&gt; Expr t
</span><a href="#local-6989586621679471157"><span class="hs-identifier hs-var">chain</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471158"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">[(Binder, t)]
</span><a href="#local-6989586621679471159"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679471157"><span class="annot"><span class="annottext">chain :: (Binder, t) -&gt; Expr t -&gt; Expr t
</span><a href="#local-6989586621679471157"><span class="hs-identifier hs-var hs-var">chain</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679471156"><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679471156"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679471155"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679471155"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679471154"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471154"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binder -&gt; Expr t -&gt; t -&gt; Expr t
forall t. Binder -&gt; Expr t -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a></span><span> </span><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679471156"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471154"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(t -&gt; Expr t) -&gt; t -&gt; Expr t
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679471155"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall t. TypeSystem t =&gt; t -&gt; t -&gt; t
</span><a href="IR.Types.TypeSystem.html#arrow"><span class="hs-operator hs-var">`arrow`</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; t
forall (w :: * -&gt; *) a. Comonad w =&gt; w a -&gt; a
</span><span class="hs-identifier hs-var">extract</span></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471154"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679471151"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="IR.IR.html#Program"><span class="hs-identifier hs-type">Program</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-232"></span><span>  </span><span id="local-6989586621679471149"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; Program a -&gt; Program b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679471148"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471148"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679471147"><span class="annot"><span class="annottext">Program a
</span><a href="#local-6989586621679471147"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Program a
</span><a href="#local-6989586621679471147"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">programDefs :: [(VarId, Expr b)]
</span><a href="IR.IR.html#programDefs"><span class="hs-identifier hs-var">programDefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Expr a -&gt; Expr b) -&gt; (VarId, Expr a) -&gt; (VarId, Expr b)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Expr a -&gt; Expr b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471148"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((VarId, Expr a) -&gt; (VarId, Expr b))
-&gt; [(VarId, Expr a)] -&gt; [(VarId, Expr b)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Program a -&gt; [(VarId, Expr a)]
forall t. Program t -&gt; [(VarId, Expr t)]
</span><a href="IR.IR.html#programDefs"><span class="hs-identifier hs-var hs-var">programDefs</span></a></span><span> </span><span class="annot"><span class="annottext">Program a
</span><a href="#local-6989586621679471147"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-233"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">typeDefs :: [(TConId, TypeDef b)]
</span><a href="IR.IR.html#typeDefs"><span class="hs-identifier hs-var">typeDefs</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TypeDef a -&gt; TypeDef b)
-&gt; (TConId, TypeDef a) -&gt; (TConId, TypeDef b)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; TypeDef a -&gt; TypeDef b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471148"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((TConId, TypeDef a) -&gt; (TConId, TypeDef b))
-&gt; [(TConId, TypeDef a)] -&gt; [(TConId, TypeDef b)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Program a -&gt; [(TConId, TypeDef a)]
forall t. Program t -&gt; [(TConId, TypeDef t)]
</span><a href="IR.IR.html#typeDefs"><span class="hs-identifier hs-var hs-var">typeDefs</span></a></span><span> </span><span class="annot"><span class="annottext">Program a
</span><a href="#local-6989586621679471147"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-234"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">externDecls :: [(VarId, b)]
</span><a href="IR.IR.html#externDecls"><span class="hs-identifier hs-var">externDecls</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (VarId, a) -&gt; (VarId, b)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471148"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">((VarId, a) -&gt; (VarId, b)) -&gt; [(VarId, a)] -&gt; [(VarId, b)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Program a -&gt; [(VarId, a)]
forall t. Program t -&gt; [(VarId, t)]
</span><a href="IR.IR.html#externDecls"><span class="hs-identifier hs-var hs-var">externDecls</span></a></span><span> </span><span class="annot"><span class="annottext">Program a
</span><a href="#local-6989586621679471147"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-235"></span><span>               </span><span class="hs-special">}</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679471142"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-238"></span><span>  </span><span id="local-6989586621679471141"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; Expr a -&gt; Expr b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679471140"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471140"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>  </span><span id="local-6989586621679471139"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679471139"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679471138"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471138"><span class="hs-identifier hs-var">t</span></a></span></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarId -&gt; b -&gt; Expr b
forall t. VarId -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679471139"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471140"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471138"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679471137"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471137"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span id="local-6989586621679471136"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679471136"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679471135"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471135"><span class="hs-identifier hs-var">t</span></a></span></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DConId -&gt; b -&gt; Expr b
forall t. DConId -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Data"><span class="hs-identifier hs-var">Data</span></a></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679471136"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471137"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471135"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679471134"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471134"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span>  </span><span id="local-6989586621679471133"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679471133"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679471132"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471132"><span class="hs-identifier hs-var">t</span></a></span></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; b -&gt; Expr b
forall t. Literal -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679471133"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471134"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471132"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679471131"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471131"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#App"><span class="hs-identifier hs-type">App</span></a></span><span>    </span><span id="local-6989586621679471130"><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471130"><span class="hs-identifier hs-var">l</span></a></span></span><span>  </span><span id="local-6989586621679471129"><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471129"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span id="local-6989586621679471128"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471128"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr b -&gt; Expr b -&gt; b -&gt; Expr b
forall t. Expr t -&gt; Expr t -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Expr a -&gt; Expr b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471131"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471130"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Expr a -&gt; Expr b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471131"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471129"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471131"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471128"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679471127"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471127"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span>    </span><span id="local-6989586621679471126"><span class="annot"><span class="annottext">[(Binder, Expr a)]
</span><a href="#local-6989586621679471126"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679471125"><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471125"><span class="hs-identifier hs-var">b</span></a></span></span><span>  </span><span id="local-6989586621679471124"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471124"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Binder, Expr b)] -&gt; Expr b -&gt; b -&gt; Expr b
forall t. [(Binder, Expr t)] -&gt; Expr t -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Binder, Expr a) -&gt; (Binder, Expr b))
-&gt; [(Binder, Expr a)] -&gt; [(Binder, Expr b)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr a -&gt; Expr b) -&gt; (Binder, Expr a) -&gt; (Binder, Expr b)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">((Expr a -&gt; Expr b) -&gt; (Binder, Expr a) -&gt; (Binder, Expr b))
-&gt; (Expr a -&gt; Expr b) -&gt; (Binder, Expr a) -&gt; (Binder, Expr b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Expr a -&gt; Expr b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471127"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Binder, Expr a)]
</span><a href="#local-6989586621679471126"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Expr a -&gt; Expr b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471127"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471125"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471127"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471124"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679471123"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471123"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span id="local-6989586621679471122"><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679471122"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span id="local-6989586621679471121"><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471121"><span class="hs-identifier hs-var">b</span></a></span></span><span>  </span><span id="local-6989586621679471120"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471120"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binder -&gt; Expr b -&gt; b -&gt; Expr b
forall t. Binder -&gt; Expr t -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a></span><span> </span><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679471122"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Expr a -&gt; Expr b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471123"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471121"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471123"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471120"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679471119"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471119"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span>  </span><span id="local-6989586621679471118"><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471118"><span class="hs-identifier hs-var">s</span></a></span></span><span>  </span><span id="local-6989586621679471117"><span class="annot"><span class="annottext">[(Alt, Expr a)]
</span><a href="#local-6989586621679471117"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679471116"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471116"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr b -&gt; [(Alt, Expr b)] -&gt; b -&gt; Expr b
forall t. Expr t -&gt; [(Alt, Expr t)] -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Match"><span class="hs-identifier hs-var">Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Expr a -&gt; Expr b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471119"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471118"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Alt, Expr a) -&gt; (Alt, Expr b))
-&gt; [(Alt, Expr a)] -&gt; [(Alt, Expr b)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr a -&gt; Expr b) -&gt; (Alt, Expr a) -&gt; (Alt, Expr b)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">((Expr a -&gt; Expr b) -&gt; (Alt, Expr a) -&gt; (Alt, Expr b))
-&gt; (Expr a -&gt; Expr b) -&gt; (Alt, Expr a) -&gt; (Alt, Expr b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Expr a -&gt; Expr b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471119"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Alt, Expr a)]
</span><a href="#local-6989586621679471117"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471119"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471116"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679471115"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471115"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>   </span><span id="local-6989586621679471114"><span class="annot"><span class="annottext">Primitive
</span><a href="#local-6989586621679471114"><span class="hs-identifier hs-var">p</span></a></span></span><span>  </span><span id="local-6989586621679471113"><span class="annot"><span class="annottext">[Expr a]
</span><a href="#local-6989586621679471113"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679471112"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471112"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Primitive -&gt; [Expr b] -&gt; b -&gt; Expr b
forall t. Primitive -&gt; [Expr t] -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Prim"><span class="hs-identifier hs-var">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="#local-6989586621679471114"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr a -&gt; Expr b) -&gt; [Expr a] -&gt; [Expr b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Expr a -&gt; Expr b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471115"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Expr a]
</span><a href="#local-6989586621679471113"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679471115"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471112"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679471108"><span class="annot"><span class="hs-identifier hs-type">Comonad</span></span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>  </span><span id="local-6989586621679471105"><span class="annot"><span class="annottext">extract :: Expr a -&gt; a
</span><a href="#local-6989586621679471105"><span class="hs-identifier hs-var hs-var hs-var hs-var">extract</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>  </span><span class="annot"><span class="annottext">VarId
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679471104"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471104"><span class="hs-identifier hs-var">t</span></a></span></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471104"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">extract</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><span class="annottext">DConId
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679471103"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471103"><span class="hs-identifier hs-var">t</span></a></span></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471103"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">extract</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span>  </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679471102"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471102"><span class="hs-identifier hs-var">t</span></a></span></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471102"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">extract</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span>    </span><span class="annot"><span class="annottext">[(Binder, Expr a)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679471101"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471101"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471101"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-252"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">extract</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span class="annot"><span class="annottext">Binder
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679471100"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471100"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471100"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">extract</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#App"><span class="hs-identifier hs-type">App</span></a></span><span>    </span><span class="annot"><span class="annottext">Expr a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679471099"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471099"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471099"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">extract</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span>  </span><span class="annot"><span class="annottext">Expr a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(Alt, Expr a)]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679471098"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471098"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471098"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">extract</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>   </span><span class="annot"><span class="annottext">Primitive
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Expr a]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679471097"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471097"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471097"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span id="local-6989586621679471096"><span class="annot"><span class="annottext">extend :: (Expr a -&gt; b) -&gt; Expr a -&gt; Expr b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">extend</span></span></span><span> </span><span id="local-6989586621679471094"><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471094"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679471093"><span class="annot"><span class="annottext">e :: Expr a
</span><a href="#local-6989586621679471093"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>  </span><span id="local-6989586621679471092"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679471092"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarId -&gt; b -&gt; Expr b
forall t. VarId -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679471092"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471094"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471093"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">extend</span></span><span> </span><span id="local-6989586621679471091"><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471091"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679471090"><span class="annot"><span class="annottext">e :: Expr a
</span><a href="#local-6989586621679471090"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span id="local-6989586621679471089"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679471089"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DConId -&gt; b -&gt; Expr b
forall t. DConId -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Data"><span class="hs-identifier hs-var">Data</span></a></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679471089"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471091"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471090"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">extend</span></span><span> </span><span id="local-6989586621679471088"><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471088"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679471087"><span class="annot"><span class="annottext">e :: Expr a
</span><a href="#local-6989586621679471087"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span>  </span><span id="local-6989586621679471086"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679471086"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; b -&gt; Expr b
forall t. Literal -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679471086"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471088"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471087"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">extend</span></span><span> </span><span id="local-6989586621679471085"><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471085"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679471084"><span class="annot"><span class="annottext">e :: Expr a
</span><a href="#local-6989586621679471084"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679471083"><span class="annot"><span class="annottext">[(Binder, Expr a)]
</span><a href="#local-6989586621679471083"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679471082"><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471082"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><span class="annottext">[(Binder, Expr b)] -&gt; Expr b -&gt; b -&gt; Expr b
forall t. [(Binder, Expr t)] -&gt; Expr t -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Binder, Expr a) -&gt; (Binder, Expr b))
-&gt; [(Binder, Expr a)] -&gt; [(Binder, Expr b)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr a -&gt; Expr b) -&gt; (Binder, Expr a) -&gt; (Binder, Expr b)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">((Expr a -&gt; Expr b) -&gt; (Binder, Expr a) -&gt; (Binder, Expr b))
-&gt; (Expr a -&gt; Expr b) -&gt; (Binder, Expr a) -&gt; (Binder, Expr b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Expr a -&gt; b) -&gt; Expr a -&gt; Expr b
forall (w :: * -&gt; *) a b. Comonad w =&gt; (w a -&gt; b) -&gt; w a -&gt; w b
</span><span class="hs-identifier hs-var">extend</span></span><span> </span><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471085"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Binder, Expr a)]
</span><a href="#local-6989586621679471083"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr a -&gt; b) -&gt; Expr a -&gt; Expr b
forall (w :: * -&gt; *) a b. Comonad w =&gt; (w a -&gt; b) -&gt; w a -&gt; w b
</span><span class="hs-identifier hs-var">extend</span></span><span> </span><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471085"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471082"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471085"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471084"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">extend</span></span><span> </span><span id="local-6989586621679471081"><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471081"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679471080"><span class="annot"><span class="annottext">e :: Expr a
</span><a href="#local-6989586621679471080"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span id="local-6989586621679471079"><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679471079"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679471078"><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471078"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binder -&gt; Expr b -&gt; b -&gt; Expr b
forall t. Binder -&gt; Expr t -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a></span><span> </span><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679471079"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr a -&gt; b) -&gt; Expr a -&gt; Expr b
forall (w :: * -&gt; *) a b. Comonad w =&gt; (w a -&gt; b) -&gt; w a -&gt; w b
</span><span class="hs-identifier hs-var">extend</span></span><span> </span><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471081"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471078"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471081"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471080"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">extend</span></span><span> </span><span id="local-6989586621679471077"><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471077"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679471076"><span class="annot"><span class="annottext">e :: Expr a
</span><a href="#local-6989586621679471076"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#App"><span class="hs-identifier hs-type">App</span></a></span><span>    </span><span id="local-6989586621679471075"><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471075"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679471074"><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471074"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr b -&gt; Expr b -&gt; b -&gt; Expr b
forall t. Expr t -&gt; Expr t -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr a -&gt; b) -&gt; Expr a -&gt; Expr b
forall (w :: * -&gt; *) a b. Comonad w =&gt; (w a -&gt; b) -&gt; w a -&gt; w b
</span><span class="hs-identifier hs-var">extend</span></span><span> </span><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471077"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471075"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr a -&gt; b) -&gt; Expr a -&gt; Expr b
forall (w :: * -&gt; *) a b. Comonad w =&gt; (w a -&gt; b) -&gt; w a -&gt; w b
</span><span class="hs-identifier hs-var">extend</span></span><span> </span><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471077"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471074"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471077"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471076"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">extend</span></span><span> </span><span id="local-6989586621679471073"><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471073"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679471072"><span class="annot"><span class="annottext">e :: Expr a
</span><a href="#local-6989586621679471072"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621679471071"><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471071"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679471070"><span class="annot"><span class="annottext">[(Alt, Expr a)]
</span><a href="#local-6989586621679471070"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><span class="annottext">Expr b -&gt; [(Alt, Expr b)] -&gt; b -&gt; Expr b
forall t. Expr t -&gt; [(Alt, Expr t)] -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Match"><span class="hs-identifier hs-var">Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr a -&gt; b) -&gt; Expr a -&gt; Expr b
forall (w :: * -&gt; *) a b. Comonad w =&gt; (w a -&gt; b) -&gt; w a -&gt; w b
</span><span class="hs-identifier hs-var">extend</span></span><span> </span><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471073"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471071"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Alt, Expr a) -&gt; (Alt, Expr b))
-&gt; [(Alt, Expr a)] -&gt; [(Alt, Expr b)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr a -&gt; Expr b) -&gt; (Alt, Expr a) -&gt; (Alt, Expr b)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">((Expr a -&gt; Expr b) -&gt; (Alt, Expr a) -&gt; (Alt, Expr b))
-&gt; (Expr a -&gt; Expr b) -&gt; (Alt, Expr a) -&gt; (Alt, Expr b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Expr a -&gt; b) -&gt; Expr a -&gt; Expr b
forall (w :: * -&gt; *) a b. Comonad w =&gt; (w a -&gt; b) -&gt; w a -&gt; w b
</span><span class="hs-identifier hs-var">extend</span></span><span> </span><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471073"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Alt, Expr a)]
</span><a href="#local-6989586621679471070"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471073"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471072"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">extend</span></span><span> </span><span id="local-6989586621679471069"><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471069"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679471068"><span class="annot"><span class="annottext">e :: Expr a
</span><a href="#local-6989586621679471068"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span id="local-6989586621679471067"><span class="annot"><span class="annottext">Primitive
</span><a href="#local-6989586621679471067"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679471066"><span class="annot"><span class="annottext">[Expr a]
</span><a href="#local-6989586621679471066"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Primitive -&gt; [Expr b] -&gt; b -&gt; Expr b
forall t. Primitive -&gt; [Expr t] -&gt; t -&gt; Expr t
</span><a href="IR.IR.html#Prim"><span class="hs-identifier hs-var">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="#local-6989586621679471067"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr a -&gt; Expr b) -&gt; [Expr a] -&gt; [Expr b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr a -&gt; b) -&gt; Expr a -&gt; Expr b
forall (w :: * -&gt; *) a b. Comonad w =&gt; (w a -&gt; b) -&gt; w a -&gt; w b
</span><span class="hs-identifier hs-var">extend</span></span><span> </span><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471069"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Expr a]
</span><a href="#local-6989586621679471066"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr a -&gt; b
</span><a href="#local-6989586621679471069"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471068"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679471033"><span id="local-6989586621679471035"><span id="local-6989586621679471037"><span id="local-6989586621679471039"><span id="local-6989586621679471041"><span id="local-6989586621679471043"><span id="local-6989586621679471045"><span id="local-6989586621679471047"><span id="local-6989586621679471049"><span id="local-6989586621679471051"><span id="local-6989586621679471053"><span id="local-6989586621679471055"><span id="local-6989586621679471057"><span id="local-6989586621679471059"><span id="local-6989586621679471061"><span id="local-6989586621679471064"><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621679471031"><span class="annot"><span class="annottext">foldMap :: (a -&gt; m) -&gt; Expr a -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">foldMap</span></span></span><span> </span><span id="local-6989586621679471029"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471029"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>  </span><span class="annot"><span class="annottext">VarId
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679471028"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471028"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471029"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471028"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-269"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span id="local-6989586621679471027"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471027"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><span class="annottext">DConId
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679471026"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471026"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471027"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471026"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span id="local-6989586621679471025"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471025"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span>  </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679471024"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471024"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471025"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471024"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span id="local-6989586621679471023"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471023"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621679471022"><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471022"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679471021"><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471021"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679471020"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471020"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; Expr a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471023"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471022"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; Expr a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471023"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471021"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471023"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471020"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span id="local-6989586621679471019"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471019"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679471018"><span class="annot"><span class="annottext">[(Binder, Expr a)]
</span><a href="#local-6989586621679471018"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679471017"><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471017"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679471016"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471016"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><span class="annottext">[m] -&gt; m
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Binder, Expr a) -&gt; m) -&gt; [(Binder, Expr a)] -&gt; [m]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; Expr a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471019"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr a -&gt; m)
-&gt; ((Binder, Expr a) -&gt; Expr a) -&gt; (Binder, Expr a) -&gt; m
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Binder, Expr a) -&gt; Expr a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Binder, Expr a)]
</span><a href="#local-6989586621679471018"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; Expr a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471019"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471017"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471019"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471016"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-274"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span id="local-6989586621679471014"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471014"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span class="annot"><span class="annottext">Binder
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679471013"><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471013"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679471012"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471012"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; Expr a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471014"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471013"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471014"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471012"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-275"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span id="local-6989586621679471011"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471011"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621679471010"><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471010"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679471009"><span class="annot"><span class="annottext">[(Alt, Expr a)]
</span><a href="#local-6989586621679471009"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679471008"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471008"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; Expr a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471011"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Expr a
</span><a href="#local-6989586621679471010"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[m] -&gt; m
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Alt, Expr a) -&gt; m) -&gt; [(Alt, Expr a)] -&gt; [m]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; Expr a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471011"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr a -&gt; m) -&gt; ((Alt, Expr a) -&gt; Expr a) -&gt; (Alt, Expr a) -&gt; m
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Alt, Expr a) -&gt; Expr a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Alt, Expr a)]
</span><a href="#local-6989586621679471009"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471011"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471008"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span id="local-6989586621679471007"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471007"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679471006"><span class="annot"><span class="annottext">[Expr a]
</span><a href="#local-6989586621679471006"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679471005"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471005"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[m] -&gt; m
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr a -&gt; m) -&gt; [Expr a] -&gt; [m]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; Expr a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471007"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Expr a]
</span><a href="#local-6989586621679471006"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679471007"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471005"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">{- | Predicate of whether an expression &quot;looks about right&quot;.

Description left deliberately vague so that we have the flexibility to
strengthen this predicate. For now, we just check that all primitives are
applied to the right number of arguments.

This predicate also provides a template to recursively traverse through all
sub-expressions of an expression.
-}</span><span>
</span><span id="line-288"></span><span id="local-6989586621679471004"><span class="annot"><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-type">wellFormed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471004"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-289"></span><span id="wellFormed"><span class="annot"><span class="annottext">wellFormed :: Expr t -&gt; Bool
</span><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var hs-var">wellFormed</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>  </span><span class="annot"><span class="annottext">VarId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-290"></span><span class="annot"><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="annot"><span class="annottext">DConId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-291"></span><span class="annot"><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span>  </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-292"></span><span class="annot"><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span>    </span><span id="local-6989586621679471003"><span class="annot"><span class="annottext">[(Binder, Expr t)]
</span><a href="#local-6989586621679471003"><span class="hs-identifier hs-var">defs</span></a></span></span><span> </span><span id="local-6989586621679471002"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471002"><span class="hs-identifier hs-var">b</span></a></span></span><span>    </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Binder, Expr t) -&gt; Bool) -&gt; [(Binder, Expr t)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t -&gt; Bool
forall a. Expr a -&gt; Bool
</span><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr t -&gt; Bool)
-&gt; ((Binder, Expr t) -&gt; Expr t) -&gt; (Binder, Expr t) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Binder, Expr t) -&gt; Expr t
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Binder, Expr t)]
</span><a href="#local-6989586621679471003"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Bool
forall a. Expr a -&gt; Bool
</span><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679471002"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-293"></span><span class="annot"><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span class="annot"><span class="annottext">Binder
</span><span class="hs-identifier">_</span></span><span>    </span><span id="local-6989586621679470999"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470999"><span class="hs-identifier hs-var">b</span></a></span></span><span>    </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Bool
forall a. Expr a -&gt; Bool
</span><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470999"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-294"></span><span class="annot"><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#App"><span class="hs-identifier hs-type">App</span></a></span><span>    </span><span id="local-6989586621679470998"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470998"><span class="hs-identifier hs-var">f</span></a></span></span><span>    </span><span id="local-6989586621679470997"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470997"><span class="hs-identifier hs-var">a</span></a></span></span><span>    </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Bool
forall a. Expr a -&gt; Bool
</span><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470998"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Bool
forall a. Expr a -&gt; Bool
</span><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470997"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-295"></span><span class="annot"><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span>  </span><span id="local-6989586621679470996"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470996"><span class="hs-identifier hs-var">s</span></a></span></span><span>    </span><span id="local-6989586621679470995"><span class="annot"><span class="annottext">[(Alt, Expr t)]
</span><a href="#local-6989586621679470995"><span class="hs-identifier hs-var">alts</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Bool
forall a. Expr a -&gt; Bool
</span><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470996"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">((Alt, Expr t) -&gt; Bool) -&gt; [(Alt, Expr t)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t -&gt; Bool
forall a. Expr a -&gt; Bool
</span><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr t -&gt; Bool)
-&gt; ((Alt, Expr t) -&gt; Expr t) -&gt; (Alt, Expr t) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Alt, Expr t) -&gt; Expr t
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Alt, Expr t)]
</span><a href="#local-6989586621679470995"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-296"></span><span class="annot"><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>   </span><span id="local-6989586621679470994"><span class="annot"><span class="annottext">Primitive
</span><a href="#local-6989586621679470994"><span class="hs-identifier hs-var">p</span></a></span></span><span>    </span><span id="local-6989586621679470993"><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679470993"><span class="hs-identifier hs-var">es</span></a></span></span><span>   </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Primitive -&gt; [Expr t] -&gt; Bool
forall a. Primitive -&gt; [a] -&gt; Bool
</span><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="#local-6989586621679470994"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679470993"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Expr t -&gt; Bool) -&gt; [Expr t] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Bool
forall a. Expr a -&gt; Bool
</span><a href="IR.IR.html#wellFormed"><span class="hs-identifier hs-var">wellFormed</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679470993"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-297"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-298"></span><span>  </span><span id="local-6989586621679470992"><span class="annot"><span class="annottext">wfPrim :: Primitive -&gt; [a] -&gt; Bool
</span><a href="#local-6989586621679470992"><span class="hs-identifier hs-var hs-var">wfPrim</span></a></span></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#New"><span class="hs-identifier hs-var">New</span></a></span><span>                  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-299"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Dup"><span class="hs-identifier hs-var">Dup</span></a></span><span>                  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-300"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Drop"><span class="hs-identifier hs-var">Drop</span></a></span><span>                 </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-301"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Deref"><span class="hs-identifier hs-var">Deref</span></a></span><span>                </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Assign"><span class="hs-identifier hs-var">Assign</span></a></span><span>               </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-303"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#After"><span class="hs-identifier hs-var">After</span></a></span><span>                </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-304"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Par"><span class="hs-identifier hs-var">Par</span></a></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-305"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Wait"><span class="hs-identifier hs-var">Wait</span></a></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-306"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Break"><span class="hs-identifier hs-var">Break</span></a></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-307"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Now"><span class="hs-identifier hs-var">Now</span></a></span><span>                  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-308"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#CCall"><span class="hs-identifier hs-type">CCall</span></a></span><span>   </span><span class="annot"><span class="annottext">CSym
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-309"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#FfiCall"><span class="hs-identifier hs-type">FfiCall</span></a></span><span> </span><span class="annot"><span class="annottext">VarId
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-310"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimNeg"><span class="hs-identifier hs-var">PrimNeg</span></a></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-311"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimNot"><span class="hs-identifier hs-var">PrimNot</span></a></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-312"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimBitNot"><span class="hs-identifier hs-var">PrimBitNot</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-313"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimAdd"><span class="hs-identifier hs-var">PrimAdd</span></a></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-314"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimSub"><span class="hs-identifier hs-var">PrimSub</span></a></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-315"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimMul"><span class="hs-identifier hs-var">PrimMul</span></a></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-316"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimDiv"><span class="hs-identifier hs-var">PrimDiv</span></a></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-317"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimMod"><span class="hs-identifier hs-var">PrimMod</span></a></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-318"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimBitAnd"><span class="hs-identifier hs-var">PrimBitAnd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-319"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimBitOr"><span class="hs-identifier hs-var">PrimBitOr</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-320"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimEq"><span class="hs-identifier hs-var">PrimEq</span></a></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimGt"><span class="hs-identifier hs-var">PrimGt</span></a></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimGe"><span class="hs-identifier hs-var">PrimGe</span></a></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-323"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimLt"><span class="hs-identifier hs-var">PrimLt</span></a></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimLe"><span class="hs-identifier hs-var">PrimLe</span></a></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-325"></span><span>  </span><span class="annot"><a href="#local-6989586621679470992"><span class="hs-identifier hs-var">wfPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-comment">{- | Pretty Typeclass: pretty print the IR

Adds 
* indentation and line breaks
* some parens (not minimal parens, but fewer than around every node)
Omits 
* let _ =
* type annotations
Reverts
* curried funcs of one arg back to multiple arg funcs
-}</span><span>
</span><span id="line-338"></span><span id="local-6989586621679470991"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679470988"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621679470991"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeSystem"><span class="hs-identifier hs-type">TypeSystem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679470991"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679470991"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-339"></span><span>  </span><span id="local-6989586621679470986"><span class="annot"><span class="annottext">pretty :: Program t -&gt; Doc ann
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></span></span><span> </span><span class="annot"><a href="IR.IR.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">programDefs :: forall t. Program t -&gt; [(VarId, Expr t)]
</span><a href="IR.IR.html#programDefs"><span class="hs-identifier hs-var">programDefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679470984"><span class="annot"><span class="annottext">[(VarId, Expr t)]
</span><a href="#local-6989586621679470984"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">typeDefs :: forall t. Program t -&gt; [(TConId, TypeDef t)]
</span><a href="IR.IR.html#typeDefs"><span class="hs-identifier hs-var">typeDefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679470983"><span class="annot"><span class="annottext">[(TConId, TypeDef t)]
</span><a href="#local-6989586621679470983"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">externDecls :: forall t. Program t -&gt; [(VarId, t)]
</span><a href="IR.IR.html#externDecls"><span class="hs-identifier hs-var">externDecls</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679470982"><span class="annot"><span class="annottext">[(VarId, t)]
</span><a href="#local-6989586621679470982"><span class="hs-identifier hs-var">xds</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
forall ann. Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
</span><span class="hs-identifier hs-var">punctuate</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann]
forall ann. [Doc ann]
</span><a href="#local-6989586621679470978"><span class="hs-identifier hs-var">tops</span></a></span><span>
</span><span id="line-341"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-342"></span><span>    </span><span id="local-6989586621679470978"><span class="annot"><span class="annottext">tops :: [Doc ann]
</span><a href="#local-6989586621679470978"><span class="hs-identifier hs-var hs-var">tops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-343"></span><span>      </span><span class="annot"><span class="annottext">((TConId, TypeDef t) -&gt; Doc ann)
-&gt; [(TConId, TypeDef t)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(TConId, TypeDef t) -&gt; Doc ann
forall t ann. Pretty t =&gt; (TConId, TypeDef t) -&gt; Doc ann
</span><a href="#local-6989586621679470977"><span class="hs-identifier hs-var">prettyTypDef</span></a></span><span> </span><span class="annot"><span class="annottext">[(TConId, TypeDef t)]
</span><a href="#local-6989586621679470983"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; [Doc ann] -&gt; [Doc ann]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">((VarId, t) -&gt; Doc ann) -&gt; [(VarId, t)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(VarId, t) -&gt; Doc ann
forall t ann. (TypeSystem t, Pretty t) =&gt; (VarId, t) -&gt; Doc ann
</span><a href="#local-6989586621679470976"><span class="hs-identifier hs-var">prettyExternDecl</span></a></span><span> </span><span class="annot"><span class="annottext">[(VarId, t)]
</span><a href="#local-6989586621679470982"><span class="hs-identifier hs-var">xds</span></a></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; [Doc ann] -&gt; [Doc ann]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">((VarId, Expr t) -&gt; Doc ann) -&gt; [(VarId, Expr t)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(VarId, Expr t) -&gt; Doc ann
forall t ann.
(TypeSystem t, Pretty t) =&gt;
(VarId, Expr t) -&gt; Doc ann
</span><a href="#local-6989586621679470975"><span class="hs-identifier hs-var">prettyFuncDef</span></a></span><span> </span><span class="annot"><span class="annottext">[(VarId, Expr t)]
</span><a href="#local-6989586621679470984"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-comment">-- Generates readable Doc representation of an IR Top Level Function</span><span>
</span><span id="line-346"></span><span>    </span><span id="local-6989586621679471614"><span id="local-6989586621679471615"><span class="annot"><a href="#local-6989586621679470975"><span class="hs-identifier hs-type">prettyFuncDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeSystem"><span class="hs-identifier hs-type">TypeSystem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471615"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621679471615"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471615"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679471614"><span class="hs-identifier hs-type">ann</span></a></span></span></span><span>
</span><span id="line-347"></span><span>    </span><span id="local-6989586621679470975"><span class="annot"><span class="annottext">prettyFuncDef :: (VarId, Expr t) -&gt; Doc ann
</span><a href="#local-6989586621679470975"><span class="hs-identifier hs-var hs-var">prettyFuncDef</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679470974"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470974"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470973"><span class="annot"><span class="annottext">l :: Expr t
</span><a href="#local-6989586621679470973"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span class="annot"><span class="annottext">Binder
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679470972"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470972"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-348"></span><span>      </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470974"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="#local-6989586621679470970"><span class="hs-identifier hs-var">typSig</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">indent</span></span><span>
</span><span id="line-349"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-350"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t -&gt; Expr ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470968"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>     </span><span class="hs-keyword">where</span><span>
</span><span id="line-352"></span><span>      </span><span id="local-6989586621679470970"><span class="annot"><span class="annottext">typSig :: Doc ann
</span><a href="#local-6989586621679470970"><span class="hs-identifier hs-var hs-var">typSig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann]
forall ann. [Doc ann]
</span><a href="#local-6989586621679470966"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#rarrow"><span class="hs-identifier hs-var">rarrow</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470964"><span class="hs-identifier hs-var">retTy</span></a></span><span>
</span><span id="line-353"></span><span>      </span><span id="local-6989586621679470966"><span class="annot"><span class="annottext">args :: [Doc ann]
</span><a href="#local-6989586621679470966"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Binder -&gt; t -&gt; Doc ann) -&gt; [Binder] -&gt; [t] -&gt; [Doc ann]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span>
</span><span id="line-354"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679470962"><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679470962"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621679470961"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470961"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Binder -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679470962"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470961"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>        </span><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621679470959"><span class="hs-identifier hs-var">argIds</span></a></span><span>
</span><span id="line-356"></span><span>        </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679470958"><span class="hs-identifier hs-var">argTys</span></a></span><span>
</span><span id="line-357"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679470959"><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621679470959"><span class="hs-identifier hs-var">argIds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470968"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470968"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; ([Binder], Expr t)
forall t. Expr t -&gt; ([Binder], Expr t)
</span><a href="IR.IR.html#collectLambda"><span class="hs-identifier hs-var">collectLambda</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470973"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-358"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679470958"><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679470958"><span class="hs-identifier hs-var">argTys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470964"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470964"><span class="hs-identifier hs-var">retTy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; ([t], t)
forall t. TypeSystem t =&gt; t -&gt; ([t], t)
</span><a href="IR.Types.TypeSystem.html#collectArrow"><span class="hs-identifier hs-var">collectArrow</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470972"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><a href="#local-6989586621679470975"><span class="hs-identifier hs-var">prettyFuncDef</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679470957"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470957"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470956"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470956"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470957"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t -&gt; Expr ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470956"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span>    </span><span id="local-6989586621679471616"><span id="local-6989586621679471617"><span class="annot"><a href="#local-6989586621679470976"><span class="hs-identifier hs-type">prettyExternDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeSystem"><span class="hs-identifier hs-type">TypeSystem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471617"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621679471617"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679471617"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679471616"><span class="hs-identifier hs-type">ann</span></a></span></span></span><span>
</span><span id="line-362"></span><span>    </span><span id="local-6989586621679470976"><span class="annot"><span class="annottext">prettyExternDecl :: (VarId, t) -&gt; Doc ann
</span><a href="#local-6989586621679470976"><span class="hs-identifier hs-var hs-var">prettyExternDecl</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679470955"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470955"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470954"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470954"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-363"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;extern&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470955"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">colon</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470954"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span>    </span><span class="hs-comment">-- Generates readable Doc representation of an IR Type Definition</span><span>
</span><span id="line-366"></span><span>    </span><span id="local-6989586621679471618"><span id="local-6989586621679471619"><span class="annot"><a href="#local-6989586621679470977"><span class="hs-identifier hs-type">prettyTypDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621679471619"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#TConId"><span class="hs-identifier hs-type">TConId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471619"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679471618"><span class="hs-identifier hs-type">ann</span></a></span></span></span><span>
</span><span id="line-367"></span><span>    </span><span id="local-6989586621679470977"><span class="annot"><span class="annottext">prettyTypDef :: (TConId, TypeDef t) -&gt; Doc ann
</span><a href="#local-6989586621679470977"><span class="hs-identifier hs-var hs-var">prettyTypDef</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679470952"><span class="annot"><span class="annottext">TConId
</span><a href="#local-6989586621679470952"><span class="hs-identifier hs-var">tcon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">variants :: forall t. TypeDef t -&gt; [(DConId, TypeVariant t)]
</span><a href="IR.Types.TypeSystem.html#variants"><span class="hs-identifier hs-var">variants</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679470949"><span class="annot"><span class="annottext">[(DConId, TypeVariant t)]
</span><a href="#local-6989586621679470949"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-368"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;type&quot;</span></span><span>
</span><span id="line-369"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">TConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">TConId
</span><a href="#local-6989586621679470952"><span class="hs-identifier hs-var">tcon</span></a></span><span>
</span><span id="line-370"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span>
</span><span id="line-371"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Common.Pretty.html#indentNo"><span class="hs-identifier hs-var">indentNo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((DConId, TypeVariant t) -&gt; Doc ann)
-&gt; [(DConId, TypeVariant t)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(DConId, TypeVariant t) -&gt; Doc ann
forall t ann. Pretty t =&gt; (DConId, TypeVariant t) -&gt; Doc ann
</span><a href="#local-6989586621679470947"><span class="hs-identifier hs-var">prettyDCon</span></a></span><span> </span><span class="annot"><span class="annottext">[(DConId, TypeVariant t)]
</span><a href="#local-6989586621679470949"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>  </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span>
</span><span id="line-373"></span><span>    </span><span id="local-6989586621679471593"><span id="local-6989586621679471594"><span class="annot"><a href="#local-6989586621679470947"><span class="hs-identifier hs-type">prettyDCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621679471594"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#DConId"><span class="hs-identifier hs-type">DConId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeVariant"><span class="hs-identifier hs-type">TypeVariant</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471594"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679471593"><span class="hs-identifier hs-type">ann</span></a></span></span></span><span>
</span><span id="line-374"></span><span>    </span><span id="local-6989586621679470947"><span class="annot"><span class="annottext">prettyDCon :: (DConId, TypeVariant t) -&gt; Doc ann
</span><a href="#local-6989586621679470947"><span class="hs-identifier hs-var hs-var">prettyDCon</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679470946"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679470946"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#VariantNamed"><span class="hs-identifier hs-type">VariantNamed</span></a></span><span> </span><span id="local-6989586621679470944"><span class="annot"><span class="annottext">[(VarId, t)]
</span><a href="#local-6989586621679470944"><span class="hs-identifier hs-var">argz</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-375"></span><span>      </span><span class="annot"><span class="annottext">DConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679470946"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(t -&gt; Doc ann) -&gt; ((VarId, t) -&gt; t) -&gt; (VarId, t) -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VarId, t) -&gt; t
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((VarId, t) -&gt; Doc ann) -&gt; [(VarId, t)] -&gt; [Doc ann]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(VarId, t)]
</span><a href="#local-6989586621679470944"><span class="hs-identifier hs-var">argz</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>    </span><span class="annot"><a href="#local-6989586621679470947"><span class="hs-identifier hs-var">prettyDCon</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679470943"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679470943"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#VariantUnnamed"><span class="hs-identifier hs-type">VariantUnnamed</span></a></span><span> </span><span id="local-6989586621679470941"><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679470941"><span class="hs-identifier hs-var">argz</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-377"></span><span>      </span><span class="annot"><span class="annottext">DConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679470943"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(t -&gt; Doc ann) -&gt; [t] -&gt; [Doc ann]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679470941"><span class="hs-identifier hs-var">argz</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="hs-comment">-- | Pretty prints IR Expr nodes without type annotations</span><span>
</span><span id="line-381"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679470938"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-382"></span><span>  </span><span id="local-6989586621679470937"><span class="annot"><span class="annottext">pretty :: Expr () -&gt; Doc ann
</span><a href="#local-6989586621679470937"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span id="local-6989586621679470936"><span class="annot"><span class="annottext">a :: Expr ()
</span><a href="#local-6989586621679470936"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="IR.IR.html#App"><span class="hs-identifier hs-type">App</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470935"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall ann. Expr () -&gt; Doc ann
</span><a href="#local-6989586621679470934"><span class="hs-identifier hs-var">parenz</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr () -&gt; Doc ann)
-&gt; ((Expr (), ()) -&gt; Expr ()) -&gt; (Expr (), ()) -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Expr (), ()) -&gt; Expr ()
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Expr (), ()) -&gt; Doc ann) -&gt; [(Expr (), ())] -&gt; [Doc ann]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Expr (), ())]
</span><a href="#local-6989586621679470933"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679470935"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470935"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470933"><span class="annot"><span class="annottext">[(Expr (), ())]
</span><a href="#local-6989586621679470933"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; (Expr (), [(Expr (), ())])
forall t. Expr t -&gt; (Expr t, [(Expr t, t)])
</span><a href="IR.IR.html#unzipApp"><span class="hs-identifier hs-var">unzipApp</span></a></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470936"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-comment">-- insert (usually) necessary parens</span><span>
</span><span id="line-386"></span><span>    </span><span id="local-6989586621679470932"><span class="annot"><a href="#local-6989586621679470934"><span class="hs-identifier hs-type">parenz</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679470932"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-387"></span><span>    </span><span id="local-6989586621679470934"><span class="annot"><span class="annottext">parenz :: Expr () -&gt; Doc ann
</span><a href="#local-6989586621679470934"><span class="hs-identifier hs-var hs-var">parenz</span></a></span></span><span> </span><span id="local-6989586621679470931"><span class="annot"><span class="annottext">v :: Expr ()
</span><a href="#local-6989586621679470931"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><span class="annottext">VarId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470931"><span class="hs-identifier hs-var">v</span></a></span><span>  </span><span class="hs-comment">-- variables</span><span>
</span><span id="line-388"></span><span>    </span><span class="annot"><a href="#local-6989586621679470934"><span class="hs-identifier hs-var">parenz</span></a></span><span> </span><span id="local-6989586621679470930"><span class="annot"><span class="annottext">l :: Expr ()
</span><a href="#local-6989586621679470930"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470930"><span class="hs-identifier hs-var">l</span></a></span><span>  </span><span class="hs-comment">-- literals</span><span>
</span><span id="line-389"></span><span>    </span><span class="annot"><a href="#local-6989586621679470934"><span class="hs-identifier hs-var">parenz</span></a></span><span> </span><span id="local-6989586621679470929"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470929"><span class="hs-identifier hs-var">e</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470929"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>    </span><span class="hs-comment">-- TODO: minimum parens algo</span><span>
</span><span id="line-391"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Wait"><span class="hs-identifier hs-var">Wait</span></a></span><span> </span><span id="local-6989586621679470928"><span class="annot"><span class="annottext">[Expr ()]
</span><a href="#local-6989586621679470928"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wait&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr () -&gt; Doc ann) -&gt; [Expr ()] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">[Expr ()]
</span><a href="#local-6989586621679470928"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621679470927"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470927"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470927"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-393"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span id="local-6989586621679470926"><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679470926"><span class="hs-identifier hs-var">a</span></a></span></span><span>              </span><span id="local-6989586621679470925"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470925"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fun&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Binder -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679470926"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470925"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-394"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Binder
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470924"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470924"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679470923"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470923"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470924"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470923"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-395"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span>    </span><span id="local-6989586621679470922"><span class="annot"><span class="annottext">[(Binder, Expr ())]
</span><a href="#local-6989586621679470922"><span class="hs-keyword hs-var">as</span></a></span></span><span>             </span><span id="local-6989586621679470921"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470921"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="#local-6989586621679470920"><span class="hs-identifier hs-var">letexpr</span></a></span><span>
</span><span id="line-396"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-397"></span><span>    </span><span id="local-6989586621679470920"><span class="annot"><span class="annottext">letexpr :: Doc ann
</span><a href="#local-6989586621679470920"><span class="hs-identifier hs-var hs-var">letexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;let&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Binder, Expr ()) -&gt; Doc ann) -&gt; [(Binder, Expr ())] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Binder, Expr ()) -&gt; Doc ann
forall a a ann. (Pretty a, Pretty a) =&gt; (Maybe a, a) -&gt; Doc ann
</span><a href="#local-6989586621679470919"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">[(Binder, Expr ())]
</span><a href="#local-6989586621679470922"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470921"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-398"></span><span>    </span><span id="local-6989586621679470919"><span class="annot"><span class="annottext">def :: (Maybe a, a) -&gt; Doc ann
</span><a href="#local-6989586621679470919"><span class="hs-identifier hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679470918"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679470918"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470917"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679470917"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679470918"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">equals</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">align</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679470917"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>    </span><span class="annot"><a href="#local-6989586621679470919"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470914"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679470914"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">equals</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">align</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679470914"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#After"><span class="hs-identifier hs-var">After</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679470913"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470913"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470912"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470912"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470911"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470911"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="#local-6989586621679470910"><span class="hs-identifier hs-var">ae</span></a></span><span>
</span><span id="line-401"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-402"></span><span>    </span><span id="local-6989586621679470910"><span class="annot"><span class="annottext">ae :: Doc ann
</span><a href="#local-6989586621679470910"><span class="hs-identifier hs-var hs-var">ae</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-403"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;after&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470913"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">comma</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470912"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#larrow"><span class="hs-identifier hs-var">larrow</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470911"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-404"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span>  </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Assign"><span class="hs-identifier hs-var">Assign</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679470907"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470907"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470906"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470906"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470907"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#larrow"><span class="hs-identifier hs-var">larrow</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470906"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-405"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621679470905"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470905"><span class="hs-identifier hs-var">s</span></a></span></span><span>      </span><span id="local-6989586621679470904"><span class="annot"><span class="annottext">[(Alt, Expr ())]
</span><a href="#local-6989586621679470904"><span class="hs-keyword hs-var">as</span></a></span></span><span>     </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;match&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470905"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="#local-6989586621679470903"><span class="hs-identifier hs-var">arms</span></a></span><span>
</span><span id="line-406"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-407"></span><span>    </span><span id="local-6989586621679470903"><span class="annot"><span class="annottext">arms :: Doc ann
</span><a href="#local-6989586621679470903"><span class="hs-identifier hs-var hs-var">arms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Alt, Expr ()) -&gt; Doc ann) -&gt; [(Alt, Expr ())] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Common.Pretty.html#indentNo"><span class="hs-identifier hs-var">indentNo</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann)
-&gt; ((Alt, Expr ()) -&gt; Doc ann) -&gt; (Alt, Expr ()) -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Alt, Expr ()) -&gt; Doc ann
forall ann. (Alt, Expr ()) -&gt; Doc ann
</span><a href="#local-6989586621679470902"><span class="hs-identifier hs-var">arm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Alt, Expr ())]
</span><a href="#local-6989586621679470904"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>    </span><span id="local-6989586621679471579"><span class="annot"><a href="#local-6989586621679470902"><span class="hs-identifier hs-type">arm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679471579"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-409"></span><span>    </span><span id="local-6989586621679470902"><span class="annot"><span class="annottext">arm :: (Alt, Expr ()) -&gt; Doc ann
</span><a href="#local-6989586621679470902"><span class="hs-identifier hs-var hs-var">arm</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679470901"><span class="annot"><span class="annottext">Alt
</span><a href="#local-6989586621679470901"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470900"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470900"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Alt -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Alt
</span><a href="#local-6989586621679470901"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">equals</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">align</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470900"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Loop"><span class="hs-identifier hs-var">Loop</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679470899"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470899"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-411"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;loop&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Common.Pretty.html#indentNo"><span class="hs-identifier hs-var">indentNo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470899"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span id="local-6989586621679470898"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621679470898"><span class="hs-identifier hs-var">po</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679470897"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470897"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470896"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470896"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470897"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621679470898"><span class="hs-identifier hs-var">po</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470896"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-413"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span id="local-6989586621679470895"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679470895"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679470895"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-414"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span>  </span><span id="local-6989586621679470894"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679470894"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679470894"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-415"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#New"><span class="hs-identifier hs-var">New</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679470893"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470893"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;new&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470893"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-416"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Dup"><span class="hs-identifier hs-var">Dup</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679470892"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470892"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;__dup&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470892"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Drop"><span class="hs-identifier hs-var">Drop</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679470891"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470891"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470890"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470890"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-418"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;__drop&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470891"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470890"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-419"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Deref"><span class="hs-identifier hs-var">Deref</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679470889"><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470889"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;deref&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Expr ()
</span><a href="#local-6989586621679470889"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Par"><span class="hs-identifier hs-var">Par</span></a></span><span>   </span><span id="local-6989586621679470888"><span class="annot"><span class="annottext">[Expr ()]
</span><a href="#local-6989586621679470888"><span class="hs-identifier hs-var">es</span></a></span></span><span>  </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;par&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; Doc ann
forall ann. Doc ann -&gt; [Doc ann] -&gt; Doc ann
</span><a href="Common.Pretty.html#block"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#dbar"><span class="hs-identifier hs-var">dbar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr () -&gt; Doc ann) -&gt; [Expr ()] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">[Expr ()]
</span><a href="#local-6989586621679470888"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Break"><span class="hs-identifier hs-var">Break</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;break&quot;</span></span><span>
</span><span id="line-422"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#CCall"><span class="hs-identifier hs-type">CCall</span></a></span><span> </span><span id="local-6989586621679470885"><span class="annot"><span class="annottext">CSym
</span><a href="#local-6989586621679470885"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679470884"><span class="annot"><span class="annottext">[Expr ()]
</span><a href="#local-6989586621679470884"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-423"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">CSym -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">CSym
</span><a href="#local-6989586621679470885"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
forall ann. Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
</span><span class="hs-identifier hs-var">punctuate</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">comma</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; [Doc ann]) -&gt; [Doc ann] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Expr () -&gt; Doc ann) -&gt; [Expr ()] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">[Expr ()]
</span><a href="#local-6989586621679470884"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#FfiCall"><span class="hs-identifier hs-type">FfiCall</span></a></span><span> </span><span id="local-6989586621679470883"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470883"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679470882"><span class="annot"><span class="annottext">[Expr ()]
</span><a href="#local-6989586621679470882"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470883"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr () -&gt; Doc ann) -&gt; [Expr ()] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; (Expr () -&gt; Doc ann) -&gt; Expr () -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Expr () -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Expr ()]
</span><a href="#local-6989586621679470882"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#CQuote"><span class="hs-identifier hs-type">CQuote</span></a></span><span> </span><span id="local-6989586621679470881"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679470881"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$$&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679470881"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$$&quot;</span></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-comment">-- pretty (Prim Return [e] _        ) = pretty &quot;return&quot; &lt;+&gt; braces (pretty e)</span><span>
</span><span id="line-428"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span id="local-6989586621679470880"><span class="annot"><span class="annottext">Primitive
</span><a href="#local-6989586621679470880"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Expr ()]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Doc ann
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Primitive expression not well-formed: &quot;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc ann) -&gt; String -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Primitive -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="#local-6989586621679470880"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679470875"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="IR.IR.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-431"></span><span>  </span><span id="local-6989586621679470874"><span class="annot"><span class="annottext">pretty :: Alt -&gt; Doc ann
</span><a href="#local-6989586621679470874"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltData"><span class="hs-identifier hs-type">AltData</span></a></span><span> </span><span id="local-6989586621679470873"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679470873"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679470872"><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621679470872"><span class="hs-identifier hs-var">b</span></a></span></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679470873"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Binder -&gt; Doc ann) -&gt; [Binder] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Binder -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621679470872"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltLit"><span class="hs-identifier hs-type">AltLit</span></a></span><span>     </span><span id="local-6989586621679470871"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679470871"><span class="hs-identifier hs-var">a</span></a></span></span><span>       </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679470871"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-433"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltDefault"><span class="hs-identifier hs-type">AltDefault</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679470870"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470870"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470870"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-434"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltDefault"><span class="hs-identifier hs-type">AltDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Binder
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679470867"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="IR.IR.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-437"></span><span>  </span><span id="local-6989586621679470866"><span class="annot"><span class="annottext">pretty :: Literal -&gt; Doc ann
</span><a href="#local-6989586621679470866"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#LitIntegral"><span class="hs-identifier hs-type">LitIntegral</span></a></span><span> </span><span id="local-6989586621679470865"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679470865"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc ann) -&gt; String -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679470865"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-438"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#LitBool"><span class="hs-identifier hs-type">LitBool</span></a></span><span>     </span><span id="local-6989586621679470864"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679470864"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc ann) -&gt; String -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679470864"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-439"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="IR.IR.html#LitEvent"><span class="hs-identifier hs-var">LitEvent</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;()&quot;</span></span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679470861"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-442"></span><span>  </span><span id="local-6989586621679470860"><span class="annot"><span class="annottext">pretty :: PrimOp -&gt; Doc ann
</span><a href="#local-6989586621679470860"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimNeg"><span class="hs-identifier hs-var">PrimNeg</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span>
</span><span id="line-443"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimNot"><span class="hs-identifier hs-var">PrimNot</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!&quot;</span></span><span>
</span><span id="line-444"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimBitNot"><span class="hs-identifier hs-var">PrimBitNot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;~&quot;</span></span><span>
</span><span id="line-445"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimAdd"><span class="hs-identifier hs-var">PrimAdd</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+&quot;</span></span><span>
</span><span id="line-446"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimSub"><span class="hs-identifier hs-var">PrimSub</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span>
</span><span id="line-447"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimMul"><span class="hs-identifier hs-var">PrimMul</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*&quot;</span></span><span>
</span><span id="line-448"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimDiv"><span class="hs-identifier hs-var">PrimDiv</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span>
</span><span id="line-449"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimMod"><span class="hs-identifier hs-var">PrimMod</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%&quot;</span></span><span>
</span><span id="line-450"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimBitAnd"><span class="hs-identifier hs-var">PrimBitAnd</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&amp;&quot;</span></span><span>
</span><span id="line-451"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimBitOr"><span class="hs-identifier hs-var">PrimBitOr</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;|&quot;</span></span><span>
</span><span id="line-452"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimEq"><span class="hs-identifier hs-var">PrimEq</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;==&quot;</span></span><span>
</span><span id="line-453"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimNeq"><span class="hs-identifier hs-var">PrimNeq</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!=&quot;</span></span><span>
</span><span id="line-454"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimGt"><span class="hs-identifier hs-var">PrimGt</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span>
</span><span id="line-455"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimGe"><span class="hs-identifier hs-var">PrimGe</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;=&quot;</span></span><span>
</span><span id="line-456"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimLt"><span class="hs-identifier hs-var">PrimLt</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;&quot;</span></span><span>
</span><span id="line-457"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimLe"><span class="hs-identifier hs-var">PrimLe</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;=&quot;</span></span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="hs-comment">-- | Dumpy Typeclass: generate comprehensive Doc representation of the IR</span><span>
</span><span id="line-460"></span><span id="local-6989586621679470859"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679470859"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeSystem"><span class="hs-identifier hs-type">TypeSystem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679470859"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679470859"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-461"></span><span>  </span><span id="local-6989586621679470856"><span class="annot"><span class="annottext">dumpy :: Program t -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var hs-var hs-var hs-var">dumpy</span></a></span></span><span> </span><span class="annot"><a href="IR.IR.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">programDefs :: forall t. Program t -&gt; [(VarId, Expr t)]
</span><a href="IR.IR.html#programDefs"><span class="hs-identifier hs-var">programDefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679470854"><span class="annot"><span class="annottext">[(VarId, Expr t)]
</span><a href="#local-6989586621679470854"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">typeDefs :: forall t. Program t -&gt; [(TConId, TypeDef t)]
</span><a href="IR.IR.html#typeDefs"><span class="hs-identifier hs-var">typeDefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679470853"><span class="annot"><span class="annottext">[(TConId, TypeDef t)]
</span><a href="#local-6989586621679470853"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">externDecls :: forall t. Program t -&gt; [(VarId, t)]
</span><a href="IR.IR.html#externDecls"><span class="hs-identifier hs-var">externDecls</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679470852"><span class="annot"><span class="annottext">[(VarId, t)]
</span><a href="#local-6989586621679470852"><span class="hs-identifier hs-var">xds</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-462"></span><span>    </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
forall ann. Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
</span><span class="hs-identifier hs-var">punctuate</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann]
forall ann. [Doc ann]
</span><a href="#local-6989586621679470851"><span class="hs-identifier hs-var">tops</span></a></span><span>
</span><span id="line-463"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-464"></span><span>    </span><span id="local-6989586621679470851"><span class="annot"><span class="annottext">tops :: [Doc ann]
</span><a href="#local-6989586621679470851"><span class="hs-identifier hs-var hs-var">tops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-465"></span><span>      </span><span class="annot"><span class="annottext">((TConId, TypeDef t) -&gt; Doc ann)
-&gt; [(TConId, TypeDef t)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(TConId, TypeDef t) -&gt; Doc ann
forall t ann. Dumpy t =&gt; (TConId, TypeDef t) -&gt; Doc ann
</span><a href="#local-6989586621679470850"><span class="hs-identifier hs-var">dumpyTypDef</span></a></span><span> </span><span class="annot"><span class="annottext">[(TConId, TypeDef t)]
</span><a href="#local-6989586621679470853"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; [Doc ann] -&gt; [Doc ann]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">((VarId, t) -&gt; Doc ann) -&gt; [(VarId, t)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(VarId, t) -&gt; Doc ann
forall t ann. Dumpy t =&gt; (VarId, t) -&gt; Doc ann
</span><a href="#local-6989586621679470849"><span class="hs-identifier hs-var">dumpyExternDecl</span></a></span><span> </span><span class="annot"><span class="annottext">[(VarId, t)]
</span><a href="#local-6989586621679470852"><span class="hs-identifier hs-var">xds</span></a></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; [Doc ann] -&gt; [Doc ann]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">((VarId, Expr t) -&gt; Doc ann) -&gt; [(VarId, Expr t)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(VarId, Expr t) -&gt; Doc ann
forall t ann. (TypeSystem t, Dumpy t) =&gt; (VarId, Expr t) -&gt; Doc ann
</span><a href="#local-6989586621679470848"><span class="hs-identifier hs-var">dumpyFuncDef</span></a></span><span> </span><span class="annot"><span class="annottext">[(VarId, Expr t)]
</span><a href="#local-6989586621679470854"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span>    </span><span class="hs-comment">-- Generates readable Doc representation of an IR Top Level Function</span><span>
</span><span id="line-468"></span><span>    </span><span id="local-6989586621679471556"><span id="local-6989586621679471557"><span class="annot"><a href="#local-6989586621679470848"><span class="hs-identifier hs-type">dumpyFuncDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeSystem"><span class="hs-identifier hs-type">TypeSystem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471557"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471557"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471557"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679471556"><span class="hs-identifier hs-type">ann</span></a></span></span></span><span>
</span><span id="line-469"></span><span>    </span><span id="local-6989586621679470848"><span class="annot"><span class="annottext">dumpyFuncDef :: (VarId, Expr t) -&gt; Doc ann
</span><a href="#local-6989586621679470848"><span class="hs-identifier hs-var hs-var">dumpyFuncDef</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679470847"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470847"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470846"><span class="annot"><span class="annottext">l :: Expr t
</span><a href="#local-6989586621679470846"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span class="annot"><span class="annottext">Binder
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679470845"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470845"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-470"></span><span>      </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470847"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="#local-6989586621679470844"><span class="hs-identifier hs-var">typSig</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470843"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>     </span><span class="hs-keyword">where</span><span>
</span><span id="line-472"></span><span>      </span><span id="local-6989586621679470844"><span class="annot"><span class="annottext">typSig :: Doc ann
</span><a href="#local-6989586621679470844"><span class="hs-identifier hs-var hs-var">typSig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann]
forall ann. [Doc ann]
</span><a href="#local-6989586621679470842"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#rarrow"><span class="hs-identifier hs-var">rarrow</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470841"><span class="hs-identifier hs-var">retTy</span></a></span><span>
</span><span id="line-473"></span><span>      </span><span id="local-6989586621679470842"><span class="annot"><span class="annottext">args :: [Doc ann]
</span><a href="#local-6989586621679470842"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Binder -&gt; t -&gt; Doc ann) -&gt; [Binder] -&gt; [t] -&gt; [Doc ann]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span>
</span><span id="line-474"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679470840"><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679470840"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621679470839"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470839"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Binder -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679470840"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470839"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>        </span><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621679470838"><span class="hs-identifier hs-var">argIds</span></a></span><span>
</span><span id="line-476"></span><span>        </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679470837"><span class="hs-identifier hs-var">argTys</span></a></span><span>
</span><span id="line-477"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679470838"><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621679470838"><span class="hs-identifier hs-var">argIds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470843"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470843"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; ([Binder], Expr t)
forall t. Expr t -&gt; ([Binder], Expr t)
</span><a href="IR.IR.html#collectLambda"><span class="hs-identifier hs-var">collectLambda</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470846"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-478"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679470837"><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679470837"><span class="hs-identifier hs-var">argTys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470841"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470841"><span class="hs-identifier hs-var">retTy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; ([t], t)
forall t. TypeSystem t =&gt; t -&gt; ([t], t)
</span><a href="IR.Types.TypeSystem.html#collectArrow"><span class="hs-identifier hs-var">collectArrow</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470845"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-479"></span><span>    </span><span class="annot"><a href="#local-6989586621679470848"><span class="hs-identifier hs-var">dumpyFuncDef</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679470836"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470836"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470835"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470835"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470836"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470835"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span>    </span><span class="hs-comment">-- Generates readable Doc representation of an IR Type Definition</span><span>
</span><span id="line-482"></span><span>    </span><span id="local-6989586621679471558"><span id="local-6989586621679471559"><span class="annot"><a href="#local-6989586621679470849"><span class="hs-identifier hs-type">dumpyExternDecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471559"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679471559"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679471558"><span class="hs-identifier hs-type">ann</span></a></span></span></span><span>
</span><span id="line-483"></span><span>    </span><span id="local-6989586621679470849"><span class="annot"><span class="annottext">dumpyExternDecl :: (VarId, t) -&gt; Doc ann
</span><a href="#local-6989586621679470849"><span class="hs-identifier hs-var hs-var">dumpyExternDecl</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679470834"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470834"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470833"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470833"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;extern&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470834"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">colon</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470833"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span>    </span><span class="hs-comment">-- Generates readable Doc representation of an IR Type Definition</span><span>
</span><span id="line-486"></span><span>    </span><span id="local-6989586621679471560"><span id="local-6989586621679471561"><span class="annot"><a href="#local-6989586621679470850"><span class="hs-identifier hs-type">dumpyTypDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471561"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#TConId"><span class="hs-identifier hs-type">TConId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471561"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679471560"><span class="hs-identifier hs-type">ann</span></a></span></span></span><span>
</span><span id="line-487"></span><span>    </span><span id="local-6989586621679470850"><span class="annot"><span class="annottext">dumpyTypDef :: (TConId, TypeDef t) -&gt; Doc ann
</span><a href="#local-6989586621679470850"><span class="hs-identifier hs-var hs-var">dumpyTypDef</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679470832"><span class="annot"><span class="annottext">TConId
</span><a href="#local-6989586621679470832"><span class="hs-identifier hs-var">tcon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">variants :: forall t. TypeDef t -&gt; [(DConId, TypeVariant t)]
</span><a href="IR.Types.TypeSystem.html#variants"><span class="hs-identifier hs-var">variants</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679470831"><span class="annot"><span class="annottext">[(DConId, TypeVariant t)]
</span><a href="#local-6989586621679470831"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-488"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;type&quot;</span></span><span>
</span><span id="line-489"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">TConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">TConId
</span><a href="#local-6989586621679470832"><span class="hs-identifier hs-var">tcon</span></a></span><span>
</span><span id="line-490"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span>
</span><span id="line-491"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Common.Pretty.html#indentNo"><span class="hs-identifier hs-var">indentNo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((DConId, TypeVariant t) -&gt; Doc ann)
-&gt; [(DConId, TypeVariant t)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(DConId, TypeVariant t) -&gt; Doc ann
forall t ann. Dumpy t =&gt; (DConId, TypeVariant t) -&gt; Doc ann
</span><a href="#local-6989586621679470830"><span class="hs-identifier hs-var">dumpyDCon</span></a></span><span> </span><span class="annot"><span class="annottext">[(DConId, TypeVariant t)]
</span><a href="#local-6989586621679470831"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>  </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">line</span></span><span>
</span><span id="line-493"></span><span>    </span><span id="local-6989586621679471546"><span id="local-6989586621679471547"><span class="annot"><a href="#local-6989586621679470830"><span class="hs-identifier hs-type">dumpyDCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471547"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#DConId"><span class="hs-identifier hs-type">DConId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeVariant"><span class="hs-identifier hs-type">TypeVariant</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471547"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679471546"><span class="hs-identifier hs-type">ann</span></a></span></span></span><span>
</span><span id="line-494"></span><span>    </span><span id="local-6989586621679470830"><span class="annot"><span class="annottext">dumpyDCon :: (DConId, TypeVariant t) -&gt; Doc ann
</span><a href="#local-6989586621679470830"><span class="hs-identifier hs-var hs-var">dumpyDCon</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679470829"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679470829"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#VariantNamed"><span class="hs-identifier hs-type">VariantNamed</span></a></span><span> </span><span id="local-6989586621679470828"><span class="annot"><span class="annottext">[(VarId, t)]
</span><a href="#local-6989586621679470828"><span class="hs-identifier hs-var">argz</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-495"></span><span>      </span><span class="annot"><span class="annottext">DConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679470829"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">(t -&gt; Doc ann) -&gt; ((VarId, t) -&gt; t) -&gt; (VarId, t) -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VarId, t) -&gt; t
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((VarId, t) -&gt; Doc ann) -&gt; [(VarId, t)] -&gt; [Doc ann]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(VarId, t)]
</span><a href="#local-6989586621679470828"><span class="hs-identifier hs-var">argz</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>    </span><span class="annot"><a href="#local-6989586621679470830"><span class="hs-identifier hs-var">dumpyDCon</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679470827"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679470827"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#VariantUnnamed"><span class="hs-identifier hs-type">VariantUnnamed</span></a></span><span> </span><span id="local-6989586621679470826"><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679470826"><span class="hs-identifier hs-var">argz</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-497"></span><span>      </span><span class="annot"><span class="annottext">DConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679470827"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">(t -&gt; Doc ann) -&gt; [t] -&gt; [Doc ann]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679470826"><span class="hs-identifier hs-var">argz</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-498"></span><span>  </span><span class="hs-comment">-- TODO: how to represent entry point?</span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span id="local-6989586621679470825"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679470825"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679470825"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-501"></span><span>  </span><span id="local-6989586621679470823"><span class="annot"><span class="annottext">dumpy :: Expr t -&gt; Doc ann
</span><a href="#local-6989586621679470823"><span class="hs-identifier hs-var hs-var hs-var hs-var">dumpy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>  </span><span id="local-6989586621679470822"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470822"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679470821"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470821"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470821"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470822"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-502"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span id="local-6989586621679470819"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679470819"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679470818"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470818"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470818"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679470819"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-503"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span>  </span><span id="local-6989586621679470817"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679470817"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679470816"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470816"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470816"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679470817"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-504"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621679470815"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470815"><span class="hs-identifier hs-var">l</span></a></span></span><span>  </span><span id="local-6989586621679470814"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470814"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679470813"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470813"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470813"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470815"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470814"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-505"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621679470812"><span class="annot"><span class="annottext">[(Binder, Expr t)]
</span><a href="#local-6989586621679470812"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679470811"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470811"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679470810"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470810"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470810"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="#local-6989586621679470809"><span class="hs-identifier hs-var">letexpr</span></a></span><span>
</span><span id="line-506"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-507"></span><span>    </span><span id="local-6989586621679470809"><span class="annot"><span class="annottext">letexpr :: Doc ann
</span><a href="#local-6989586621679470809"><span class="hs-identifier hs-var hs-var">letexpr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;let&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; Doc ann
forall ann. Doc ann -&gt; [Doc ann] -&gt; Doc ann
</span><a href="Common.Pretty.html#block"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#dbar"><span class="hs-identifier hs-var">dbar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Binder, Expr t) -&gt; Doc ann) -&gt; [(Binder, Expr t)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Binder, Expr t) -&gt; Doc ann
forall a a ann. (Pretty a, Dumpy a) =&gt; (Maybe a, a) -&gt; Doc ann
</span><a href="#local-6989586621679470808"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">[(Binder, Expr t)]
</span><a href="#local-6989586621679470812"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">semi</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470811"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-508"></span><span>    </span><span id="local-6989586621679470808"><span class="annot"><span class="annottext">def :: (Maybe a, a) -&gt; Doc ann
</span><a href="#local-6989586621679470808"><span class="hs-identifier hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679470806"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679470806"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470805"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679470805"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679470806"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">equals</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">braces</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679470805"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>    </span><span class="annot"><a href="#local-6989586621679470808"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470803"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679470803"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">equals</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">braces</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679470803"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span id="local-6989586621679470802"><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679470802"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679470801"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470801"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679470800"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470800"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-511"></span><span>    </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470800"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fun&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Binder -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Binder
</span><a href="#local-6989586621679470802"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">braces</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470801"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621679470799"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470799"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679470798"><span class="annot"><span class="annottext">[(Alt, Expr t)]
</span><a href="#local-6989586621679470798"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679470797"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470797"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470797"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;match&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470799"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="#local-6989586621679470796"><span class="hs-identifier hs-var">arms</span></a></span><span>
</span><span id="line-513"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-514"></span><span>    </span><span class="hs-comment">-- Where to add binder?</span><span>
</span><span id="line-515"></span><span>    </span><span id="local-6989586621679470796"><span class="annot"><span class="annottext">arms :: Doc ann
</span><a href="#local-6989586621679470796"><span class="hs-identifier hs-var hs-var">arms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; Doc ann
forall ann. Doc ann -&gt; [Doc ann] -&gt; Doc ann
</span><a href="Common.Pretty.html#block"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#bar"><span class="hs-identifier hs-var">bar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Alt, Expr t) -&gt; Doc ann) -&gt; [(Alt, Expr t)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Alt, Expr t) -&gt; Doc ann
forall a a ann. (Dumpy a, Dumpy a) =&gt; (a, a) -&gt; Doc ann
</span><a href="#local-6989586621679470794"><span class="hs-identifier hs-var">arm</span></a></span><span> </span><span class="annot"><span class="annottext">[(Alt, Expr t)]
</span><a href="#local-6989586621679470798"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>    </span><span id="local-6989586621679470794"><span class="annot"><span class="annottext">arm :: (a, a) -&gt; Doc ann
</span><a href="#local-6989586621679470794"><span class="hs-identifier hs-var hs-var">arm</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679470793"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679470793"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470792"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679470792"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679470793"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">braces</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679470792"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#New"><span class="hs-identifier hs-var">New</span></a></span><span>   </span><span class="hs-special">[</span><span id="local-6989586621679470791"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470791"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679470790"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470790"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470790"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;new&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470791"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-518"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Dup"><span class="hs-identifier hs-var">Dup</span></a></span><span>   </span><span class="hs-special">[</span><span id="local-6989586621679470789"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470789"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679470788"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470788"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470788"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;__dup&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470789"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-519"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Drop"><span class="hs-identifier hs-var">Drop</span></a></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679470787"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470787"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470786"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470786"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679470785"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470785"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470785"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;__drop&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470787"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470786"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Deref"><span class="hs-identifier hs-var">Deref</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679470784"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470784"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679470783"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470783"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470783"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;deref&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470784"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-521"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Assign"><span class="hs-identifier hs-var">Assign</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679470782"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470782"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470781"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470781"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679470780"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470780"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-522"></span><span>    </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470780"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470782"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#larrow"><span class="hs-identifier hs-var">larrow</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">braces</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470781"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-523"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#After"><span class="hs-identifier hs-var">After</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679470779"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470779"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470778"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470778"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470777"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470777"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679470776"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470776"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470776"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="#local-6989586621679470775"><span class="hs-identifier hs-var">ae</span></a></span><span>
</span><span id="line-524"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-525"></span><span>    </span><span id="local-6989586621679470775"><span class="annot"><span class="annottext">ae :: Doc ann
</span><a href="#local-6989586621679470775"><span class="hs-identifier hs-var hs-var">ae</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;after&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470779"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">comma</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470778"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#larrow"><span class="hs-identifier hs-var">larrow</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">braces</span></span><span>
</span><span id="line-526"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470777"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Par"><span class="hs-identifier hs-var">Par</span></a></span><span> </span><span id="local-6989586621679470774"><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679470774"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679470773"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470773"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-528"></span><span>    </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470773"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;par&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; Doc ann
forall ann. Doc ann -&gt; [Doc ann] -&gt; Doc ann
</span><a href="Common.Pretty.html#block"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#dbar"><span class="hs-identifier hs-var">dbar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr t -&gt; Doc ann) -&gt; [Expr t] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679470774"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Wait"><span class="hs-identifier hs-var">Wait</span></a></span><span> </span><span id="local-6989586621679470772"><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679470772"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621679470771"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470771"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-530"></span><span>    </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470771"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wait&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; Doc ann
forall ann. Doc ann -&gt; [Doc ann] -&gt; Doc ann
</span><a href="Common.Pretty.html#block"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#dbar"><span class="hs-identifier hs-var">dbar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr t -&gt; Doc ann) -&gt; [Expr t] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679470772"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Loop"><span class="hs-identifier hs-var">Loop</span></a></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621679470770"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470770"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679470769"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470769"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470769"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;loop&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">braces</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470770"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="IR.IR.html#Break"><span class="hs-identifier hs-var">Break</span></a></span><span>     </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span id="local-6989586621679470768"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470768"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470768"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;break&quot;</span></span><span>
</span><span id="line-533"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#CCall"><span class="hs-identifier hs-type">CCall</span></a></span><span> </span><span id="local-6989586621679470767"><span class="annot"><span class="annottext">CSym
</span><a href="#local-6989586621679470767"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679470766"><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679470766"><span class="hs-identifier hs-var">es</span></a></span></span><span>  </span><span id="local-6989586621679470765"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470765"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470765"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">CSym -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">CSym
</span><a href="#local-6989586621679470767"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span>
</span><span id="line-534"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
forall ann. Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
</span><span class="hs-identifier hs-var">punctuate</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">comma</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; [Doc ann]) -&gt; [Doc ann] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Expr t -&gt; Doc ann) -&gt; [Expr t] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679470766"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#CQuote"><span class="hs-identifier hs-type">CQuote</span></a></span><span> </span><span id="local-6989586621679470764"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679470764"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679470763"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470763"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-536"></span><span>    </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470763"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$$&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679470764"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$$&quot;</span></span><span>
</span><span id="line-537"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#FfiCall"><span class="hs-identifier hs-type">FfiCall</span></a></span><span> </span><span id="local-6989586621679470762"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470762"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679470761"><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679470761"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470762"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expr t -&gt; Doc ann) -&gt; [Expr t] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; (Expr t -&gt; Doc ann) -&gt; Expr t -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Expr t]
</span><a href="#local-6989586621679470761"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span id="local-6989586621679470760"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621679470760"><span class="hs-identifier hs-var">po</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679470759"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470759"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679470758"><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470758"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679470757"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470757"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-539"></span><span>    </span><span class="annot"><span class="annottext">t -&gt; Doc ann -&gt; Doc ann
forall t ann. Dumpy t =&gt; t -&gt; Doc ann -&gt; Doc ann
</span><a href="Common.Pretty.html#typeAnn"><span class="hs-identifier hs-var">typeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679470757"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470759"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621679470760"><span class="hs-identifier hs-var">po</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Expr t
</span><a href="#local-6989586621679470758"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-540"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span id="local-6989586621679470756"><span class="annot"><span class="annottext">Primitive
</span><a href="#local-6989586621679470756"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Expr t]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Doc ann
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Primitive expression not well-formed: &quot;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc ann) -&gt; String -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Primitive -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Primitive
</span><a href="#local-6989586621679470756"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="annot"><a href="IR.IR.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-543"></span><span>  </span><span id="local-6989586621679470754"><span class="annot"><span class="annottext">dumpy :: Alt -&gt; Doc ann
</span><a href="#local-6989586621679470754"><span class="hs-identifier hs-var hs-var hs-var hs-var">dumpy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltData"><span class="hs-identifier hs-type">AltData</span></a></span><span> </span><span id="local-6989586621679470753"><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679470753"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679470752"><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621679470752"><span class="hs-identifier hs-var">b</span></a></span></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DConId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">DConId
</span><a href="#local-6989586621679470753"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Binder -&gt; Doc ann) -&gt; [Binder] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Binder -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">[Binder]
</span><a href="#local-6989586621679470752"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltLit"><span class="hs-identifier hs-type">AltLit</span></a></span><span>     </span><span id="local-6989586621679470751"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679470751"><span class="hs-identifier hs-var">a</span></a></span></span><span>       </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621679470751"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-545"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltDefault"><span class="hs-identifier hs-type">AltDefault</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679470750"><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470750"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarId -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">VarId
</span><a href="#local-6989586621679470750"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-546"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#AltDefault"><span class="hs-identifier hs-type">AltDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Binder
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="annot"><a href="IR.IR.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-549"></span><span>  </span><span id="local-6989586621679470748"><span class="annot"><span class="annottext">dumpy :: Literal -&gt; Doc ann
</span><a href="#local-6989586621679470748"><span class="hs-identifier hs-var hs-var hs-var hs-var">dumpy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#LitIntegral"><span class="hs-identifier hs-type">LitIntegral</span></a></span><span> </span><span id="local-6989586621679470747"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679470747"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc ann) -&gt; String -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679470747"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-550"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.IR.html#LitBool"><span class="hs-identifier hs-type">LitBool</span></a></span><span>     </span><span id="local-6989586621679470746"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679470746"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc ann) -&gt; String -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679470746"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-551"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="IR.IR.html#LitEvent"><span class="hs-identifier hs-var">LitEvent</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;()&quot;</span></span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="annot"><a href="IR.IR.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-554"></span><span>  </span><span id="local-6989586621679470744"><span class="annot"><span class="annottext">dumpy :: PrimOp -&gt; Doc ann
</span><a href="#local-6989586621679470744"><span class="hs-identifier hs-var hs-var hs-var hs-var">dumpy</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimNeg"><span class="hs-identifier hs-var">PrimNeg</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span>
</span><span id="line-555"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimNot"><span class="hs-identifier hs-var">PrimNot</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!&quot;</span></span><span>
</span><span id="line-556"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimBitNot"><span class="hs-identifier hs-var">PrimBitNot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;~&quot;</span></span><span>
</span><span id="line-557"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimAdd"><span class="hs-identifier hs-var">PrimAdd</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+&quot;</span></span><span>
</span><span id="line-558"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimSub"><span class="hs-identifier hs-var">PrimSub</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span>
</span><span id="line-559"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimMul"><span class="hs-identifier hs-var">PrimMul</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*&quot;</span></span><span>
</span><span id="line-560"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimDiv"><span class="hs-identifier hs-var">PrimDiv</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span>
</span><span id="line-561"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimMod"><span class="hs-identifier hs-var">PrimMod</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%&quot;</span></span><span>
</span><span id="line-562"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimBitAnd"><span class="hs-identifier hs-var">PrimBitAnd</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&amp;&quot;</span></span><span>
</span><span id="line-563"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimBitOr"><span class="hs-identifier hs-var">PrimBitOr</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;|&quot;</span></span><span>
</span><span id="line-564"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimEq"><span class="hs-identifier hs-var">PrimEq</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;==&quot;</span></span><span>
</span><span id="line-565"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimNeq"><span class="hs-identifier hs-var">PrimNeq</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!=&quot;</span></span><span>
</span><span id="line-566"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimGt"><span class="hs-identifier hs-var">PrimGt</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span>
</span><span id="line-567"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimGe"><span class="hs-identifier hs-var">PrimGe</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;=&quot;</span></span><span>
</span><span id="line-568"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimLt"><span class="hs-identifier hs-var">PrimLt</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;&quot;</span></span><span>
</span><span id="line-569"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="IR.IR.html#PrimLe"><span class="hs-identifier hs-var">PrimLe</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;=&quot;</span></span><span>
</span><span id="line-570"></span></pre></body></html>