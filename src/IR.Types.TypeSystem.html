<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_17z4TadlpLZC1YKodX2z8x"></span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">{- | Common definitions for the type system(s) used in this compiler.

The following is a sketch of the type pipeline (from top to bottom):

Types.Ast: type classes + polymorphic types + implicit types (to be inferred)

   (type inference)

Types.Classes: type classes + polymorphic types

   (typeclass instantiation)

Types.Poly: polymorphic types

   (monomophisation)

Types.Flat: concrete only
-}</span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">IR.Types.TypeSystem</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Common.Identifiers.html"><span class="hs-identifier">Common.Identifiers</span></a></span><span>             </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Common.Identifiers.html#DConId"><span class="hs-identifier">DConId</span></a></span><span>
</span><span id="line-23"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#TVarId"><span class="hs-identifier">TVarId</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier">VarId</span></a></span><span>
</span><span id="line-25"></span><span>                                                </span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Common.Pretty.html"><span class="hs-identifier">Common.Pretty</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span>                 </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Bifunctor</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Data</span></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Data</span></span><span>
</span><span id="line-30"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Typeable</span></span><span>
</span><span id="line-31"></span><span>                                                </span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- | The number of arguments a type constructor will take.</span><span>
</span><span id="line-34"></span><span class="hs-keyword">type</span><span> </span><span id="Arity"><span class="annot"><a href="IR.Types.TypeSystem.html#Arity"><span class="hs-identifier hs-var">Arity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">-- | Builtin type constructors that should be preserved across all type systems.</span><span>
</span><span id="line-37"></span><span class="hs-keyword">data</span><span> </span><span id="Builtin"><span class="annot"><a href="IR.Types.TypeSystem.html#Builtin"><span class="hs-identifier hs-var">Builtin</span></a></span></span><span> </span><span id="local-6989586621679470010"><span class="annot"><a href="#local-6989586621679470010"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Unit"><span class="annot"><a href="IR.Types.TypeSystem.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span></span><span>          </span><span class="hs-comment">-- ^ Singleton type @()@</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Void"><span class="annot"><a href="IR.Types.TypeSystem.html#Void"><span class="hs-identifier hs-var">Void</span></a></span></span><span>          </span><span class="hs-comment">-- ^ Uninhabited type @!@, coerces with anything</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Ref"><span class="annot"><a href="IR.Types.TypeSystem.html#Ref"><span class="hs-identifier hs-var">Ref</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679470010"><span class="hs-identifier hs-type">t</span></a></span><span>         </span><span class="hs-comment">-- ^ Reference of @&amp;@</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Arrow"><span class="annot"><a href="IR.Types.TypeSystem.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679470010"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679470010"><span class="hs-identifier hs-type">t</span></a></span><span>     </span><span class="hs-comment">-- ^ Function arrow @a -&gt; b@</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Tuple"><span class="annot"><a href="IR.Types.TypeSystem.html#Tuple"><span class="hs-identifier hs-var">Tuple</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679470010"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- ^ Tuple with two or more fields</span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Integral"><span class="annot"><a href="IR.Types.TypeSystem.html#Integral"><span class="hs-identifier hs-var">Integral</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>  </span><span class="hs-comment">-- ^ Two's complement binary type with size in bits</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679469894"><span id="local-6989586621679469896"><span class="annot"><span class="annottext">Builtin t -&gt; Builtin t -&gt; Bool
(Builtin t -&gt; Builtin t -&gt; Bool)
-&gt; (Builtin t -&gt; Builtin t -&gt; Bool) -&gt; Eq (Builtin t)
forall t. Eq t =&gt; Builtin t -&gt; Builtin t -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Builtin t -&gt; Builtin t -&gt; Bool
$c/= :: forall t. Eq t =&gt; Builtin t -&gt; Builtin t -&gt; Bool
== :: Builtin t -&gt; Builtin t -&gt; Bool
$c== :: forall t. Eq t =&gt; Builtin t -&gt; Builtin t -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679469887"><span id="local-6989586621679469889"><span id="local-6989586621679469891"><span class="annot"><span class="annottext">Int -&gt; Builtin t -&gt; ShowS
[Builtin t] -&gt; ShowS
Builtin t -&gt; String
(Int -&gt; Builtin t -&gt; ShowS)
-&gt; (Builtin t -&gt; String)
-&gt; ([Builtin t] -&gt; ShowS)
-&gt; Show (Builtin t)
forall t. Show t =&gt; Int -&gt; Builtin t -&gt; ShowS
forall t. Show t =&gt; [Builtin t] -&gt; ShowS
forall t. Show t =&gt; Builtin t -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Builtin t] -&gt; ShowS
$cshowList :: forall t. Show t =&gt; [Builtin t] -&gt; ShowS
show :: Builtin t -&gt; String
$cshow :: forall t. Show t =&gt; Builtin t -&gt; String
showsPrec :: Int -&gt; Builtin t -&gt; ShowS
$cshowsPrec :: forall t. Show t =&gt; Int -&gt; Builtin t -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679469871"><span id="local-6989586621679469873"><span id="local-6989586621679469875"><span id="local-6989586621679469877"><span id="local-6989586621679469879"><span id="local-6989586621679469881"><span id="local-6989586621679469883"><span class="annot"><span class="annottext">Eq (Builtin t)
Eq (Builtin t)
-&gt; (Builtin t -&gt; Builtin t -&gt; Ordering)
-&gt; (Builtin t -&gt; Builtin t -&gt; Bool)
-&gt; (Builtin t -&gt; Builtin t -&gt; Bool)
-&gt; (Builtin t -&gt; Builtin t -&gt; Bool)
-&gt; (Builtin t -&gt; Builtin t -&gt; Bool)
-&gt; (Builtin t -&gt; Builtin t -&gt; Builtin t)
-&gt; (Builtin t -&gt; Builtin t -&gt; Builtin t)
-&gt; Ord (Builtin t)
Builtin t -&gt; Builtin t -&gt; Bool
Builtin t -&gt; Builtin t -&gt; Ordering
Builtin t -&gt; Builtin t -&gt; Builtin t
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall t. Ord t =&gt; Eq (Builtin t)
forall t. Ord t =&gt; Builtin t -&gt; Builtin t -&gt; Bool
forall t. Ord t =&gt; Builtin t -&gt; Builtin t -&gt; Ordering
forall t. Ord t =&gt; Builtin t -&gt; Builtin t -&gt; Builtin t
min :: Builtin t -&gt; Builtin t -&gt; Builtin t
$cmin :: forall t. Ord t =&gt; Builtin t -&gt; Builtin t -&gt; Builtin t
max :: Builtin t -&gt; Builtin t -&gt; Builtin t
$cmax :: forall t. Ord t =&gt; Builtin t -&gt; Builtin t -&gt; Builtin t
&gt;= :: Builtin t -&gt; Builtin t -&gt; Bool
$c&gt;= :: forall t. Ord t =&gt; Builtin t -&gt; Builtin t -&gt; Bool
&gt; :: Builtin t -&gt; Builtin t -&gt; Bool
$c&gt; :: forall t. Ord t =&gt; Builtin t -&gt; Builtin t -&gt; Bool
&lt;= :: Builtin t -&gt; Builtin t -&gt; Bool
$c&lt;= :: forall t. Ord t =&gt; Builtin t -&gt; Builtin t -&gt; Bool
&lt; :: Builtin t -&gt; Builtin t -&gt; Bool
$c&lt; :: forall t. Ord t =&gt; Builtin t -&gt; Builtin t -&gt; Bool
compare :: Builtin t -&gt; Builtin t -&gt; Ordering
$ccompare :: forall t. Ord t =&gt; Builtin t -&gt; Builtin t -&gt; Ordering
$cp1Ord :: forall t. Ord t =&gt; Eq (Builtin t)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cIntegral"><span id="%24cTuple"><span id="%24cArrow"><span id="%24cRef"><span id="%24cVoid"><span id="%24cUnit"><span id="%24tBuiltin"><span id="local-6989586621679469841"><span id="local-6989586621679469843"><span id="local-6989586621679469845"><span id="local-6989586621679469847"><span id="local-6989586621679469849"><span id="local-6989586621679469851"><span id="local-6989586621679469853"><span id="local-6989586621679469855"><span id="local-6989586621679469857"><span id="local-6989586621679469859"><span id="local-6989586621679469861"><span id="local-6989586621679469863"><span id="local-6989586621679469865"><span id="local-6989586621679469867"><span class="annot"><span class="annottext">Typeable (Builtin t)
DataType
Constr
Typeable (Builtin t)
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; Builtin t -&gt; c (Builtin t))
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Builtin t))
-&gt; (Builtin t -&gt; Constr)
-&gt; (Builtin t -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Builtin t)))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e))
    -&gt; Maybe (c (Builtin t)))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; Builtin t -&gt; Builtin t)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Builtin t -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Builtin t -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Builtin t -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Builtin t -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Builtin t -&gt; m (Builtin t))
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Builtin t -&gt; m (Builtin t))
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Builtin t -&gt; m (Builtin t))
-&gt; Data (Builtin t)
Builtin t -&gt; DataType
Builtin t -&gt; Constr
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Builtin t))
(forall b. Data b =&gt; b -&gt; b) -&gt; Builtin t -&gt; Builtin t
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Builtin t -&gt; c (Builtin t)
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Builtin t)
forall t. Data t =&gt; Typeable (Builtin t)
forall t. Data t =&gt; Builtin t -&gt; DataType
forall t. Data t =&gt; Builtin t -&gt; Constr
forall t.
Data t =&gt;
(forall b. Data b =&gt; b -&gt; b) -&gt; Builtin t -&gt; Builtin t
forall t u.
Data t =&gt;
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Builtin t -&gt; u
forall t u.
Data t =&gt;
(forall d. Data d =&gt; d -&gt; u) -&gt; Builtin t -&gt; [u]
forall t r r'.
Data t =&gt;
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Builtin t -&gt; r
forall t r r'.
Data t =&gt;
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Builtin t -&gt; r
forall t (m :: * -&gt; *).
(Data t, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Builtin t -&gt; m (Builtin t)
forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Builtin t -&gt; m (Builtin t)
forall t (c :: * -&gt; *).
Data t =&gt;
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Builtin t)
forall t (c :: * -&gt; *).
Data t =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Builtin t -&gt; c (Builtin t)
forall t (t :: * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Builtin t))
forall t (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (Builtin t))
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Builtin t -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Builtin t -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Builtin t -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Builtin t -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Builtin t -&gt; m (Builtin t)
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Builtin t -&gt; m (Builtin t)
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Builtin t)
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Builtin t -&gt; c (Builtin t)
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Builtin t))
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (Builtin t))
$cIntegral :: Constr
$cTuple :: Constr
$cArrow :: Constr
$cRef :: Constr
$cVoid :: Constr
$cUnit :: Constr
$tBuiltin :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Builtin t -&gt; m (Builtin t)
$cgmapMo :: forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Builtin t -&gt; m (Builtin t)
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Builtin t -&gt; m (Builtin t)
$cgmapMp :: forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Builtin t -&gt; m (Builtin t)
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Builtin t -&gt; m (Builtin t)
$cgmapM :: forall t (m :: * -&gt; *).
(Data t, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Builtin t -&gt; m (Builtin t)
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Builtin t -&gt; u
$cgmapQi :: forall t u.
Data t =&gt;
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Builtin t -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; Builtin t -&gt; [u]
$cgmapQ :: forall t u.
Data t =&gt;
(forall d. Data d =&gt; d -&gt; u) -&gt; Builtin t -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Builtin t -&gt; r
$cgmapQr :: forall t r r'.
Data t =&gt;
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Builtin t -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Builtin t -&gt; r
$cgmapQl :: forall t r r'.
Data t =&gt;
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Builtin t -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Builtin t -&gt; Builtin t
$cgmapT :: forall t.
Data t =&gt;
(forall b. Data b =&gt; b -&gt; b) -&gt; Builtin t -&gt; Builtin t
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (Builtin t))
$cdataCast2 :: forall t (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (Builtin t))
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Builtin t))
$cdataCast1 :: forall t (t :: * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (Builtin t))
dataTypeOf :: Builtin t -&gt; DataType
$cdataTypeOf :: forall t. Data t =&gt; Builtin t -&gt; DataType
toConstr :: Builtin t -&gt; Constr
$ctoConstr :: forall t. Data t =&gt; Builtin t -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Builtin t)
$cgunfold :: forall t (c :: * -&gt; *).
Data t =&gt;
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (Builtin t)
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Builtin t -&gt; c (Builtin t)
$cgfoldl :: forall t (c :: * -&gt; *).
Data t =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Builtin t -&gt; c (Builtin t)
$cp1Data :: forall t. Data t =&gt; Typeable (Builtin t)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679469830"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#Builtin"><span class="hs-identifier hs-type">Builtin</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-47"></span><span>  </span><span id="local-6989586621679469828"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; Builtin a -&gt; Builtin b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Builtin a
</span><a href="IR.Types.TypeSystem.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builtin b
forall t. Builtin t
</span><a href="IR.Types.TypeSystem.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Builtin a
</span><a href="IR.Types.TypeSystem.html#Void"><span class="hs-identifier hs-var">Void</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builtin b
forall t. Builtin t
</span><a href="IR.Types.TypeSystem.html#Void"><span class="hs-identifier hs-var">Void</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679469827"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679469827"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span id="local-6989586621679469826"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679469826"><span class="hs-identifier hs-var">t</span></a></span></span><span>       </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; Builtin b
forall t. t -&gt; Builtin t
</span><a href="IR.Types.TypeSystem.html#Ref"><span class="hs-identifier hs-var">Ref</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Builtin b) -&gt; b -&gt; Builtin b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679469827"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679469826"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679469825"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679469825"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#Arrow"><span class="hs-identifier hs-type">Arrow</span></a></span><span> </span><span id="local-6989586621679469824"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679469824"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679469823"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679469823"><span class="hs-identifier hs-var">r</span></a></span></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Builtin b
forall t. t -&gt; t -&gt; Builtin t
</span><a href="IR.Types.TypeSystem.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679469825"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679469824"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679469825"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679469823"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679469822"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679469822"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#Tuple"><span class="hs-identifier hs-type">Tuple</span></a></span><span>    </span><span id="local-6989586621679469821"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679469821"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[b] -&gt; Builtin b
forall t. [t] -&gt; Builtin t
</span><a href="IR.Types.TypeSystem.html#Tuple"><span class="hs-identifier hs-var">Tuple</span></a></span><span> </span><span class="annot"><span class="annottext">([b] -&gt; Builtin b) -&gt; [b] -&gt; Builtin b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679469822"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679469821"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span id="local-6989586621679469820"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679469820"><span class="hs-identifier hs-var">s</span></a></span></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Builtin b
forall t. Int -&gt; Builtin t
</span><a href="IR.Types.TypeSystem.html#Integral"><span class="hs-identifier hs-var">Integral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679469820"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span id="local-6989586621679469819"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679469816"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621679469819"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#Builtin"><span class="hs-identifier hs-type">Builtin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679469819"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>  </span><span id="local-6989586621679469814"><span class="annot"><span class="annottext">pretty :: Builtin t -&gt; Doc ann
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></span></span><span> </span><span class="annot"><span class="annottext">Builtin t
</span><a href="IR.Types.TypeSystem.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;()&quot;</span></span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">Builtin t
</span><a href="IR.Types.TypeSystem.html#Void"><span class="hs-identifier hs-var">Void</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!&quot;</span></span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span id="local-6989586621679469812"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469812"><span class="hs-identifier hs-var">t</span></a></span></span><span>       </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&amp;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469812"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#Arrow"><span class="hs-identifier hs-type">Arrow</span></a></span><span> </span><span id="local-6989586621679469811"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469811"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679469810"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469810"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469811"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#rarrow"><span class="hs-identifier hs-var">rarrow</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469810"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#Tuple"><span class="hs-identifier hs-type">Tuple</span></a></span><span>    </span><span id="local-6989586621679469807"><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679469807"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
forall ann. Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
</span><span class="hs-identifier hs-var">punctuate</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">comma</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; [Doc ann]) -&gt; [Doc ann] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(t -&gt; Doc ann) -&gt; [t] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679469807"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Int&quot;</span></span></span><span> </span><span class="hs-comment">-- ++ show s</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span id="local-6989586621679469802"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679469802"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.Pretty.html#Dumpy"><span class="hs-identifier hs-type">Dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#Builtin"><span class="hs-identifier hs-type">Builtin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679469802"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-63"></span><span>  </span><span id="local-6989586621679469799"><span class="annot"><span class="annottext">dumpy :: Builtin t -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var hs-var hs-var hs-var">dumpy</span></a></span></span><span> </span><span class="annot"><span class="annottext">Builtin t
</span><a href="IR.Types.TypeSystem.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;()&quot;</span></span><span>
</span><span id="line-64"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">Builtin t
</span><a href="IR.Types.TypeSystem.html#Void"><span class="hs-identifier hs-var">Void</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!&quot;</span></span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span id="local-6989586621679469797"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469797"><span class="hs-identifier hs-var">t</span></a></span></span><span>       </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&amp;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469797"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#Arrow"><span class="hs-identifier hs-type">Arrow</span></a></span><span> </span><span id="local-6989586621679469796"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469796"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679469795"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469795"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469796"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="Common.Pretty.html#rarrow"><span class="hs-identifier hs-var">rarrow</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469795"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#Tuple"><span class="hs-identifier hs-type">Tuple</span></a></span><span>    </span><span id="local-6989586621679469794"><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679469794"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">hsep</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann) -&gt; [Doc ann] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
forall ann. Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
</span><span class="hs-identifier hs-var">punctuate</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">comma</span></span><span> </span><span class="annot"><span class="annottext">([Doc ann] -&gt; [Doc ann]) -&gt; [Doc ann] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(t -&gt; Doc ann) -&gt; [t] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Doc ann
forall a ann. Dumpy a =&gt; a -&gt; Doc ann
</span><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679469794"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><a href="Common.Pretty.html#dumpy"><span class="hs-identifier hs-var">dumpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Int&quot;</span></span></span><span> </span><span class="hs-comment">-- ++ show s</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">{- | A type system must allow us to construct and access underlying builtins.

Instances should satisfy the following law:

* @injectBuiltin . projectBuiltin = Just@

-}</span><span>
</span><span id="line-77"></span><span class="hs-keyword">class</span><span> </span><span id="TypeSystem"><span class="annot"><a href="IR.Types.TypeSystem.html#TypeSystem"><span class="hs-identifier hs-var">TypeSystem</span></a></span></span><span> </span><span id="local-6989586621679469984"><span class="annot"><a href="#local-6989586621679469984"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>  </span><span id="projectBuiltin"><span class="annot"><a href="IR.Types.TypeSystem.html#projectBuiltin"><span class="hs-identifier hs-type">projectBuiltin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#Builtin"><span class="hs-identifier hs-type">Builtin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679469984"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679469984"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span id="injectBuiltin"><span class="annot"><a href="IR.Types.TypeSystem.html#injectBuiltin"><span class="hs-identifier hs-type">injectBuiltin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679469984"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#Builtin"><span class="hs-identifier hs-type">Builtin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679469984"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- | Helper to construct 'Unit' type in any 'TypeSystem'.</span><span>
</span><span id="line-82"></span><span id="local-6989586621679469972"><span class="annot"><a href="IR.Types.TypeSystem.html#unit"><span class="hs-keyword hs-type">unit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeSystem"><span class="hs-identifier hs-type">TypeSystem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679469972"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679469972"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-83"></span><span id="unit"><span class="annot"><span class="annottext">unit :: t
</span><a href="IR.Types.TypeSystem.html#unit"><span class="hs-keyword hs-var hs-var">unit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builtin t -&gt; t
forall t. TypeSystem t =&gt; Builtin t -&gt; t
</span><a href="IR.Types.TypeSystem.html#projectBuiltin"><span class="hs-identifier hs-var">projectBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">Builtin t
forall t. Builtin t
</span><a href="IR.Types.TypeSystem.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- | Helper to construct 'Void' type in any 'TypeSystem'.</span><span>
</span><span id="line-86"></span><span id="local-6989586621679469790"><span class="annot"><a href="IR.Types.TypeSystem.html#void"><span class="hs-identifier hs-type">void</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeSystem"><span class="hs-identifier hs-type">TypeSystem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679469790"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679469790"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-87"></span><span id="void"><span class="annot"><span class="annottext">void :: t
</span><a href="IR.Types.TypeSystem.html#void"><span class="hs-identifier hs-var hs-var">void</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builtin t -&gt; t
forall t. TypeSystem t =&gt; Builtin t -&gt; t
</span><a href="IR.Types.TypeSystem.html#projectBuiltin"><span class="hs-identifier hs-var">projectBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">Builtin t
forall t. Builtin t
</span><a href="IR.Types.TypeSystem.html#Void"><span class="hs-identifier hs-var">Void</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | Helper to construct 'Ref' type in any 'TypeSystem'.</span><span>
</span><span id="line-90"></span><span id="local-6989586621679469788"><span class="annot"><a href="IR.Types.TypeSystem.html#ref"><span class="hs-identifier hs-type">ref</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeSystem"><span class="hs-identifier hs-type">TypeSystem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679469788"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679469788"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679469788"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-91"></span><span id="ref"><span class="annot"><span class="annottext">ref :: t -&gt; t
</span><a href="IR.Types.TypeSystem.html#ref"><span class="hs-identifier hs-var hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builtin t -&gt; t
forall t. TypeSystem t =&gt; Builtin t -&gt; t
</span><a href="IR.Types.TypeSystem.html#projectBuiltin"><span class="hs-identifier hs-var">projectBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">(Builtin t -&gt; t) -&gt; (t -&gt; Builtin t) -&gt; t -&gt; t
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Builtin t
forall t. t -&gt; Builtin t
</span><a href="IR.Types.TypeSystem.html#Ref"><span class="hs-identifier hs-var">Ref</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- | Helper to construct 'Arrow' type in any 'TypeSystem'.</span><span>
</span><span id="line-94"></span><span id="local-6989586621679469785"><span class="annot"><a href="IR.Types.TypeSystem.html#arrow"><span class="hs-identifier hs-type">arrow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeSystem"><span class="hs-identifier hs-type">TypeSystem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679469785"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679469785"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679469785"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679469785"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-95"></span><span id="arrow"><span class="annot"><span class="annottext">arrow :: t -&gt; t -&gt; t
</span><a href="IR.Types.TypeSystem.html#arrow"><span class="hs-identifier hs-var hs-var">arrow</span></a></span></span><span> </span><span id="local-6989586621679469783"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469783"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679469782"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469782"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builtin t -&gt; t
forall t. TypeSystem t =&gt; Builtin t -&gt; t
</span><a href="IR.Types.TypeSystem.html#projectBuiltin"><span class="hs-identifier hs-var">projectBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">(Builtin t -&gt; t) -&gt; Builtin t -&gt; t
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Builtin t
forall t. t -&gt; t -&gt; Builtin t
</span><a href="IR.Types.TypeSystem.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469783"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469782"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">-- | Helper to unwrap 'Ref' in any 'TypeSystem'.</span><span>
</span><span id="line-98"></span><span id="local-6989586621679469781"><span class="annot"><a href="IR.Types.TypeSystem.html#deref"><span class="hs-identifier hs-type">deref</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeSystem"><span class="hs-identifier hs-type">TypeSystem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679469781"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679469781"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679469781"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-99"></span><span id="deref"><span class="annot"><span class="annottext">deref :: t -&gt; Maybe t
</span><a href="IR.Types.TypeSystem.html#deref"><span class="hs-identifier hs-var hs-var">deref</span></a></span></span><span> </span><span id="local-6989586621679469779"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469779"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">t -&gt; Maybe (Builtin t)
forall t. TypeSystem t =&gt; t -&gt; Maybe (Builtin t)
</span><a href="IR.Types.TypeSystem.html#injectBuiltin"><span class="hs-identifier hs-var">injectBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469779"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span id="local-6989586621679469778"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469778"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t -&gt; Maybe t
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469778"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><span class="annottext">Maybe (Builtin t)
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe t
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- | Helper to unwrap 'Arrow' in any 'TypeSystem'.</span><span>
</span><span id="line-104"></span><span id="local-6989586621679469969"><span class="annot"><a href="IR.Types.TypeSystem.html#dearrow"><span class="hs-identifier hs-type">dearrow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeSystem"><span class="hs-identifier hs-type">TypeSystem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679469969"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679469969"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679469969"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679469969"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-105"></span><span id="dearrow"><span class="annot"><span class="annottext">dearrow :: t -&gt; Maybe (t, t)
</span><a href="IR.Types.TypeSystem.html#dearrow"><span class="hs-identifier hs-var hs-var">dearrow</span></a></span></span><span> </span><span id="local-6989586621679469776"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469776"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">t -&gt; Maybe (Builtin t)
forall t. TypeSystem t =&gt; t -&gt; Maybe (Builtin t)
</span><a href="IR.Types.TypeSystem.html#injectBuiltin"><span class="hs-identifier hs-var">injectBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469776"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#Arrow"><span class="hs-identifier hs-type">Arrow</span></a></span><span> </span><span id="local-6989586621679469775"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469775"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679469774"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469774"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(t, t) -&gt; Maybe (t, t)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469775"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469774"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><span class="annottext">Maybe (Builtin t)
</span><span class="hs-identifier">_</span></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (t, t)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | Helper to construct tuples from list of types, accounting for size &lt; 2.</span><span>
</span><span id="line-110"></span><span id="local-6989586621679469773"><span class="annot"><a href="IR.Types.TypeSystem.html#tuple"><span class="hs-identifier hs-type">tuple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeSystem"><span class="hs-identifier hs-type">TypeSystem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679469773"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679469773"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679469773"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-111"></span><span id="tuple"><span class="annot"><span class="annottext">tuple :: [t] -&gt; t
</span><a href="IR.Types.TypeSystem.html#tuple"><span class="hs-identifier hs-var hs-var">tuple</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
forall t. TypeSystem t =&gt; t
</span><a href="IR.Types.TypeSystem.html#unit"><span class="hs-keyword hs-var">unit</span></a></span><span> </span><span class="hs-comment">-- Empty tuples are just voids</span><span>
</span><span id="line-112"></span><span class="annot"><a href="IR.Types.TypeSystem.html#tuple"><span class="hs-identifier hs-var">tuple</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679469771"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469771"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469771"><span class="hs-identifier hs-var">t</span></a></span><span>   </span><span class="hs-comment">-- Singleton tuples are just tuples.</span><span>
</span><span id="line-113"></span><span class="annot"><a href="IR.Types.TypeSystem.html#tuple"><span class="hs-identifier hs-var">tuple</span></a></span><span> </span><span id="local-6989586621679469770"><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679469770"><span class="hs-identifier hs-var">ts</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builtin t -&gt; t
forall t. TypeSystem t =&gt; Builtin t -&gt; t
</span><a href="IR.Types.TypeSystem.html#projectBuiltin"><span class="hs-identifier hs-var">projectBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">(Builtin t -&gt; t) -&gt; Builtin t -&gt; t
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[t] -&gt; Builtin t
forall t. [t] -&gt; Builtin t
</span><a href="IR.Types.TypeSystem.html#Tuple"><span class="hs-identifier hs-var">Tuple</span></a></span><span> </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679469770"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">-- | Helper to construct integral type.</span><span>
</span><span id="line-116"></span><span id="local-6989586621679469769"><span class="annot"><a href="IR.Types.TypeSystem.html#int"><span class="hs-identifier hs-type">int</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeSystem"><span class="hs-identifier hs-type">TypeSystem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679469769"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679469769"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-117"></span><span id="int"><span class="annot"><span class="annottext">int :: Int -&gt; t
</span><a href="IR.Types.TypeSystem.html#int"><span class="hs-identifier hs-var hs-var">int</span></a></span></span><span> </span><span id="local-6989586621679469767"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679469767"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builtin t -&gt; t
forall t. TypeSystem t =&gt; Builtin t -&gt; t
</span><a href="IR.Types.TypeSystem.html#projectBuiltin"><span class="hs-identifier hs-var">projectBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">(Builtin t -&gt; t) -&gt; Builtin t -&gt; t
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Builtin t
forall t. Int -&gt; Builtin t
</span><a href="IR.Types.TypeSystem.html#Integral"><span class="hs-identifier hs-var">Integral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679469767"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | Decompose an 'Arrow' type into a list of argument types and a return type.</span><span>
</span><span id="line-120"></span><span id="local-6989586621679469968"><span class="annot"><a href="IR.Types.TypeSystem.html#collectArrow"><span class="hs-identifier hs-type">collectArrow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeSystem"><span class="hs-identifier hs-type">TypeSystem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679469968"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679469968"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679469968"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679469968"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-121"></span><span id="collectArrow"><span class="annot"><span class="annottext">collectArrow :: t -&gt; ([t], t)
</span><a href="IR.Types.TypeSystem.html#collectArrow"><span class="hs-identifier hs-var hs-var">collectArrow</span></a></span></span><span> </span><span id="local-6989586621679469765"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469765"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">t -&gt; Maybe (t, t)
forall t. TypeSystem t =&gt; t -&gt; Maybe (t, t)
</span><a href="IR.Types.TypeSystem.html#dearrow"><span class="hs-identifier hs-var">dearrow</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469765"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-122"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679469764"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469764"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679469763"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469763"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679469762"><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679469762"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679469761"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469761"><span class="hs-identifier hs-var">rt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; ([t], t)
forall t. TypeSystem t =&gt; t -&gt; ([t], t)
</span><a href="IR.Types.TypeSystem.html#collectArrow"><span class="hs-identifier hs-var">collectArrow</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469763"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469764"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; [t] -&gt; [t]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679469762"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469761"><span class="hs-identifier hs-var">rt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>  </span><span class="annot"><span class="annottext">Maybe (t, t)
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679469765"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">{- | The type definition associated with a type constructor.

A definition for `data MyList a = Cons a (MyList a) | Nil` looks like:

@
  TypeDef { targs = [a]
          , [ (&quot;Cons&quot;, VariantUnnamed [TVar a, TCon (&quot;MyList&quot; [TVar a])])
            , (&quot;Nil&quot;, VariantUnnamed [])
            ]
          }
@

(Data constructors for identifiers are omitted for brevity.)

Note that for a flat type system, where all type constructors are nullary, targs
will just be set to [].
-}</span><span>
</span><span id="line-142"></span><span class="hs-keyword">data</span><span> </span><span id="TypeDef"><span class="annot"><a href="IR.Types.TypeSystem.html#TypeDef"><span class="hs-identifier hs-var">TypeDef</span></a></span></span><span> </span><span id="local-6989586621679469921"><span class="annot"><a href="#local-6989586621679469921"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TypeDef"><span class="annot"><a href="IR.Types.TypeSystem.html#TypeDef"><span class="hs-identifier hs-var">TypeDef</span></a></span></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="variants"><span class="annot"><span class="annottext">TypeDef t -&gt; [(DConId, TypeVariant t)]
</span><a href="IR.Types.TypeSystem.html#variants"><span class="hs-identifier hs-var hs-var">variants</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#DConId"><span class="hs-identifier hs-type">DConId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeVariant"><span class="hs-identifier hs-type">TypeVariant</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679469921"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="targs"><span class="annot"><span class="annottext">TypeDef t -&gt; [TVarId]
</span><a href="IR.Types.TypeSystem.html#targs"><span class="hs-identifier hs-var hs-var">targs</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.Identifiers.html#TVarId"><span class="hs-identifier hs-type">TVarId</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679469752"><span id="local-6989586621679469754"><span id="local-6989586621679469756"><span class="annot"><span class="annottext">Int -&gt; TypeDef t -&gt; ShowS
[TypeDef t] -&gt; ShowS
TypeDef t -&gt; String
(Int -&gt; TypeDef t -&gt; ShowS)
-&gt; (TypeDef t -&gt; String)
-&gt; ([TypeDef t] -&gt; ShowS)
-&gt; Show (TypeDef t)
forall t. Show t =&gt; Int -&gt; TypeDef t -&gt; ShowS
forall t. Show t =&gt; [TypeDef t] -&gt; ShowS
forall t. Show t =&gt; TypeDef t -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TypeDef t] -&gt; ShowS
$cshowList :: forall t. Show t =&gt; [TypeDef t] -&gt; ShowS
show :: TypeDef t -&gt; String
$cshow :: forall t. Show t =&gt; TypeDef t -&gt; String
showsPrec :: Int -&gt; TypeDef t -&gt; ShowS
$cshowsPrec :: forall t. Show t =&gt; Int -&gt; TypeDef t -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679469748"><span id="local-6989586621679469750"><span class="annot"><span class="annottext">TypeDef t -&gt; TypeDef t -&gt; Bool
(TypeDef t -&gt; TypeDef t -&gt; Bool)
-&gt; (TypeDef t -&gt; TypeDef t -&gt; Bool) -&gt; Eq (TypeDef t)
forall t. Eq t =&gt; TypeDef t -&gt; TypeDef t -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TypeDef t -&gt; TypeDef t -&gt; Bool
$c/= :: forall t. Eq t =&gt; TypeDef t -&gt; TypeDef t -&gt; Bool
== :: TypeDef t -&gt; TypeDef t -&gt; Bool
$c== :: forall t. Eq t =&gt; TypeDef t -&gt; TypeDef t -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cTypeDef"><span id="%24tTypeDef"><span id="local-6989586621679469719"><span id="local-6989586621679469721"><span id="local-6989586621679469723"><span id="local-6989586621679469725"><span id="local-6989586621679469727"><span id="local-6989586621679469729"><span id="local-6989586621679469731"><span id="local-6989586621679469733"><span id="local-6989586621679469735"><span id="local-6989586621679469737"><span id="local-6989586621679469739"><span id="local-6989586621679469741"><span id="local-6989586621679469743"><span id="local-6989586621679469745"><span class="annot"><span class="annottext">Typeable (TypeDef t)
DataType
Constr
Typeable (TypeDef t)
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; TypeDef t -&gt; c (TypeDef t))
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (TypeDef t))
-&gt; (TypeDef t -&gt; Constr)
-&gt; (TypeDef t -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (TypeDef t)))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e))
    -&gt; Maybe (c (TypeDef t)))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; TypeDef t -&gt; TypeDef t)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeDef t -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeDef t -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; TypeDef t -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeDef t -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef t -&gt; m (TypeDef t))
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef t -&gt; m (TypeDef t))
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef t -&gt; m (TypeDef t))
-&gt; Data (TypeDef t)
TypeDef t -&gt; DataType
TypeDef t -&gt; Constr
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (TypeDef t))
(forall b. Data b =&gt; b -&gt; b) -&gt; TypeDef t -&gt; TypeDef t
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeDef t -&gt; c (TypeDef t)
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (TypeDef t)
forall t. Data t =&gt; Typeable (TypeDef t)
forall t. Data t =&gt; TypeDef t -&gt; DataType
forall t. Data t =&gt; TypeDef t -&gt; Constr
forall t.
Data t =&gt;
(forall b. Data b =&gt; b -&gt; b) -&gt; TypeDef t -&gt; TypeDef t
forall t u.
Data t =&gt;
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeDef t -&gt; u
forall t u.
Data t =&gt;
(forall d. Data d =&gt; d -&gt; u) -&gt; TypeDef t -&gt; [u]
forall t r r'.
Data t =&gt;
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeDef t -&gt; r
forall t r r'.
Data t =&gt;
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeDef t -&gt; r
forall t (m :: * -&gt; *).
(Data t, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef t -&gt; m (TypeDef t)
forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef t -&gt; m (TypeDef t)
forall t (c :: * -&gt; *).
Data t =&gt;
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (TypeDef t)
forall t (c :: * -&gt; *).
Data t =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeDef t -&gt; c (TypeDef t)
forall t (t :: * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (TypeDef t))
forall t (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (TypeDef t))
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeDef t -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; TypeDef t -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeDef t -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeDef t -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef t -&gt; m (TypeDef t)
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef t -&gt; m (TypeDef t)
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (TypeDef t)
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeDef t -&gt; c (TypeDef t)
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (TypeDef t))
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (TypeDef t))
$cTypeDef :: Constr
$tTypeDef :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef t -&gt; m (TypeDef t)
$cgmapMo :: forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef t -&gt; m (TypeDef t)
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef t -&gt; m (TypeDef t)
$cgmapMp :: forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef t -&gt; m (TypeDef t)
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef t -&gt; m (TypeDef t)
$cgmapM :: forall t (m :: * -&gt; *).
(Data t, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; TypeDef t -&gt; m (TypeDef t)
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeDef t -&gt; u
$cgmapQi :: forall t u.
Data t =&gt;
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeDef t -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; TypeDef t -&gt; [u]
$cgmapQ :: forall t u.
Data t =&gt;
(forall d. Data d =&gt; d -&gt; u) -&gt; TypeDef t -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeDef t -&gt; r
$cgmapQr :: forall t r r'.
Data t =&gt;
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeDef t -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeDef t -&gt; r
$cgmapQl :: forall t r r'.
Data t =&gt;
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeDef t -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; TypeDef t -&gt; TypeDef t
$cgmapT :: forall t.
Data t =&gt;
(forall b. Data b =&gt; b -&gt; b) -&gt; TypeDef t -&gt; TypeDef t
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (TypeDef t))
$cdataCast2 :: forall t (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (TypeDef t))
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (TypeDef t))
$cdataCast1 :: forall t (t :: * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (TypeDef t))
dataTypeOf :: TypeDef t -&gt; DataType
$cdataTypeOf :: forall t. Data t =&gt; TypeDef t -&gt; DataType
toConstr :: TypeDef t -&gt; Constr
$ctoConstr :: forall t. Data t =&gt; TypeDef t -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (TypeDef t)
$cgunfold :: forall t (c :: * -&gt; *).
Data t =&gt;
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (TypeDef t)
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeDef t -&gt; c (TypeDef t)
$cgfoldl :: forall t (c :: * -&gt; *).
Data t =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeDef t -&gt; c (TypeDef t)
$cp1Data :: forall t. Data t =&gt; Typeable (TypeDef t)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- | Arguments to a data constructor, whose fields may or may not be named</span><span>
</span><span id="line-149"></span><span class="hs-keyword">data</span><span> </span><span id="TypeVariant"><span class="annot"><a href="IR.Types.TypeSystem.html#TypeVariant"><span class="hs-identifier hs-var">TypeVariant</span></a></span></span><span> </span><span id="local-6989586621679469910"><span class="annot"><a href="#local-6989586621679469910"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="VariantNamed"><span class="annot"><a href="IR.Types.TypeSystem.html#VariantNamed"><span class="hs-identifier hs-var">VariantNamed</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Common.Identifiers.html#VarId"><span class="hs-identifier hs-type">VarId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679469910"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ A record with named fields</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="VariantUnnamed"><span class="annot"><a href="IR.Types.TypeSystem.html#VariantUnnamed"><span class="hs-identifier hs-var">VariantUnnamed</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679469910"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">]</span><span>        </span><span class="hs-comment">-- ^ An algebraic type with unnamed fields</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679469709"><span id="local-6989586621679469711"><span id="local-6989586621679469713"><span class="annot"><span class="annottext">Int -&gt; TypeVariant t -&gt; ShowS
[TypeVariant t] -&gt; ShowS
TypeVariant t -&gt; String
(Int -&gt; TypeVariant t -&gt; ShowS)
-&gt; (TypeVariant t -&gt; String)
-&gt; ([TypeVariant t] -&gt; ShowS)
-&gt; Show (TypeVariant t)
forall t. Show t =&gt; Int -&gt; TypeVariant t -&gt; ShowS
forall t. Show t =&gt; [TypeVariant t] -&gt; ShowS
forall t. Show t =&gt; TypeVariant t -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TypeVariant t] -&gt; ShowS
$cshowList :: forall t. Show t =&gt; [TypeVariant t] -&gt; ShowS
show :: TypeVariant t -&gt; String
$cshow :: forall t. Show t =&gt; TypeVariant t -&gt; String
showsPrec :: Int -&gt; TypeVariant t -&gt; ShowS
$cshowsPrec :: forall t. Show t =&gt; Int -&gt; TypeVariant t -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679469705"><span id="local-6989586621679469707"><span class="annot"><span class="annottext">TypeVariant t -&gt; TypeVariant t -&gt; Bool
(TypeVariant t -&gt; TypeVariant t -&gt; Bool)
-&gt; (TypeVariant t -&gt; TypeVariant t -&gt; Bool) -&gt; Eq (TypeVariant t)
forall t. Eq t =&gt; TypeVariant t -&gt; TypeVariant t -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TypeVariant t -&gt; TypeVariant t -&gt; Bool
$c/= :: forall t. Eq t =&gt; TypeVariant t -&gt; TypeVariant t -&gt; Bool
== :: TypeVariant t -&gt; TypeVariant t -&gt; Bool
$c== :: forall t. Eq t =&gt; TypeVariant t -&gt; TypeVariant t -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cVariantUnnamed"><span id="%24cVariantNamed"><span id="%24tTypeVariant"><span id="local-6989586621679469676"><span id="local-6989586621679469678"><span id="local-6989586621679469680"><span id="local-6989586621679469682"><span id="local-6989586621679469684"><span id="local-6989586621679469686"><span id="local-6989586621679469688"><span id="local-6989586621679469690"><span id="local-6989586621679469692"><span id="local-6989586621679469694"><span id="local-6989586621679469696"><span id="local-6989586621679469698"><span id="local-6989586621679469700"><span id="local-6989586621679469702"><span class="annot"><span class="annottext">Typeable (TypeVariant t)
DataType
Constr
Typeable (TypeVariant t)
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; TypeVariant t -&gt; c (TypeVariant t))
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (TypeVariant t))
-&gt; (TypeVariant t -&gt; Constr)
-&gt; (TypeVariant t -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (TypeVariant t)))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e))
    -&gt; Maybe (c (TypeVariant t)))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; TypeVariant t -&gt; TypeVariant t)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeVariant t -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeVariant t -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; TypeVariant t -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeVariant t -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d)
    -&gt; TypeVariant t -&gt; m (TypeVariant t))
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d)
    -&gt; TypeVariant t -&gt; m (TypeVariant t))
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d)
    -&gt; TypeVariant t -&gt; m (TypeVariant t))
-&gt; Data (TypeVariant t)
TypeVariant t -&gt; DataType
TypeVariant t -&gt; Constr
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (TypeVariant t))
(forall b. Data b =&gt; b -&gt; b) -&gt; TypeVariant t -&gt; TypeVariant t
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeVariant t -&gt; c (TypeVariant t)
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (TypeVariant t)
forall t. Data t =&gt; Typeable (TypeVariant t)
forall t. Data t =&gt; TypeVariant t -&gt; DataType
forall t. Data t =&gt; TypeVariant t -&gt; Constr
forall t.
Data t =&gt;
(forall b. Data b =&gt; b -&gt; b) -&gt; TypeVariant t -&gt; TypeVariant t
forall t u.
Data t =&gt;
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeVariant t -&gt; u
forall t u.
Data t =&gt;
(forall d. Data d =&gt; d -&gt; u) -&gt; TypeVariant t -&gt; [u]
forall t r r'.
Data t =&gt;
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeVariant t -&gt; r
forall t r r'.
Data t =&gt;
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeVariant t -&gt; r
forall t (m :: * -&gt; *).
(Data t, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; TypeVariant t -&gt; m (TypeVariant t)
forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; TypeVariant t -&gt; m (TypeVariant t)
forall t (c :: * -&gt; *).
Data t =&gt;
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (TypeVariant t)
forall t (c :: * -&gt; *).
Data t =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeVariant t -&gt; c (TypeVariant t)
forall t (t :: * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (TypeVariant t))
forall t (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (TypeVariant t))
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeVariant t -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; TypeVariant t -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeVariant t -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeVariant t -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; TypeVariant t -&gt; m (TypeVariant t)
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; TypeVariant t -&gt; m (TypeVariant t)
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (TypeVariant t)
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeVariant t -&gt; c (TypeVariant t)
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (TypeVariant t))
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (TypeVariant t))
$cVariantUnnamed :: Constr
$cVariantNamed :: Constr
$tTypeVariant :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d)
-&gt; TypeVariant t -&gt; m (TypeVariant t)
$cgmapMo :: forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; TypeVariant t -&gt; m (TypeVariant t)
gmapMp :: (forall d. Data d =&gt; d -&gt; m d)
-&gt; TypeVariant t -&gt; m (TypeVariant t)
$cgmapMp :: forall t (m :: * -&gt; *).
(Data t, MonadPlus m) =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; TypeVariant t -&gt; m (TypeVariant t)
gmapM :: (forall d. Data d =&gt; d -&gt; m d)
-&gt; TypeVariant t -&gt; m (TypeVariant t)
$cgmapM :: forall t (m :: * -&gt; *).
(Data t, Monad m) =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; TypeVariant t -&gt; m (TypeVariant t)
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeVariant t -&gt; u
$cgmapQi :: forall t u.
Data t =&gt;
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; TypeVariant t -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; TypeVariant t -&gt; [u]
$cgmapQ :: forall t u.
Data t =&gt;
(forall d. Data d =&gt; d -&gt; u) -&gt; TypeVariant t -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeVariant t -&gt; r
$cgmapQr :: forall t r r'.
Data t =&gt;
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeVariant t -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeVariant t -&gt; r
$cgmapQl :: forall t r r'.
Data t =&gt;
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; TypeVariant t -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; TypeVariant t -&gt; TypeVariant t
$cgmapT :: forall t.
Data t =&gt;
(forall b. Data b =&gt; b -&gt; b) -&gt; TypeVariant t -&gt; TypeVariant t
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (TypeVariant t))
$cdataCast2 :: forall t (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c (TypeVariant t))
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (TypeVariant t))
$cdataCast1 :: forall t (t :: * -&gt; *) (c :: * -&gt; *).
(Data t, Typeable t) =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c (TypeVariant t))
dataTypeOf :: TypeVariant t -&gt; DataType
$cdataTypeOf :: forall t. Data t =&gt; TypeVariant t -&gt; DataType
toConstr :: TypeVariant t -&gt; Constr
$ctoConstr :: forall t. Data t =&gt; TypeVariant t -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (TypeVariant t)
$cgunfold :: forall t (c :: * -&gt; *).
Data t =&gt;
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c (TypeVariant t)
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeVariant t -&gt; c (TypeVariant t)
$cgfoldl :: forall t (c :: * -&gt; *).
Data t =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; TypeVariant t -&gt; c (TypeVariant t)
$cp1Data :: forall t. Data t =&gt; Typeable (TypeVariant t)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679469670"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-155"></span><span>  </span><span id="local-6989586621679469669"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; TypeDef a -&gt; TypeDef b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679469668"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679469668"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">variants :: forall t. TypeDef t -&gt; [(DConId, TypeVariant t)]
</span><a href="IR.Types.TypeSystem.html#variants"><span class="hs-identifier hs-var">variants</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679469667"><span class="annot"><span class="annottext">[(DConId, TypeVariant a)]
</span><a href="#local-6989586621679469667"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">targs :: forall t. TypeDef t -&gt; [TVarId]
</span><a href="IR.Types.TypeSystem.html#targs"><span class="hs-identifier hs-var">targs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679469666"><span class="annot"><span class="annottext">[TVarId]
</span><a href="#local-6989586621679469666"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><span class="annottext">TypeDef :: forall t. [(DConId, TypeVariant t)] -&gt; [TVarId] -&gt; TypeDef t
</span><a href="IR.Types.TypeSystem.html#TypeDef"><span class="hs-identifier hs-type">TypeDef</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">variants :: [(DConId, TypeVariant b)]
</span><a href="IR.Types.TypeSystem.html#variants"><span class="hs-identifier hs-var">variants</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((DConId, TypeVariant a) -&gt; (DConId, TypeVariant b))
-&gt; [(DConId, TypeVariant a)] -&gt; [(DConId, TypeVariant b)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TypeVariant a -&gt; TypeVariant b)
-&gt; (DConId, TypeVariant a) -&gt; (DConId, TypeVariant b)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">((TypeVariant a -&gt; TypeVariant b)
 -&gt; (DConId, TypeVariant a) -&gt; (DConId, TypeVariant b))
-&gt; (TypeVariant a -&gt; TypeVariant b)
-&gt; (DConId, TypeVariant a)
-&gt; (DConId, TypeVariant b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; TypeVariant a -&gt; TypeVariant b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679469668"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(DConId, TypeVariant a)]
</span><a href="#local-6989586621679469667"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">targs :: [TVarId]
</span><a href="IR.Types.TypeSystem.html#targs"><span class="hs-identifier hs-var">targs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TVarId]
</span><a href="#local-6989586621679469666"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679469663"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeVariant"><span class="hs-identifier hs-type">TypeVariant</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>  </span><span id="local-6989586621679469662"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; TypeVariant a -&gt; TypeVariant b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679469661"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679469661"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#VariantNamed"><span class="hs-identifier hs-type">VariantNamed</span></a></span><span>   </span><span id="local-6989586621679469660"><span class="annot"><span class="annottext">[(VarId, a)]
</span><a href="#local-6989586621679469660"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(VarId, b)] -&gt; TypeVariant b
forall t. [(VarId, t)] -&gt; TypeVariant t
</span><a href="IR.Types.TypeSystem.html#VariantNamed"><span class="hs-identifier hs-var">VariantNamed</span></a></span><span> </span><span class="annot"><span class="annottext">([(VarId, b)] -&gt; TypeVariant b) -&gt; [(VarId, b)] -&gt; TypeVariant b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((VarId, a) -&gt; (VarId, b)) -&gt; [(VarId, a)] -&gt; [(VarId, b)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (VarId, a) -&gt; (VarId, b)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679469661"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(VarId, a)]
</span><a href="#local-6989586621679469660"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679469659"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679469659"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#VariantUnnamed"><span class="hs-identifier hs-type">VariantUnnamed</span></a></span><span> </span><span id="local-6989586621679469658"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679469658"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[b] -&gt; TypeVariant b
forall t. [t] -&gt; TypeVariant t
</span><a href="IR.Types.TypeSystem.html#VariantUnnamed"><span class="hs-identifier hs-var">VariantUnnamed</span></a></span><span> </span><span class="annot"><span class="annottext">([b] -&gt; TypeVariant b) -&gt; [b] -&gt; TypeVariant b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679469659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679469658"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- | The number of fields in a 'TypeVariant'.</span><span>
</span><span id="line-163"></span><span id="local-6989586621679469657"><span class="annot"><a href="IR.Types.TypeSystem.html#variantFields"><span class="hs-identifier hs-type">variantFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IR.Types.TypeSystem.html#TypeVariant"><span class="hs-identifier hs-type">TypeVariant</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679469657"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-164"></span><span id="variantFields"><span class="annot"><span class="annottext">variantFields :: TypeVariant t -&gt; Int
</span><a href="IR.Types.TypeSystem.html#variantFields"><span class="hs-identifier hs-var hs-var">variantFields</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#VariantNamed"><span class="hs-identifier hs-type">VariantNamed</span></a></span><span>   </span><span id="local-6989586621679469655"><span class="annot"><span class="annottext">[(VarId, t)]
</span><a href="#local-6989586621679469655"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(VarId, t)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(VarId, t)]
</span><a href="#local-6989586621679469655"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-165"></span><span class="annot"><a href="IR.Types.TypeSystem.html#variantFields"><span class="hs-identifier hs-var">variantFields</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IR.Types.TypeSystem.html#VariantUnnamed"><span class="hs-identifier hs-type">VariantUnnamed</span></a></span><span> </span><span id="local-6989586621679469653"><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679469653"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[t] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679469653"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-166"></span></pre></body></html>