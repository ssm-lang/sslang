<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>IR.TypeChecker</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">sslang-0.1.0.0</span><ul class="links" id="page-menu"><li><a href="src/IR.TypeChecker.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">IR.TypeChecker</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Infer types for optionally annotated program.</p><p>For now, this module implements a very crude form of pure, syntax-directed type
 inference where type annotations can be locally and immediately inferred,
 without the help of a type environment/context.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:TypeCtx">TypeCtx</a> = <a href="#v:TypeCtx">TypeCtx</a> {<ul class="subs"><li><a href="#v:varMap">varMap</a> :: <a href="../containers-0.6.5.1/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> <a href="Common-Identifiers.html#t:VarId" title="Common.Identifiers">VarId</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a></li><li><a href="#v:dConMap">dConMap</a> :: <a href="../containers-0.6.5.1/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> <a href="Common-Identifiers.html#t:DConId" title="Common.Identifiers">DConId</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a></li></ul>}</li><li class="src short"><span class="keyword">newtype</span> <a href="#t:InferFn">InferFn</a> a = <a href="#v:InferFn">InferFn</a> (<a href="../mtl-2.2.2/Control-Monad-State-Lazy.html#t:StateT" title="Control.Monad.State.Lazy">StateT</a> <a href="IR-TypeChecker.html#t:TypeCtx" title="IR.TypeChecker">TypeCtx</a> <a href="Common-Compiler.html#t:Pass" title="Common.Compiler">Pass</a> a)</li><li class="src short"><a href="#v:runInferFn">runInferFn</a> :: <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a -&gt; <a href="Common-Compiler.html#t:Pass" title="Common.Compiler">Pass</a> a</li><li class="src short"><a href="#v:insertVar">insertVar</a> :: <a href="Common-Identifiers.html#t:VarId" title="Common.Identifiers">VarId</a> -&gt; <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> ()</li><li class="src short"><a href="#v:replaceCtx">replaceCtx</a> :: <a href="IR-TypeChecker.html#t:TypeCtx" title="IR.TypeChecker">TypeCtx</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> ()</li><li class="src short"><a href="#v:lookupVar">lookupVar</a> :: <a href="Common-Identifiers.html#t:VarId" title="Common.Identifiers">VarId</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> (<a href="../base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a>)</li><li class="src short"><a href="#v:lookupDCon">lookupDCon</a> :: <a href="Common-Identifiers.html#t:DConId" title="Common.Identifiers">DConId</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> (<a href="../base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a>)</li><li class="src short"><a href="#v:inferProgram">inferProgram</a> :: <a href="IR-IR.html#t:Program" title="IR.IR">Program</a> <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a> -&gt; <a href="Common-Compiler.html#t:Pass" title="Common.Compiler">Pass</a> (<a href="IR-IR.html#t:Program" title="IR.IR">Program</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a>)</li><li class="src short"><a href="#v:inferADT">inferADT</a> :: [(<a href="Common-Identifiers.html#t:TConId" title="Common.Identifiers">TConId</a>, <a href="IR-Types-TypeSystem.html#t:TypeDef" title="IR.Types.TypeSystem">TypeDef</a> <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a>)] -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> [(<a href="Common-Identifiers.html#t:TConId" title="Common.Identifiers">TConId</a>, <a href="IR-Types-TypeSystem.html#t:TypeDef" title="IR.Types.TypeSystem">TypeDef</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a>)]</li><li class="src short"><a href="#v:inferExterns">inferExterns</a> :: [(<a href="Common-Identifiers.html#t:VarId" title="Common.Identifiers">VarId</a>, <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a>)] -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> [(<a href="Common-Identifiers.html#t:VarId" title="Common.Identifiers">VarId</a>, <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a>)]</li><li class="src short"><a href="#v:inferProgramDefs">inferProgramDefs</a> :: [(<a href="Common-Identifiers.html#t:VarId" title="Common.Identifiers">VarId</a>, <a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a>)] -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> [(<a href="Common-Identifiers.html#t:VarId" title="Common.Identifiers">VarId</a>, <a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a>)]</li><li class="src short"><a href="#v:inferExpr">inferExpr</a> :: <a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> (<a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a>)</li><li class="src short"><a href="#v:inferPrim">inferPrim</a> :: <a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> (<a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a>)</li><li class="src short"><a href="#v:inferPrimBinop">inferPrimBinop</a> :: <a href="IR-IR.html#t:PrimOp" title="IR.IR">PrimOp</a> -&gt; <a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a> -&gt; <a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> (<a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a>)</li><li class="src short"><a href="#v:withNewScope">withNewScope</a> :: <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a</li><li class="src short"><a href="#v:withVty">withVty</a> :: <a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a> -&gt; <a href="Common-Identifiers.html#t:Binder" title="Common.Identifiers">Binder</a> -&gt; <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> ()</li><li class="src short"><a href="#v:anns2Class">anns2Class</a> :: <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a></li><li class="src short"><a href="#v:ann2Class">ann2Class</a> :: <a href="IR-Types-Annotated.html#t:TypeAnnote" title="IR.Types.Annotated">TypeAnnote</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:TypeCtx" class="def">TypeCtx</a> <a href="src/IR.TypeChecker.html#TypeCtx" class="link">Source</a> <a href="#t:TypeCtx" class="selflink">#</a></p><div class="doc"><p>Typing Environment</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TypeCtx" class="def">TypeCtx</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:varMap" class="def">varMap</a> :: <a href="../containers-0.6.5.1/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> <a href="Common-Identifiers.html#t:VarId" title="Common.Identifiers">VarId</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:dConMap" class="def">dConMap</a> :: <a href="../containers-0.6.5.1/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> <a href="Common-Identifiers.html#t:DConId" title="Common.Identifiers">DConId</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:TypeCtx">Instances</h4><details id="i:TypeCtx" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TypeCtx:MonadState:1"></span> <a href="../mtl-2.2.2/Control-Monad-State-Class.html#t:MonadState" title="Control.Monad.State.Class">MonadState</a> <a href="IR-TypeChecker.html#t:TypeCtx" title="IR.TypeChecker">TypeCtx</a> <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a></span> <a href="src/IR.TypeChecker.html#line-56" class="link">Source</a> <a href="#t:TypeCtx" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TypeCtx:MonadState:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="IR-TypeChecker.html">IR.TypeChecker</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:get">get</a> :: <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> <a href="IR-TypeChecker.html#t:TypeCtx" title="IR.TypeChecker">TypeCtx</a> <a href="#v:get" class="selflink">#</a></p><p class="src"><a href="#v:put">put</a> :: <a href="IR-TypeChecker.html#t:TypeCtx" title="IR.TypeChecker">TypeCtx</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> () <a href="#v:put" class="selflink">#</a></p><p class="src"><a href="#v:state">state</a> :: (<a href="IR-TypeChecker.html#t:TypeCtx" title="IR.TypeChecker">TypeCtx</a> -&gt; (a, <a href="IR-TypeChecker.html#t:TypeCtx" title="IR.TypeChecker">TypeCtx</a>)) -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a <a href="#v:state" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:InferFn" class="def">InferFn</a> a <a href="src/IR.TypeChecker.html#InferFn" class="link">Source</a> <a href="#t:InferFn" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:InferFn" class="def">InferFn</a> (<a href="../mtl-2.2.2/Control-Monad-State-Lazy.html#t:StateT" title="Control.Monad.State.Lazy">StateT</a> <a href="IR-TypeChecker.html#t:TypeCtx" title="IR.TypeChecker">TypeCtx</a> <a href="Common-Compiler.html#t:Pass" title="Common.Compiler">Pass</a> a)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:InferFn">Instances</h4><details id="i:InferFn" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:InferFn:Monad:1"></span> <a href="../base-4.14.3.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a></span> <a href="src/IR.TypeChecker.html#line-53" class="link">Source</a> <a href="#t:InferFn" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:InferFn:Monad:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="IR-TypeChecker.html">IR.TypeChecker</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-62--62--61-">(&gt;&gt;=)</a> :: <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a -&gt; (a -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> b) -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> b <a href="#v:-62--62--61-" class="selflink">#</a></p><p class="src"><a href="#v:-62--62-">(&gt;&gt;)</a> :: <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> b -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> b <a href="#v:-62--62-" class="selflink">#</a></p><p class="src"><a href="#v:return">return</a> :: a -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a <a href="#v:return" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:InferFn:Functor:2"></span> <a href="../base-4.14.3.0/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a></span> <a href="src/IR.TypeChecker.html#line-51" class="link">Source</a> <a href="#t:InferFn" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:InferFn:Functor:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="IR-TypeChecker.html">IR.TypeChecker</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fmap">fmap</a> :: (a -&gt; b) -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> b <a href="#v:fmap" class="selflink">#</a></p><p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> b -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a <a href="#v:-60--36-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:InferFn:MonadFail:3"></span> <a href="../base-4.14.3.0/Control-Monad-Fail.html#t:MonadFail" title="Control.Monad.Fail">MonadFail</a> <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a></span> <a href="src/IR.TypeChecker.html#line-54" class="link">Source</a> <a href="#t:InferFn" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:InferFn:MonadFail:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="IR-TypeChecker.html">IR.TypeChecker</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fail">fail</a> :: <a href="../base-4.14.3.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a <a href="#v:fail" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:InferFn:Applicative:4"></span> <a href="../base-4.14.3.0/Control-Applicative.html#t:Applicative" title="Control.Applicative">Applicative</a> <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a></span> <a href="src/IR.TypeChecker.html#line-52" class="link">Source</a> <a href="#t:InferFn" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:InferFn:Applicative:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="IR-TypeChecker.html">IR.TypeChecker</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:pure">pure</a> :: a -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a <a href="#v:pure" class="selflink">#</a></p><p class="src"><a href="#v:-60--42--62-">(&lt;*&gt;)</a> :: <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> (a -&gt; b) -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> b <a href="#v:-60--42--62-" class="selflink">#</a></p><p class="src"><a href="#v:liftA2">liftA2</a> :: (a -&gt; b -&gt; c) -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> b -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> c <a href="#v:liftA2" class="selflink">#</a></p><p class="src"><a href="#v:-42--62-">(*&gt;)</a> :: <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> b -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> b <a href="#v:-42--62-" class="selflink">#</a></p><p class="src"><a href="#v:-60--42-">(&lt;*)</a> :: <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> b -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a <a href="#v:-60--42-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:InferFn:MonadState:5"></span> <a href="../mtl-2.2.2/Control-Monad-State-Class.html#t:MonadState" title="Control.Monad.State.Class">MonadState</a> <a href="IR-TypeChecker.html#t:TypeCtx" title="IR.TypeChecker">TypeCtx</a> <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a></span> <a href="src/IR.TypeChecker.html#line-56" class="link">Source</a> <a href="#t:InferFn" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:InferFn:MonadState:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="IR-TypeChecker.html">IR.TypeChecker</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:get">get</a> :: <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> <a href="IR-TypeChecker.html#t:TypeCtx" title="IR.TypeChecker">TypeCtx</a> <a href="#v:get" class="selflink">#</a></p><p class="src"><a href="#v:put">put</a> :: <a href="IR-TypeChecker.html#t:TypeCtx" title="IR.TypeChecker">TypeCtx</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> () <a href="#v:put" class="selflink">#</a></p><p class="src"><a href="#v:state">state</a> :: (<a href="IR-TypeChecker.html#t:TypeCtx" title="IR.TypeChecker">TypeCtx</a> -&gt; (a, <a href="IR-TypeChecker.html#t:TypeCtx" title="IR.TypeChecker">TypeCtx</a>)) -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a <a href="#v:state" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:InferFn:MonadError:6"></span> <a href="Common-Compiler.html#t:MonadError" title="Common.Compiler">MonadError</a> <a href="Common-Compiler.html#t:Error" title="Common.Compiler">Error</a> <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a></span> <a href="src/IR.TypeChecker.html#line-55" class="link">Source</a> <a href="#t:InferFn" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:InferFn:MonadError:6"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="IR-TypeChecker.html">IR.TypeChecker</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:throwError">throwError</a> :: <a href="Common-Compiler.html#t:Error" title="Common.Compiler">Error</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a <a href="#v:throwError" class="selflink">#</a></p><p class="src"><a href="#v:catchError">catchError</a> :: <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a -&gt; (<a href="Common-Compiler.html#t:Error" title="Common.Compiler">Error</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a) -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a <a href="#v:catchError" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:runInferFn" class="def">runInferFn</a> :: <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a -&gt; <a href="Common-Compiler.html#t:Pass" title="Common.Compiler">Pass</a> a <a href="src/IR.TypeChecker.html#runInferFn" class="link">Source</a> <a href="#v:runInferFn" class="selflink">#</a></p><div class="doc"><p>Run a InferFn computation.</p></div></div><div class="top"><p class="src"><a id="v:insertVar" class="def">insertVar</a> :: <a href="Common-Identifiers.html#t:VarId" title="Common.Identifiers">VarId</a> -&gt; <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> () <a href="src/IR.TypeChecker.html#insertVar" class="link">Source</a> <a href="#v:insertVar" class="selflink">#</a></p><div class="doc"><p>Insert a variable ID and its type into current typing context.</p></div></div><div class="top"><p class="src"><a id="v:replaceCtx" class="def">replaceCtx</a> :: <a href="IR-TypeChecker.html#t:TypeCtx" title="IR.TypeChecker">TypeCtx</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> () <a href="src/IR.TypeChecker.html#replaceCtx" class="link">Source</a> <a href="#v:replaceCtx" class="selflink">#</a></p><div class="doc"><p>Replace the current typing context with a new one.</p></div></div><div class="top"><p class="src"><a id="v:lookupVar" class="def">lookupVar</a> :: <a href="Common-Identifiers.html#t:VarId" title="Common.Identifiers">VarId</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> (<a href="../base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a>) <a href="src/IR.TypeChecker.html#lookupVar" class="link">Source</a> <a href="#v:lookupVar" class="selflink">#</a></p><div class="doc"><p>Look up the type of a variable in the current typing context given its variable ID.</p></div></div><div class="top"><p class="src"><a id="v:lookupDCon" class="def">lookupDCon</a> :: <a href="Common-Identifiers.html#t:DConId" title="Common.Identifiers">DConId</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> (<a href="../base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a>) <a href="src/IR.TypeChecker.html#lookupDCon" class="link">Source</a> <a href="#v:lookupDCon" class="selflink">#</a></p><div class="doc"><p>Look up the type of a data constructor in the typing context.</p></div></div><div class="top"><p class="src"><a id="v:inferProgram" class="def">inferProgram</a> :: <a href="IR-IR.html#t:Program" title="IR.IR">Program</a> <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a> -&gt; <a href="Common-Compiler.html#t:Pass" title="Common.Compiler">Pass</a> (<a href="IR-IR.html#t:Program" title="IR.IR">Program</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a>) <a href="src/IR.TypeChecker.html#inferProgram" class="link">Source</a> <a href="#v:inferProgram" class="selflink">#</a></p><div class="doc"><p>Infer all the program defs of the given program.</p></div></div><div class="top"><p class="src"><a id="v:inferADT" class="def">inferADT</a> :: [(<a href="Common-Identifiers.html#t:TConId" title="Common.Identifiers">TConId</a>, <a href="IR-Types-TypeSystem.html#t:TypeDef" title="IR.Types.TypeSystem">TypeDef</a> <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a>)] -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> [(<a href="Common-Identifiers.html#t:TConId" title="Common.Identifiers">TConId</a>, <a href="IR-Types-TypeSystem.html#t:TypeDef" title="IR.Types.TypeSystem">TypeDef</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a>)] <a href="src/IR.TypeChecker.html#inferADT" class="link">Source</a> <a href="#v:inferADT" class="selflink">#</a></p><div class="doc"><p>Pass all program typeDefs through the typechecker</p><p>Change Ann.Type to Classes.Type
For each ADT, save ('DConId, 'TConId) key-value pairs in typing context for future use</p></div></div><div class="top"><p class="src"><a id="v:inferExterns" class="def">inferExterns</a> :: [(<a href="Common-Identifiers.html#t:VarId" title="Common.Identifiers">VarId</a>, <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a>)] -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> [(<a href="Common-Identifiers.html#t:VarId" title="Common.Identifiers">VarId</a>, <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a>)] <a href="src/IR.TypeChecker.html#inferExterns" class="link">Source</a> <a href="#v:inferExterns" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:inferProgramDefs" class="def">inferProgramDefs</a> :: [(<a href="Common-Identifiers.html#t:VarId" title="Common.Identifiers">VarId</a>, <a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a>)] -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> [(<a href="Common-Identifiers.html#t:VarId" title="Common.Identifiers">VarId</a>, <a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a>)] <a href="src/IR.TypeChecker.html#inferProgramDefs" class="link">Source</a> <a href="#v:inferProgramDefs" class="selflink">#</a></p><div class="doc"><p>Top level inference.</p><p>This will infer the (VarId, Expr) pair sequentially and add the infered types
 into the type context so that these info can be used when infering the following
 expressions.</p></div></div><div class="top"><p class="src"><a id="v:inferExpr" class="def">inferExpr</a> :: <a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> (<a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a>) <a href="src/IR.TypeChecker.html#inferExpr" class="link">Source</a> <a href="#v:inferExpr" class="selflink">#</a></p><div class="doc"><p>Infer a single expression <code>e</code>.</p><p>This function will also infer any nested expressions inside <code>e</code> and all
 expressions in the return value will have Classes.Type as its type. Error will
 be thrown if the type annotation is in inconsistent with the true true or the
 expression is known.</p></div></div><div class="top"><p class="src"><a id="v:inferPrim" class="def">inferPrim</a> :: <a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> (<a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a>) <a href="src/IR.TypeChecker.html#inferPrim" class="link">Source</a> <a href="#v:inferPrim" class="selflink">#</a></p><div class="doc"><p>Infer the type of a Primitive expression.</p></div></div><div class="top"><p class="src"><a id="v:inferPrimBinop" class="def">inferPrimBinop</a> :: <a href="IR-IR.html#t:PrimOp" title="IR.IR">PrimOp</a> -&gt; <a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a> -&gt; <a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> (<a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a>) <a href="src/IR.TypeChecker.html#inferPrimBinop" class="link">Source</a> <a href="#v:inferPrimBinop" class="selflink">#</a></p><div class="doc"><p>Check type of a binary integer operation.</p></div></div><div class="top"><p class="src"><a id="v:withNewScope" class="def">withNewScope</a> :: <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> a <a href="src/IR.TypeChecker.html#withNewScope" class="link">Source</a> <a href="#v:withNewScope" class="selflink">#</a></p><div class="doc"><p>Helper function to support local modificaton of type context.</p></div></div><div class="top"><p class="src"><a id="v:withVty" class="def">withVty</a> :: <a href="IR-IR.html#t:Expr" title="IR.IR">Expr</a> <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a> -&gt; <a href="Common-Identifiers.html#t:Binder" title="Common.Identifiers">Binder</a> -&gt; <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> () <a href="src/IR.TypeChecker.html#withVty" class="link">Source</a> <a href="#v:withVty" class="selflink">#</a></p><div class="doc"><p>Helper function to do type inference with the knowledge of the correct type for a binding.</p></div></div><div class="top"><p class="src"><a id="v:anns2Class" class="def">anns2Class</a> :: <a href="IR-Types-Annotated.html#t:Type" title="IR.Types.Annotated">Type</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a> <a href="src/IR.TypeChecker.html#anns2Class" class="link">Source</a> <a href="#v:anns2Class" class="selflink">#</a></p><div class="doc"><p>Transfrom an Ann.Type to Classes.Type.</p></div></div><div class="top"><p class="src"><a id="v:ann2Class" class="def">ann2Class</a> :: <a href="IR-Types-Annotated.html#t:TypeAnnote" title="IR.Types.Annotated">TypeAnnote</a> -&gt; <a href="IR-TypeChecker.html#t:InferFn" title="IR.TypeChecker">InferFn</a> <a href="IR-Types-Classes.html#t:Type" title="IR.Types.Classes">Type</a> <a href="src/IR.TypeChecker.html#ann2Class" class="link">Source</a> <a href="#v:ann2Class" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.2</p></div></body></html>